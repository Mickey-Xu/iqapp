"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("react"),t=require("@react-pdf-viewer/core"),n=function(n){var a=n.files,c=e.useContext(t.LocalizationContext);return 0===a.length?e.createElement("div",{className:"rpv-attachment-list-empty"},c&&c.attachment?c.attachment.noAttachment:"There is no attachment"):e.createElement("ul",{className:"rpv-attachment-list"},a.map((function(t){return e.createElement("li",{className:"rpv-attachment-item",key:"attachment-"+t.fileName,title:c&&c.attachment?c.attachment.clickToDownload:"Click to download",onClick:function(){return e=t.fileName,n=t.data,a="string"==typeof n?"":URL.createObjectURL(new Blob([n],{type:""})),(c=document.createElement("a")).style.display="none",c.href=a||e,c.setAttribute("download",function(e){var t=e.split("/").pop();return t?t.split("#")[0].split("?")[0]:e}(e)),document.body.appendChild(c),c.click(),document.body.removeChild(c),void(a&&URL.revokeObjectURL(a));var e,n,a,c}},t.fileName)})))},a=function(a){var c=a.doc,r=e.useState({files:[],isLoaded:!1}),o=r[0],i=r[1];return e.useEffect((function(){c.getAttachments().then((function(e){var t=e?Object.keys(e).map((function(t){return{data:e[t].content,fileName:e[t].filename}})):[];i({files:t,isLoaded:!0})}))}),[c]),o.isLoaded?e.createElement(n,{files:o.files}):e.createElement(t.Spinner,null)},c=function(n){var c=n.store,r=e.useState(c.get("doc")),o=r[0],i=r[1],l=function(e){i(e)};return e.useEffect((function(){return c.subscribe("doc",l),function(){c.unsubscribe("doc",l)}}),[]),o?e.createElement(a,{doc:o}):e.createElement("div",{className:"rpv-attachment-list-loader"},e.createElement(t.Spinner,null))};exports.attachmentPlugin=function(){var n=e.useMemo((function(){return t.createStore({})}),[]);return{onDocumentLoad:function(e){n.update("doc",e.doc)},Attachments:function(){return e.createElement(c,{store:n})}}};
