"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("react"),t=require("@react-pdf-viewer/core"),o=function(t){var o=t.bookmark,r=t.depth,a=t.doc,c=t.onClick,i=t.onJumpToDest,s=e.createRef(),u=e.createRef(),l=e.useRef(!0),m=o.items&&o.items.length>0;return e.createElement(e.Fragment,null,e.createElement("div",{className:"rpv-bookmark-item",style:{paddingLeft:20*r+4+"px"},onClick:function(){!m&&o.dest&&c(o.dest)}},m&&e.createElement("span",{ref:s,className:"rpv-bookmark-toggle",onClick:function(){l.current=!l.current;var e=u.current,t=s.current;e&&t&&(e.style.display=l.current?"block":"none",t.classList.toggle("rpv-bookmark-toggle-expanded"))}},"â–º"),o.url?e.createElement("a",{className:"rpv-bookmark-title",href:o.url,rel:"noopener noreferrer nofollow",target:o.newWindow?"_blank":""},o.title):e.createElement("div",{className:"rpv-bookmark-title",onClick:function(){m&&o.dest&&c(o.dest)}},o.title)),m&&e.createElement("div",{ref:u},e.createElement(n,{bookmarks:o.items,depth:r+1,doc:a,onJumpToDest:i})))},n=function(n){var r=n.bookmarks,a=n.depth,c=void 0===a?0:a,i=n.doc,s=n.onJumpToDest,u=function(e){t.getDestination(i,e).then((function(e){var t=e.pageIndex,o=e.bottomOffset,n=e.scaleTo;s(t+1,o,n)}))};return e.createElement("ul",{className:"rpv-bookmark-list"},r.map((function(t,n){return e.createElement("li",{key:n},e.createElement(o,{bookmark:t,depth:c,doc:i,onClick:u,onJumpToDest:s}))})))},r=function(o){var r=o.doc,a=o.onJumpToDest,c=e.useContext(t.LocalizationContext),i=e.useState({isLoaded:!1,items:[]}),s=i[0],u=i[1];return e.useEffect((function(){u({isLoaded:!1,items:[]}),r.getOutline().then((function(e){u({isLoaded:!0,items:e||[]})}))}),[r]),s.isLoaded?0===s.items.length?e.createElement("div",{className:"rpv-bookmark-empty"},c&&c.bookmark?c.bookmark.noBookmark:"There is no bookmark"):e.createElement(n,{bookmarks:s.items,depth:0,doc:r,onJumpToDest:a}):e.createElement(t.Spinner,null)},a=function(o){var n=o.store,a=e.useState(n.get("doc")),c=a[0],i=a[1],s=function(e){i(e)};return e.useEffect((function(){return n.subscribe("doc",s),function(){n.unsubscribe("doc",s)}}),[]),c?e.createElement(r,{doc:c,onJumpToDest:function(e,t,o){var r=n.get("jumpToDestination");r&&r(e,t,0,o)}}):e.createElement("div",{className:"rpv-bookmark-list-loader"},e.createElement(t.Spinner,null))};exports.bookmarkPlugin=function(){var o=e.useMemo((function(){return t.createStore({})}),[]);return{install:function(e){o.update("jumpToDestination",e.jumpToDestination)},onDocumentLoad:function(e){o.update("doc",e.doc)},Bookmarks:function(){return e.createElement(a,{store:o})}}};
