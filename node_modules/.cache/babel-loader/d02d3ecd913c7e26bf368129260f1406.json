{"ast":null,"code":"var _jsxFileName = \"C:\\\\project\\\\SCF-NI_PM_App\\\\SCF.InstallationQuality\\\\react-client\\\\src\\\\layouts\\\\PrimaryLayout\\\\index.js\";\nimport { AppBar, BottomNavigation, BottomNavigationAction, Toolbar, Typography } from \"@material-ui/core\";\nimport { withStyles } from \"@material-ui/core/styles\";\nimport { ArrowBackIos, AssignmentOutlined, Refresh, Schedule } from \"@material-ui/icons\";\nimport * as action from \"actions\";\nimport fitter2 from \"assets/svg/fitter2.svg\";\nimport fitter3 from \"assets/svg/fitter3.svg\";\nimport Alert from \"components/Alert\";\nimport Loading from \"components/Loading\";\nimport { LocalizeContext } from \"i18n\";\nimport projectIcon from \"img/project.png\";\nimport SelectedProjectIcon from \"img/selectedProject.png\";\nimport { db } from \"js/db\";\nimport * as repo from \"js/fetch\";\nimport { getTaskCount, recordRefreshTime } from \"js/util\";\nimport React, { Fragment, useEffect, useRef } from \"react\";\nimport { connect } from \"react-redux\";\nimport { Link, useHistory, useLocation } from \"react-router-dom\";\n\nconst mapDispatchToProps = dispatch => {\n  return {\n    logout: () => {\n      dispatch(action.logout());\n    },\n    refresh: () => {\n      dispatch(action.fetchAll());\n    },\n    getData: () => {\n      dispatch(action.fetchAll(repo.type.CACHE));\n    },\n    getLanguage: () => {\n      db.cache.get(\"settings\").then(cache => {\n        if (!cache) {\n          return;\n        }\n\n        const {\n          language: {\n            language\n          }\n        } = cache.data;\n        dispatch(action.setLanguage(language));\n      });\n    },\n    getRefreshData: () => {\n      recordRefreshTime(dispatch);\n    },\n    setScrollPosition: data => {\n      dispatch(action.setScrollPosition(data));\n    },\n    backPage: (history, name, root) => {\n      if (name === \"activity Document\") {\n        dispatch(action.setOrderDetailPageDefaultTab(root));\n        history.goBack();\n      } else {\n        history.goBack();\n      }\n    }\n  };\n};\n\nconst mapStateToProps = () => {\n  const taskSum = getTaskCount().awaitCloseNum + getTaskCount().awaitComplateNum;\n  return {\n    taskSum\n  };\n};\n\nconst TitleBar = withStyles(({\n  spacing\n}) => {\n  return {\n    appBar: {\n      borderBottomColor: \"#e0e0e0\",\n      borderBottomStyle: \"solid\",\n      borderBottomWidth: 1\n    },\n    toolbar: {\n      minHeight: spacing(6.5),\n      backgroundColor: \"rgb(255,255,255)\",\n      color: \"black\"\n    },\n    icon: {\n      minWidth: spacing(5)\n    },\n    title1: {\n      textAlign: \"left\",\n      flex: 1,\n      fontFamily: \"'微软雅黑 Bold', '微软雅黑 Regular', '微软雅黑'\",\n      fontSize: 18\n    },\n    title2: {\n      textAlign: \"center\",\n      flex: 1,\n      fontFamily: \"'微软雅黑 Bold', '微软雅黑 Regular', '微软雅黑'\",\n      fontSize: \"18px\"\n    }\n  };\n})(connect(null, mapDispatchToProps)(({\n  classes,\n  refresh,\n  title,\n  pageLevel,\n  isShowRefreshButton = false,\n  goBack\n}) => {\n  return /*#__PURE__*/React.createElement(AppBar, {\n    elevation: 0,\n    className: classes.appBar,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 117,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(Toolbar, {\n    className: classes.toolbar,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 118,\n      columnNumber: 11\n    }\n  }, pageLevel !== 1 && /*#__PURE__*/React.createElement(ArrowBackIos, {\n    \"aria-label\": \"back\",\n    fontSize: \"small\",\n    onClick: () => {\n      goBack();\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 120,\n      columnNumber: 15\n    }\n  }), /*#__PURE__*/React.createElement(Typography, {\n    variant: \"subtitle1\",\n    className: pageLevel === 1 ? classes.title1 : classes.title2,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 128,\n      columnNumber: 13\n    }\n  }, title), isShowRefreshButton && /*#__PURE__*/React.createElement(Refresh, {\n    fontSize: \"small\",\n    onClick: () => refresh(),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 135,\n      columnNumber: 15\n    }\n  })));\n}));\nconst BottomBar = withStyles(({\n  spacing\n}) => {\n  return {\n    root: {\n      position: \"fixed\",\n      bottom: 0,\n      width: \"100%\",\n      height: window.screen.height >= \"812\" ? spacing(10) : spacing(9)\n    },\n    content: {\n      padding: 0,\n      \"&$selected\": {\n        paddingTop: 0\n      },\n      minWidth: \"unset\"\n    },\n    selected: {},\n    project: {\n      marginBottom: spacing(0.4),\n      transform: \"scaleX(-1)\"\n    }\n  };\n})(({\n  classes,\n  selected,\n  taskSum\n}) => {\n  const i18n = React.useContext(LocalizeContext);\n  return /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 168,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(BottomNavigation, {\n    value: selected,\n    showLabels: true,\n    className: classes.root,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 169,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(BottomNavigationAction, {\n    classes: {\n      root: classes.content,\n      selected: classes.selected\n    },\n    icon: /*#__PURE__*/React.createElement(Schedule, {\n      style: {\n        height: \"22\"\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 175,\n        columnNumber: 17\n      }\n    }),\n    component: Link,\n    label: i18n.JOBLIST_ACTIVITY,\n    to: \"/\",\n    value: \"activities\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 170,\n      columnNumber: 9\n    }\n  }), /*#__PURE__*/React.createElement(BottomNavigationAction, {\n    classes: {\n      root: classes.content,\n      selected: classes.selected\n    },\n    component: Link,\n    icon: /*#__PURE__*/React.createElement(\"img\", {\n      src: selected === \"projects\" ? SelectedProjectIcon : projectIcon,\n      height: \"20\",\n      className: classes.project,\n      alt: \"\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 188,\n        columnNumber: 13\n      }\n    }),\n    to: \"/projects\",\n    label: i18n.INSTAPP_PROJECTLIST_PROJECT,\n    value: \"projects\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 181,\n      columnNumber: 9\n    }\n  }), /*#__PURE__*/React.createElement(BottomNavigationAction, {\n    classes: {\n      root: classes.content,\n      selected: classes.selected\n    },\n    component: Link,\n    icon: /*#__PURE__*/React.createElement(AssignmentOutlined, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 205,\n        columnNumber: 17\n      }\n    }),\n    label: i18n.INSTAPP_JOBLIST_TASKS,\n    to: \"/TasksGroupPage\",\n    value: \"TasksGroupPage\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 199,\n      columnNumber: 9\n    }\n  }), /*#__PURE__*/React.createElement(BottomNavigationAction, {\n    classes: {\n      root: classes.content,\n      selected: classes.selected\n    },\n    component: Link,\n    icon: /*#__PURE__*/React.createElement(\"img\", {\n      src: selected === \"me\" ? fitter2 : fitter3,\n      width: \"26\",\n      alt: \"\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 217,\n        columnNumber: 13\n      }\n    }),\n    label: i18n.INSTAPP_JOBLIST_ME,\n    to: \"/me\",\n    value: \"me\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 210,\n      columnNumber: 9\n    }\n  })), /*#__PURE__*/React.createElement(Hint, {\n    taskSum: taskSum,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 228,\n      columnNumber: 7\n    }\n  }));\n});\nconst Hint = withStyles(({\n  spacing\n}) => {\n  return {\n    taskCount: {\n      position: \"fixed\",\n      right: \"30%\",\n      bottom: spacing(5),\n      backgroundColor: \"red\",\n      borderRadius: \"30px\",\n      color: \"white\",\n      width: \"24px\",\n      height: \"24px\",\n      textAlign: \"center\",\n      lineHeight: spacing(3) + \"px\"\n    }\n  };\n})(({\n  classes,\n  taskSum\n}) => {\n  const history = useHistory();\n  return /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 252,\n      columnNumber: 5\n    }\n  }, taskSum > 0 && /*#__PURE__*/React.createElement(\"span\", {\n    className: classes.taskCount,\n    onClick: () => history.push(\"/TasksGroupPage\"),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 254,\n      columnNumber: 9\n    }\n  }, taskSum));\n});\nconst PrimaryLayout = withStyles(({\n  spacing\n}) => {\n  return {\n    main: {\n      position: \"fixed\",\n      top: spacing(6.5),\n      left: 0,\n      right: 0,\n      bottom: window.screen.height >= \"812\" ? spacing(10) : spacing(9),\n      overflowY: \"scroll\"\n    }\n  };\n})(({\n  classes,\n  children,\n  name,\n  getData,\n  getLanguage,\n  getRefreshData,\n  title,\n  pageLevel,\n  isShowRefreshButton,\n  isDirectReturn = true,\n  goBack,\n  isFetchAll = true,\n  backPage,\n  setScrollPosition,\n  root,\n  taskSum\n}) => {\n  const history = useHistory();\n  const location = useLocation();\n  const mainRef = useRef(null);\n  let scrollPos = 0;\n  useEffect(() => {\n    repo.initDB();\n    getLanguage();\n    document.title = `安装质量管理App`;\n    isFetchAll && getData();\n    getRefreshData();\n  }, [getLanguage, title, getData, getRefreshData, isFetchAll]);\n\n  const scrollEvent = e => {\n    scrollPos = e.target.scrollTop;\n    setScrollPosition({\n      namepath: location.pathname,\n      position: scrollPos\n    });\n  };\n\n  return /*#__PURE__*/React.createElement(Fragment, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 316,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(TitleBar, {\n    title: title,\n    pageLevel: pageLevel,\n    isShowRefreshButton: isShowRefreshButton,\n    goBack: () => isDirectReturn ? backPage(history, name, root) : goBack(),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 317,\n      columnNumber: 9\n    }\n  }), /*#__PURE__*/React.createElement(\"main\", {\n    className: classes.main,\n    onScroll: scrollEvent,\n    ref: mainRef,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 325,\n      columnNumber: 9\n    }\n  }, children), /*#__PURE__*/React.createElement(BottomBar, {\n    selected: name,\n    taskSum: taskSum,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 328,\n      columnNumber: 9\n    }\n  }), /*#__PURE__*/React.createElement(Loading, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 329,\n      columnNumber: 9\n    }\n  }), /*#__PURE__*/React.createElement(Alert, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 330,\n      columnNumber: 9\n    }\n  }));\n});\nexport default connect(mapStateToProps, mapDispatchToProps)(PrimaryLayout);","map":{"version":3,"sources":["C:/project/SCF-NI_PM_App/SCF.InstallationQuality/react-client/src/layouts/PrimaryLayout/index.js"],"names":["AppBar","BottomNavigation","BottomNavigationAction","Toolbar","Typography","withStyles","ArrowBackIos","AssignmentOutlined","Refresh","Schedule","action","Alert","Loading","LocalizeContext","projectIcon","SelectedProjectIcon","db","repo","getTaskCount","recordRefreshTime","React","Fragment","useEffect","useRef","connect","Link","useHistory","useLocation","mapDispatchToProps","dispatch","logout","refresh","fetchAll","getData","type","CACHE","getLanguage","cache","get","then","language","data","setLanguage","getRefreshData","setScrollPosition","backPage","history","name","root","setOrderDetailPageDefaultTab","goBack","mapStateToProps","taskSum","awaitCloseNum","awaitComplateNum","TitleBar","spacing","appBar","borderBottomColor","borderBottomStyle","borderBottomWidth","toolbar","minHeight","backgroundColor","color","icon","minWidth","title1","textAlign","flex","fontFamily","fontSize","title2","classes","title","pageLevel","isShowRefreshButton","BottomBar","position","bottom","width","height","window","screen","content","padding","paddingTop","selected","project","marginBottom","transform","i18n","useContext","JOBLIST_ACTIVITY","INSTAPP_PROJECTLIST_PROJECT","INSTAPP_JOBLIST_TASKS","fitter2","fitter3","INSTAPP_JOBLIST_ME","Hint","taskCount","right","borderRadius","lineHeight","push","PrimaryLayout","main","top","left","overflowY","children","isDirectReturn","isFetchAll","location","mainRef","scrollPos","initDB","document","scrollEvent","e","target","scrollTop","namepath","pathname"],"mappings":"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","sourcesContent":["import {\r\n  AppBar,\r\n  BottomNavigation,\r\n  BottomNavigationAction,\r\n  Toolbar,\r\n  Typography,\r\n} from \"@material-ui/core\";\r\nimport { withStyles } from \"@material-ui/core/styles\";\r\nimport {\r\n  ArrowBackIos,\r\n  AssignmentOutlined,\r\n  Refresh,\r\n  Schedule,\r\n} from \"@material-ui/icons\";\r\nimport * as action from \"actions\";\r\nimport fitter2 from \"assets/svg/fitter2.svg\";\r\nimport fitter3 from \"assets/svg/fitter3.svg\";\r\nimport Alert from \"components/Alert\";\r\nimport Loading from \"components/Loading\";\r\nimport { LocalizeContext } from \"i18n\";\r\nimport projectIcon from \"img/project.png\";\r\nimport SelectedProjectIcon from \"img/selectedProject.png\";\r\nimport { db } from \"js/db\";\r\nimport * as repo from \"js/fetch\";\r\nimport { getTaskCount, recordRefreshTime } from \"js/util\";\r\nimport React, { Fragment, useEffect, useRef } from \"react\";\r\nimport { connect } from \"react-redux\";\r\nimport { Link, useHistory, useLocation } from \"react-router-dom\";\r\n\r\nconst mapDispatchToProps = (dispatch) => {\r\n  return {\r\n    logout: () => {\r\n      dispatch(action.logout());\r\n    },\r\n    refresh: () => {\r\n      dispatch(action.fetchAll());\r\n    },\r\n    getData: () => {\r\n      dispatch(action.fetchAll(repo.type.CACHE));\r\n    },\r\n    getLanguage: () => {\r\n      db.cache.get(\"settings\").then((cache) => {\r\n        if (!cache) {\r\n          return;\r\n        }\r\n        const {\r\n          language: { language },\r\n        } = cache.data;\r\n        dispatch(action.setLanguage(language));\r\n      });\r\n    },\r\n    getRefreshData: () => {\r\n      recordRefreshTime(dispatch);\r\n    },\r\n    setScrollPosition: (data) => {\r\n      dispatch(action.setScrollPosition(data));\r\n    },\r\n    backPage: (history, name, root) => {\r\n      if (name === \"activity Document\") {\r\n        dispatch(action.setOrderDetailPageDefaultTab(root));\r\n        history.goBack();\r\n      } else {\r\n        history.goBack();\r\n      }\r\n    },\r\n  };\r\n};\r\n\r\nconst mapStateToProps = () => {\r\n  const taskSum =\r\n    getTaskCount().awaitCloseNum + getTaskCount().awaitComplateNum;\r\n  return { taskSum };\r\n};\r\n\r\nconst TitleBar = withStyles(({ spacing }) => {\r\n  return {\r\n    appBar: {\r\n      borderBottomColor: \"#e0e0e0\",\r\n      borderBottomStyle: \"solid\",\r\n      borderBottomWidth: 1,\r\n    },\r\n    toolbar: {\r\n      minHeight: spacing(6.5),\r\n      backgroundColor: \"rgb(255,255,255)\",\r\n      color: \"black\",\r\n    },\r\n    icon: {\r\n      minWidth: spacing(5),\r\n    },\r\n    title1: {\r\n      textAlign: \"left\",\r\n      flex: 1,\r\n      fontFamily: \"'微软雅黑 Bold', '微软雅黑 Regular', '微软雅黑'\",\r\n      fontSize: 18,\r\n    },\r\n    title2: {\r\n      textAlign: \"center\",\r\n      flex: 1,\r\n      fontFamily: \"'微软雅黑 Bold', '微软雅黑 Regular', '微软雅黑'\",\r\n      fontSize: \"18px\",\r\n    },\r\n  };\r\n})(\r\n  connect(\r\n    null,\r\n    mapDispatchToProps\r\n  )(\r\n    ({\r\n      classes,\r\n      refresh,\r\n      title,\r\n      pageLevel,\r\n      isShowRefreshButton = false,\r\n      goBack,\r\n    }) => {\r\n      return (\r\n        <AppBar elevation={0} className={classes.appBar}>\r\n          <Toolbar className={classes.toolbar}>\r\n            {pageLevel !== 1 && (\r\n              <ArrowBackIos\r\n                aria-label=\"back\"\r\n                fontSize=\"small\"\r\n                onClick={() => {\r\n                  goBack();\r\n                }}\r\n              />\r\n            )}\r\n            <Typography\r\n              variant=\"subtitle1\"\r\n              className={pageLevel === 1 ? classes.title1 : classes.title2}\r\n            >\r\n              {title}\r\n            </Typography>\r\n            {isShowRefreshButton && (\r\n              <Refresh fontSize=\"small\" onClick={() => refresh()} />\r\n            )}\r\n          </Toolbar>\r\n        </AppBar>\r\n      );\r\n    }\r\n  )\r\n);\r\n\r\nconst BottomBar = withStyles(({ spacing }) => {\r\n  return {\r\n    root: {\r\n      position: \"fixed\",\r\n      bottom: 0,\r\n      width: \"100%\",\r\n      height: window.screen.height >= \"812\" ? spacing(10) : spacing(9),\r\n    },\r\n    content: {\r\n      padding: 0,\r\n      \"&$selected\": {\r\n        paddingTop: 0,\r\n      },\r\n      minWidth: \"unset\",\r\n    },\r\n    selected: {},\r\n    project: {\r\n      marginBottom: spacing(0.4),\r\n      transform: \"scaleX(-1)\",\r\n    },\r\n  };\r\n})(({ classes, selected, taskSum }) => {\r\n  const i18n = React.useContext(LocalizeContext);\r\n  return (\r\n    <div>\r\n      <BottomNavigation value={selected} showLabels className={classes.root}>\r\n        <BottomNavigationAction\r\n          classes={{\r\n            root: classes.content,\r\n            selected: classes.selected,\r\n          }}\r\n          icon={<Schedule style={{ height: \"22\" }} />}\r\n          component={Link}\r\n          label={i18n.JOBLIST_ACTIVITY}\r\n          to=\"/\"\r\n          value=\"activities\"\r\n        />\r\n        <BottomNavigationAction\r\n          classes={{\r\n            root: classes.content,\r\n            selected: classes.selected,\r\n          }}\r\n          component={Link}\r\n          icon={\r\n            <img\r\n              src={selected === \"projects\" ? SelectedProjectIcon : projectIcon}\r\n              height=\"20\"\r\n              className={classes.project}\r\n              alt=\"\"\r\n            />\r\n          }\r\n          to=\"/projects\"\r\n          label={i18n.INSTAPP_PROJECTLIST_PROJECT}\r\n          value=\"projects\"\r\n        />\r\n        <BottomNavigationAction\r\n          classes={{\r\n            root: classes.content,\r\n            selected: classes.selected,\r\n          }}\r\n          component={Link}\r\n          icon={<AssignmentOutlined />}\r\n          label={i18n.INSTAPP_JOBLIST_TASKS}\r\n          to=\"/TasksGroupPage\"\r\n          value=\"TasksGroupPage\"\r\n        />\r\n        <BottomNavigationAction\r\n          classes={{\r\n            root: classes.content,\r\n            selected: classes.selected,\r\n          }}\r\n          component={Link}\r\n          icon={\r\n            <img\r\n              src={selected === \"me\" ? fitter2 : fitter3}\r\n              width=\"26\"\r\n              alt=\"\"\r\n            />\r\n          }\r\n          label={i18n.INSTAPP_JOBLIST_ME}\r\n          to=\"/me\"\r\n          value=\"me\"\r\n        />\r\n      </BottomNavigation>\r\n      <Hint taskSum={taskSum} />\r\n    </div>\r\n  );\r\n});\r\n\r\nconst Hint = withStyles(({ spacing }) => {\r\n  return {\r\n    taskCount: {\r\n      position: \"fixed\",\r\n      right: \"30%\",\r\n      bottom: spacing(5),\r\n      backgroundColor: \"red\",\r\n      borderRadius: \"30px\",\r\n      color: \"white\",\r\n      width: \"24px\",\r\n      height: \"24px\",\r\n      textAlign: \"center\",\r\n      lineHeight: spacing(3) + \"px\",\r\n    },\r\n  };\r\n})(({ classes, taskSum }) => {\r\n  const history = useHistory();\r\n\r\n  return (\r\n    <div>\r\n      {taskSum > 0 && (\r\n        <span\r\n          className={classes.taskCount}\r\n          onClick={() => history.push(\"/TasksGroupPage\")}\r\n        >\r\n          {taskSum}\r\n        </span>\r\n      )}\r\n    </div>\r\n  );\r\n});\r\n\r\nconst PrimaryLayout = withStyles(({ spacing }) => {\r\n  return {\r\n    main: {\r\n      position: \"fixed\",\r\n      top: spacing(6.5),\r\n      left: 0,\r\n      right: 0,\r\n      bottom: window.screen.height >= \"812\" ? spacing(10) : spacing(9),\r\n      overflowY: \"scroll\",\r\n    },\r\n  };\r\n})(\r\n  ({\r\n    classes,\r\n    children,\r\n    name,\r\n    getData,\r\n    getLanguage,\r\n    getRefreshData,\r\n    title,\r\n    pageLevel,\r\n    isShowRefreshButton,\r\n    isDirectReturn = true,\r\n    goBack,\r\n    isFetchAll = true,\r\n    backPage,\r\n    setScrollPosition,\r\n    root,\r\n    taskSum,\r\n  }) => {\r\n    const history = useHistory();\r\n\r\n    const location = useLocation();\r\n\r\n    const mainRef = useRef(null);\r\n\r\n    let scrollPos = 0;\r\n    useEffect(() => {\r\n      repo.initDB();\r\n\r\n      getLanguage();\r\n      document.title = `安装质量管理App`;\r\n      isFetchAll && getData();\r\n      getRefreshData();\r\n    }, [getLanguage, title, getData, getRefreshData, isFetchAll]);\r\n\r\n    const scrollEvent = (e) => {\r\n      scrollPos = e.target.scrollTop;\r\n      setScrollPosition({ namepath: location.pathname, position: scrollPos });\r\n    };\r\n    return (\r\n      <Fragment>\r\n        <TitleBar\r\n          title={title}\r\n          pageLevel={pageLevel}\r\n          isShowRefreshButton={isShowRefreshButton}\r\n          goBack={() =>\r\n            isDirectReturn ? backPage(history, name, root) : goBack()\r\n          }\r\n        />\r\n        <main className={classes.main} onScroll={scrollEvent} ref={mainRef}>\r\n          {children}\r\n        </main>\r\n        <BottomBar selected={name} taskSum={taskSum} />\r\n        <Loading />\r\n        <Alert />\r\n      </Fragment>\r\n    );\r\n  }\r\n);\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(PrimaryLayout);\r\n"]},"metadata":{},"sourceType":"module"}