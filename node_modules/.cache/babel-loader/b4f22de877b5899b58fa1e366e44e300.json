{"ast":null,"code":"import _defineProperty from\"C:\\\\project\\\\SCF-NI_PM_App\\\\SCF.InstallationQuality\\\\react-client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/defineProperty\";/**\r\n * Copyright (C) 2016 All rights reserved.\r\n *\r\n * Redistribution and use in source and binary forms, with or without modification,\r\n * are not permitted unless explicitly granted in writing.\r\n *\r\n * Usage and modification rights granted to Schindler AG, Ebikon.\r\n */import{appendChild,appendQuestionBlock,hasChildNode,getChildNode,getChildNodes,getRequiredAttr,getAttrWithDefault,readQuestionBlock}from\"./utils/xml\";import{DEFAULT_LANG}from\"./constants/global\";import uuid from\"node-uuid\";export default{serialize:function serialize(doc,findField,parentNode,field){var _field$settings=field.settings,trs=_field$settings.trs,changeNotAllowed=_field$settings.changeNotAllowed;var questionBlock=appendQuestionBlock(doc,findField,parentNode,\"string[]\",field);var attr={\"change-not-allowed\":changeNotAllowed};var table=appendChild(doc,questionBlock,\"table\",\"\",attr);trs.forEach(function(tr){var trNode=appendChild(doc,table,\"tr\");tr.tds.forEach(function(td){var attr=tr.columnHeader?{width:td.width}:{};var tdNode=appendChild(doc,trNode,\"td\",\"\",attr);if(tr.columnHeader===true||td.rowHeader===true||changeNotAllowed){Object.keys(td.nameI18n).forEach(function(lang){if(typeof td.nameI18n[lang]!==\"undefined\"){appendChild(doc,tdNode,\"text\",td.nameI18n[lang],{lang:lang});}});}else{appendChild(doc,tdNode,\"textfield\",td.name);}});});},canDeserialize:function canDeserialize(node){return node.nodeName===\"question_block\"&&hasChildNode(node,\"table\");},deserialize:function deserialize(node){var field=readQuestionBlock(node,\"table\",\"string[]\");// eslint-disable-line prefer-const\nvar tableNode=getChildNode(node,\"table\");var trNodes=getChildNodes(tableNode,\"tr\");var changeNotAllowed=getAttrWithDefault(tableNode,\"change-not-allowed\",\"false\")===\"true\";var trs=[];// eslint-disable-line prefer-const\nfield.settings.trs=trs;field.settings.required=getRequiredAttr(node,\"required\")===\"true\";trNodes.forEach(function(trNode,trIndex){var trId=uuid.v4();var tds=[];if(trIndex===0){trs.push({id:trId,columnHeader:true,tds:tds});}else{trs.push({id:trId,tds:tds});}var tdNodes=getChildNodes(trNode,\"td\");tdNodes.forEach(function(tdNode,tdIndex){var tdId=uuid.v4();trs[trIndex].tds.push({id:tdId});if(trIndex===0){var _nameI18n=getChildNodes(tdNode,\"text\").reduce(function(acc,textNode){return Object.assign({},acc,_defineProperty({},getAttrWithDefault(textNode,\"lang\",DEFAULT_LANG),textNode.textContent));},{});trs[trIndex].tds[tdIndex].nameI18n=_nameI18n;trs[trIndex].tds[tdIndex].width=getAttrWithDefault(tdNode,\"width\",0);}else if(tdIndex===0){trs[trIndex].tds[tdIndex].rowHeader=true;var _nameI18n2=getChildNodes(tdNode,\"text\").reduce(function(acc,textNode){return Object.assign({},acc,_defineProperty({},getAttrWithDefault(textNode,\"lang\",DEFAULT_LANG),textNode.textContent));},{});trs[trIndex].tds[tdIndex].nameI18n=_nameI18n2;}else if(changeNotAllowed){var contentNode=getChildNode(tdNode,\"textfield\");var _nameI18n3={};if(contentNode.hasAttribute(\"lang\")){_nameI18n3=getChildNodes(tdNode,\"text\").reduce(function(acc,textNode){return Object.assign({},acc,_defineProperty({},getAttrWithDefault(textNode,\"lang\",DEFAULT_LANG),textNode.textContent));},{});}else{//Compatible with older versions\n_nameI18n3[DEFAULT_LANG]=contentNode.textContent!==\"\"&&contentNode.textContent!==undefined?contentNode.textContent:undefined;}trs[trIndex].tds[tdIndex].nameI18n=_nameI18n3;}else{var _contentNode=getChildNode(tdNode,\"textfield\");var nameI18n={};nameI18n[DEFAULT_LANG]=_contentNode.textContent!==\"\"&&_contentNode.textContent!==undefined?_contentNode.textContent:undefined;trs[trIndex].tds[tdIndex].nameI18n=nameI18n;}});});field.settings.changeNotAllowed=changeNotAllowed;return field;}};","map":{"version":3,"sources":["C:/project/SCF-NI_PM_App/SCF.InstallationQuality/react-client/src/js/sfdl/TableIO.js"],"names":["appendChild","appendQuestionBlock","hasChildNode","getChildNode","getChildNodes","getRequiredAttr","getAttrWithDefault","readQuestionBlock","DEFAULT_LANG","uuid","serialize","doc","findField","parentNode","field","settings","trs","changeNotAllowed","questionBlock","attr","table","forEach","tr","trNode","tds","td","columnHeader","width","tdNode","rowHeader","Object","keys","nameI18n","lang","name","canDeserialize","node","nodeName","deserialize","tableNode","trNodes","required","trIndex","trId","v4","push","id","tdNodes","tdIndex","tdId","reduce","acc","textNode","assign","textContent","contentNode","hasAttribute","undefined"],"mappings":"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","sourcesContent":["/**\r\n * Copyright (C) 2016 All rights reserved.\r\n *\r\n * Redistribution and use in source and binary forms, with or without modification,\r\n * are not permitted unless explicitly granted in writing.\r\n *\r\n * Usage and modification rights granted to Schindler AG, Ebikon.\r\n */\r\n\r\nimport {\r\n  appendChild,\r\n  appendQuestionBlock,\r\n  hasChildNode,\r\n  getChildNode,\r\n  getChildNodes,\r\n  getRequiredAttr,\r\n  getAttrWithDefault,\r\n  readQuestionBlock,\r\n} from \"./utils/xml\";\r\nimport { DEFAULT_LANG } from \"./constants/global\";\r\nimport uuid from \"node-uuid\";\r\n\r\nexport default {\r\n  serialize(doc, findField, parentNode, field) {\r\n    const { trs, changeNotAllowed } = field.settings;\r\n    const questionBlock = appendQuestionBlock(\r\n      doc,\r\n      findField,\r\n      parentNode,\r\n      \"string[]\",\r\n      field\r\n    );\r\n    var attr = { \"change-not-allowed\": changeNotAllowed };\r\n\r\n    const table = appendChild(doc, questionBlock, \"table\", \"\", attr);\r\n\r\n    trs.forEach((tr) => {\r\n      const trNode = appendChild(doc, table, \"tr\");\r\n\r\n      tr.tds.forEach((td) => {\r\n        var attr = tr.columnHeader ? { width: td.width } : {};\r\n        const tdNode = appendChild(doc, trNode, \"td\", \"\", attr);\r\n        if (\r\n          tr.columnHeader === true ||\r\n          td.rowHeader === true ||\r\n          changeNotAllowed\r\n        ) {\r\n          Object.keys(td.nameI18n).forEach((lang) => {\r\n            if (typeof td.nameI18n[lang] !== \"undefined\") {\r\n              appendChild(doc, tdNode, \"text\", td.nameI18n[lang], { lang });\r\n            }\r\n          });\r\n        } else {\r\n          appendChild(doc, tdNode, \"textfield\", td.name);\r\n        }\r\n      });\r\n    });\r\n  },\r\n\r\n  canDeserialize(node) {\r\n    return node.nodeName === \"question_block\" && hasChildNode(node, \"table\");\r\n  },\r\n\r\n  deserialize(node) {\r\n    let field = readQuestionBlock(node, \"table\", \"string[]\"); // eslint-disable-line prefer-const\r\n\r\n    const tableNode = getChildNode(node, \"table\");\r\n    const trNodes = getChildNodes(tableNode, \"tr\");\r\n    const changeNotAllowed =\r\n      getAttrWithDefault(tableNode, \"change-not-allowed\", \"false\") === \"true\";\r\n    let trs = []; // eslint-disable-line prefer-const\r\n    field.settings.trs = trs;\r\n    field.settings.required = getRequiredAttr(node, \"required\") === \"true\";\r\n\r\n    trNodes.forEach((trNode, trIndex) => {\r\n      const trId = uuid.v4();\r\n      let tds = [];\r\n      if (trIndex === 0) {\r\n        trs.push({\r\n          id: trId,\r\n          columnHeader: true,\r\n          tds: tds,\r\n        });\r\n      } else {\r\n        trs.push({\r\n          id: trId,\r\n          tds: tds,\r\n        });\r\n      }\r\n      const tdNodes = getChildNodes(trNode, \"td\");\r\n\r\n      tdNodes.forEach((tdNode, tdIndex) => {\r\n        const tdId = uuid.v4();\r\n        trs[trIndex].tds.push({\r\n          id: tdId,\r\n        });\r\n\r\n        if (trIndex === 0) {\r\n          const nameI18n = getChildNodes(tdNode, \"text\").reduce(\r\n            (acc, textNode) => {\r\n              return Object.assign({}, acc, {\r\n                [getAttrWithDefault(\r\n                  textNode,\r\n                  \"lang\",\r\n                  DEFAULT_LANG\r\n                )]: textNode.textContent,\r\n              });\r\n            },\r\n            {}\r\n          );\r\n          trs[trIndex].tds[tdIndex].nameI18n = nameI18n;\r\n          trs[trIndex].tds[tdIndex].width = getAttrWithDefault(\r\n            tdNode,\r\n            \"width\",\r\n            0\r\n          );\r\n        } else if (tdIndex === 0) {\r\n          trs[trIndex].tds[tdIndex].rowHeader = true;\r\n          const nameI18n = getChildNodes(tdNode, \"text\").reduce(\r\n            (acc, textNode) => {\r\n              return Object.assign({}, acc, {\r\n                [getAttrWithDefault(\r\n                  textNode,\r\n                  \"lang\",\r\n                  DEFAULT_LANG\r\n                )]: textNode.textContent,\r\n              });\r\n            },\r\n            {}\r\n          );\r\n          trs[trIndex].tds[tdIndex].nameI18n = nameI18n;\r\n        } else if (changeNotAllowed) {\r\n          const contentNode = getChildNode(tdNode, \"textfield\");\r\n          let nameI18n = {};\r\n          if (contentNode.hasAttribute(\"lang\")) {\r\n            nameI18n = getChildNodes(tdNode, \"text\").reduce((acc, textNode) => {\r\n              return Object.assign({}, acc, {\r\n                [getAttrWithDefault(\r\n                  textNode,\r\n                  \"lang\",\r\n                  DEFAULT_LANG\r\n                )]: textNode.textContent,\r\n              });\r\n            }, {});\r\n          } else {\r\n            //Compatible with older versions\r\n            nameI18n[DEFAULT_LANG] =\r\n              contentNode.textContent !== \"\" &&\r\n              contentNode.textContent !== undefined\r\n                ? contentNode.textContent\r\n                : undefined;\r\n          }\r\n          trs[trIndex].tds[tdIndex].nameI18n = nameI18n;\r\n        } else {\r\n          const contentNode = getChildNode(tdNode, \"textfield\");\r\n          var nameI18n = {};\r\n          nameI18n[DEFAULT_LANG] =\r\n            contentNode.textContent !== \"\" &&\r\n            contentNode.textContent !== undefined\r\n              ? contentNode.textContent\r\n              : undefined;\r\n          trs[trIndex].tds[tdIndex].nameI18n = nameI18n;\r\n        }\r\n      });\r\n    });\r\n\r\n    field.settings.changeNotAllowed = changeNotAllowed;\r\n\r\n    return field;\r\n  },\r\n};\r\n"]},"metadata":{},"sourceType":"module"}