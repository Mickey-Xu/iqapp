{"ast":null,"code":"import{AppBar,BottomNavigation,BottomNavigationAction,Toolbar,Typography}from\"@material-ui/core\";import{withStyles}from\"@material-ui/core/styles\";import{ArrowBackIos,AssignmentOutlined,Refresh,Schedule}from\"@material-ui/icons\";import*as action from\"actions\";import fitter2 from\"assets/svg/fitter2.svg\";import fitter3 from\"assets/svg/fitter3.svg\";import Alert from\"components/Alert\";import Loading from\"components/Loading\";import{LocalizeContext}from\"i18n\";import projectIcon from\"img/project.png\";import SelectedProjectIcon from\"img/selectedProject.png\";import{db}from\"js/db\";import*as repo from\"js/fetch\";import{getTaskCount,recordRefreshTime}from\"js/util\";import React,{Fragment,useEffect,useRef}from\"react\";import{connect}from\"react-redux\";import{Link,useHistory,useLocation}from\"react-router-dom\";var mapDispatchToProps=function mapDispatchToProps(dispatch){return{logout:function logout(){dispatch(action.logout());},refresh:function refresh(){dispatch(action.fetchAll());},getData:function getData(){dispatch(action.fetchAll(repo.type.CACHE));},getLanguage:function getLanguage(){db.cache.get(\"settings\").then(function(cache){if(!cache){return;}var language=cache.data.language.language;dispatch(action.setLanguage(language));});},getRefreshData:function getRefreshData(){recordRefreshTime(dispatch);},setScrollPosition:function setScrollPosition(data){dispatch(action.setScrollPosition(data));},backPage:function backPage(history,name,root){if(name===\"activity Document\"){dispatch(action.setOrderDetailPageDefaultTab(root));history.goBack();}else{history.goBack();}}};};var mapStateToProps=function mapStateToProps(){var taskSum=getTaskCount().awaitCloseNum+getTaskCount().awaitComplateNum;return{taskSum:taskSum};};var TitleBar=withStyles(function(_ref){var spacing=_ref.spacing;return{appBar:{borderBottomColor:\"#e0e0e0\",borderBottomStyle:\"solid\",borderBottomWidth:1},toolbar:{minHeight:spacing(6.5),backgroundColor:\"rgb(255,255,255)\",color:\"black\"},icon:{minWidth:spacing(5)},title1:{textAlign:\"left\",flex:1,fontFamily:\"'微软雅黑 Bold', '微软雅黑 Regular', '微软雅黑'\",fontSize:18},title2:{textAlign:\"center\",flex:1,fontFamily:\"'微软雅黑 Bold', '微软雅黑 Regular', '微软雅黑'\",fontSize:\"18px\"}};})(connect(null,mapDispatchToProps)(function(_ref2){var classes=_ref2.classes,refresh=_ref2.refresh,title=_ref2.title,pageLevel=_ref2.pageLevel,_ref2$isShowRefreshBu=_ref2.isShowRefreshButton,isShowRefreshButton=_ref2$isShowRefreshBu===void 0?false:_ref2$isShowRefreshBu,goBack=_ref2.goBack;return/*#__PURE__*/React.createElement(AppBar,{elevation:0,className:classes.appBar},/*#__PURE__*/React.createElement(Toolbar,{className:classes.toolbar},pageLevel!==1&&/*#__PURE__*/React.createElement(ArrowBackIos,{\"aria-label\":\"back\",fontSize:\"small\",onClick:function onClick(){goBack();}}),/*#__PURE__*/React.createElement(Typography,{variant:\"subtitle1\",className:pageLevel===1?classes.title1:classes.title2},title),isShowRefreshButton&&/*#__PURE__*/React.createElement(Refresh,{fontSize:\"small\",onClick:function onClick(){return refresh();}})));}));var BottomBar=withStyles(function(_ref3){var spacing=_ref3.spacing;return{root:{position:\"fixed\",bottom:0,width:\"100%\",height:window.screen.height>=\"812\"?spacing(10):spacing(9)},content:{padding:0,\"&$selected\":{paddingTop:0},minWidth:\"unset\"},selected:{},project:{marginBottom:spacing(0.4),transform:\"scaleX(-1)\"}};})(function(_ref4){var classes=_ref4.classes,selected=_ref4.selected,taskSum=_ref4.taskSum;var i18n=React.useContext(LocalizeContext);return/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(BottomNavigation,{value:selected,showLabels:true,className:classes.root},/*#__PURE__*/React.createElement(BottomNavigationAction,{classes:{root:classes.content,selected:classes.selected},icon:/*#__PURE__*/React.createElement(Schedule,{style:{height:\"22\"}}),component:Link,label:i18n.JOBLIST_ACTIVITY,to:\"/\",value:\"activities\"}),/*#__PURE__*/React.createElement(BottomNavigationAction,{classes:{root:classes.content,selected:classes.selected},component:Link,icon:/*#__PURE__*/React.createElement(\"img\",{src:selected===\"projects\"?SelectedProjectIcon:projectIcon,height:\"20\",className:classes.project,alt:\"\"}),to:\"/projects\",label:i18n.INSTAPP_PROJECTLIST_PROJECT,value:\"projects\"}),/*#__PURE__*/React.createElement(BottomNavigationAction,{classes:{root:classes.content,selected:classes.selected},component:Link,icon:/*#__PURE__*/React.createElement(AssignmentOutlined,null),label:i18n.INSTAPP_JOBLIST_TASKS,to:\"/taskManagerment\",value:\"taskManagerment\"}),/*#__PURE__*/React.createElement(BottomNavigationAction,{classes:{root:classes.content,selected:classes.selected},component:Link,icon:/*#__PURE__*/React.createElement(\"img\",{src:selected===\"me\"?fitter2:fitter3,width:\"26\",alt:\"\"}),label:i18n.INSTAPP_JOBLIST_ME,to:\"/me\",value:\"me\"})),/*#__PURE__*/React.createElement(Hint,{taskSum:taskSum}));});var Hint=withStyles(function(_ref5){var spacing=_ref5.spacing;return{taskCount:{position:\"fixed\",right:\"30%\",bottom:spacing(5),backgroundColor:\"red\",borderRadius:\"30px\",color:\"white\",width:\"24px\",height:\"24px\",textAlign:\"center\",lineHeight:spacing(3)+\"px\"}};})(function(_ref6){var classes=_ref6.classes,taskSum=_ref6.taskSum;var history=useHistory();return/*#__PURE__*/React.createElement(\"div\",null,taskSum>0&&/*#__PURE__*/React.createElement(\"span\",{className:classes.taskCount,onClick:function onClick(){return history.push(\"/taskManagerment\");}},taskSum));});var PrimaryLayout=withStyles(function(_ref7){var spacing=_ref7.spacing;return{main:{position:\"fixed\",top:spacing(6.5),left:0,right:0,bottom:window.screen.height>=\"812\"?spacing(10):spacing(9),overflowY:\"scroll\"}};})(function(_ref8){var classes=_ref8.classes,children=_ref8.children,name=_ref8.name,getData=_ref8.getData,getLanguage=_ref8.getLanguage,getRefreshData=_ref8.getRefreshData,title=_ref8.title,pageLevel=_ref8.pageLevel,isShowRefreshButton=_ref8.isShowRefreshButton,_ref8$isDirectReturn=_ref8.isDirectReturn,isDirectReturn=_ref8$isDirectReturn===void 0?true:_ref8$isDirectReturn,_goBack=_ref8.goBack,_ref8$isFetchAll=_ref8.isFetchAll,isFetchAll=_ref8$isFetchAll===void 0?true:_ref8$isFetchAll,backPage=_ref8.backPage,setScrollPosition=_ref8.setScrollPosition,root=_ref8.root,taskSum=_ref8.taskSum;var history=useHistory();var location=useLocation();var mainRef=useRef(null);var scrollPos=0;useEffect(function(){repo.initDB();getLanguage();document.title=\"\\u5B89\\u88C5\\u8D28\\u91CF\\u7BA1\\u7406App\";isFetchAll&&getData();getRefreshData();},[getLanguage,title,getData,getRefreshData,isFetchAll]);var scrollEvent=function scrollEvent(e){scrollPos=e.target.scrollTop;setScrollPosition({namepath:location.pathname,position:scrollPos});};return/*#__PURE__*/React.createElement(Fragment,null,/*#__PURE__*/React.createElement(TitleBar,{title:title,pageLevel:pageLevel,isShowRefreshButton:isShowRefreshButton,goBack:function goBack(){return isDirectReturn?backPage(history,name,root):_goBack();}}),/*#__PURE__*/React.createElement(\"main\",{className:classes.main,onScroll:scrollEvent,ref:mainRef},children),/*#__PURE__*/React.createElement(BottomBar,{selected:name,taskSum:taskSum}),/*#__PURE__*/React.createElement(Loading,null),/*#__PURE__*/React.createElement(Alert,null));});export default connect(mapStateToProps,mapDispatchToProps)(PrimaryLayout);","map":{"version":3,"sources":["C:/project/SCF-NI_PM_App/SCF.InstallationQuality/react-client/src/layouts/PrimaryLayout/index.js"],"names":["AppBar","BottomNavigation","BottomNavigationAction","Toolbar","Typography","withStyles","ArrowBackIos","AssignmentOutlined","Refresh","Schedule","action","Alert","Loading","LocalizeContext","projectIcon","SelectedProjectIcon","db","repo","getTaskCount","recordRefreshTime","React","Fragment","useEffect","useRef","connect","Link","useHistory","useLocation","mapDispatchToProps","dispatch","logout","refresh","fetchAll","getData","type","CACHE","getLanguage","cache","get","then","language","data","setLanguage","getRefreshData","setScrollPosition","backPage","history","name","root","setOrderDetailPageDefaultTab","goBack","mapStateToProps","taskSum","awaitCloseNum","awaitComplateNum","TitleBar","spacing","appBar","borderBottomColor","borderBottomStyle","borderBottomWidth","toolbar","minHeight","backgroundColor","color","icon","minWidth","title1","textAlign","flex","fontFamily","fontSize","title2","classes","title","pageLevel","isShowRefreshButton","BottomBar","position","bottom","width","height","window","screen","content","padding","paddingTop","selected","project","marginBottom","transform","i18n","useContext","JOBLIST_ACTIVITY","INSTAPP_PROJECTLIST_PROJECT","INSTAPP_JOBLIST_TASKS","fitter2","fitter3","INSTAPP_JOBLIST_ME","Hint","taskCount","right","borderRadius","lineHeight","push","PrimaryLayout","main","top","left","overflowY","children","isDirectReturn","isFetchAll","location","mainRef","scrollPos","initDB","document","scrollEvent","e","target","scrollTop","namepath","pathname"],"mappings":"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","sourcesContent":["import {\r\n  AppBar,\r\n  BottomNavigation,\r\n  BottomNavigationAction,\r\n  Toolbar,\r\n  Typography,\r\n} from \"@material-ui/core\";\r\nimport { withStyles } from \"@material-ui/core/styles\";\r\nimport {\r\n  ArrowBackIos,\r\n  AssignmentOutlined,\r\n  Refresh,\r\n  Schedule,\r\n} from \"@material-ui/icons\";\r\nimport * as action from \"actions\";\r\nimport fitter2 from \"assets/svg/fitter2.svg\";\r\nimport fitter3 from \"assets/svg/fitter3.svg\";\r\nimport Alert from \"components/Alert\";\r\nimport Loading from \"components/Loading\";\r\nimport { LocalizeContext } from \"i18n\";\r\nimport projectIcon from \"img/project.png\";\r\nimport SelectedProjectIcon from \"img/selectedProject.png\";\r\nimport { db } from \"js/db\";\r\nimport * as repo from \"js/fetch\";\r\nimport { getTaskCount, recordRefreshTime } from \"js/util\";\r\nimport React, { Fragment, useEffect, useRef } from \"react\";\r\nimport { connect } from \"react-redux\";\r\nimport { Link, useHistory, useLocation } from \"react-router-dom\";\r\n\r\nconst mapDispatchToProps = (dispatch) => {\r\n  return {\r\n    logout: () => {\r\n      dispatch(action.logout());\r\n    },\r\n    refresh: () => {\r\n      dispatch(action.fetchAll());\r\n    },\r\n    getData: () => {\r\n      dispatch(action.fetchAll(repo.type.CACHE));\r\n    },\r\n    getLanguage: () => {\r\n      db.cache.get(\"settings\").then((cache) => {\r\n        if (!cache) {\r\n          return;\r\n        }\r\n        const {\r\n          language: { language },\r\n        } = cache.data;\r\n        dispatch(action.setLanguage(language));\r\n      });\r\n    },\r\n    getRefreshData: () => {\r\n      recordRefreshTime(dispatch);\r\n    },\r\n    setScrollPosition: (data) => {\r\n      dispatch(action.setScrollPosition(data));\r\n    },\r\n    backPage: (history, name, root) => {\r\n      if (name === \"activity Document\") {\r\n        dispatch(action.setOrderDetailPageDefaultTab(root));\r\n        history.goBack();\r\n      } else {\r\n        history.goBack();\r\n      }\r\n    },\r\n  };\r\n};\r\n\r\nconst mapStateToProps = () => {\r\n  const taskSum =\r\n    getTaskCount().awaitCloseNum + getTaskCount().awaitComplateNum;\r\n  return { taskSum };\r\n};\r\n\r\nconst TitleBar = withStyles(({ spacing }) => {\r\n  return {\r\n    appBar: {\r\n      borderBottomColor: \"#e0e0e0\",\r\n      borderBottomStyle: \"solid\",\r\n      borderBottomWidth: 1,\r\n    },\r\n    toolbar: {\r\n      minHeight: spacing(6.5),\r\n      backgroundColor: \"rgb(255,255,255)\",\r\n      color: \"black\",\r\n    },\r\n    icon: {\r\n      minWidth: spacing(5),\r\n    },\r\n    title1: {\r\n      textAlign: \"left\",\r\n      flex: 1,\r\n      fontFamily: \"'微软雅黑 Bold', '微软雅黑 Regular', '微软雅黑'\",\r\n      fontSize: 18,\r\n    },\r\n    title2: {\r\n      textAlign: \"center\",\r\n      flex: 1,\r\n      fontFamily: \"'微软雅黑 Bold', '微软雅黑 Regular', '微软雅黑'\",\r\n      fontSize: \"18px\",\r\n    },\r\n  };\r\n})(\r\n  connect(\r\n    null,\r\n    mapDispatchToProps\r\n  )(\r\n    ({\r\n      classes,\r\n      refresh,\r\n      title,\r\n      pageLevel,\r\n      isShowRefreshButton = false,\r\n      goBack,\r\n    }) => {\r\n      return (\r\n        <AppBar elevation={0} className={classes.appBar}>\r\n          <Toolbar className={classes.toolbar}>\r\n            {pageLevel !== 1 && (\r\n              <ArrowBackIos\r\n                aria-label=\"back\"\r\n                fontSize=\"small\"\r\n                onClick={() => {\r\n                  goBack();\r\n                }}\r\n              />\r\n            )}\r\n            <Typography\r\n              variant=\"subtitle1\"\r\n              className={pageLevel === 1 ? classes.title1 : classes.title2}\r\n            >\r\n              {title}\r\n            </Typography>\r\n            {isShowRefreshButton && (\r\n              <Refresh fontSize=\"small\" onClick={() => refresh()} />\r\n            )}\r\n          </Toolbar>\r\n        </AppBar>\r\n      );\r\n    }\r\n  )\r\n);\r\n\r\nconst BottomBar = withStyles(({ spacing }) => {\r\n  return {\r\n    root: {\r\n      position: \"fixed\",\r\n      bottom: 0,\r\n      width: \"100%\",\r\n      height: window.screen.height >= \"812\" ? spacing(10) : spacing(9),\r\n    },\r\n    content: {\r\n      padding: 0,\r\n      \"&$selected\": {\r\n        paddingTop: 0,\r\n      },\r\n      minWidth: \"unset\",\r\n    },\r\n    selected: {},\r\n    project: {\r\n      marginBottom: spacing(0.4),\r\n      transform: \"scaleX(-1)\",\r\n    },\r\n  };\r\n})(({ classes, selected, taskSum }) => {\r\n  const i18n = React.useContext(LocalizeContext);\r\n  return (\r\n    <div>\r\n      <BottomNavigation value={selected} showLabels className={classes.root}>\r\n        <BottomNavigationAction\r\n          classes={{\r\n            root: classes.content,\r\n            selected: classes.selected,\r\n          }}\r\n          icon={<Schedule style={{ height: \"22\" }} />}\r\n          component={Link}\r\n          label={i18n.JOBLIST_ACTIVITY}\r\n          to=\"/\"\r\n          value=\"activities\"\r\n        />\r\n        <BottomNavigationAction\r\n          classes={{\r\n            root: classes.content,\r\n            selected: classes.selected,\r\n          }}\r\n          component={Link}\r\n          icon={\r\n            <img\r\n              src={selected === \"projects\" ? SelectedProjectIcon : projectIcon}\r\n              height=\"20\"\r\n              className={classes.project}\r\n              alt=\"\"\r\n            />\r\n          }\r\n          to=\"/projects\"\r\n          label={i18n.INSTAPP_PROJECTLIST_PROJECT}\r\n          value=\"projects\"\r\n        />\r\n        <BottomNavigationAction\r\n          classes={{\r\n            root: classes.content,\r\n            selected: classes.selected,\r\n          }}\r\n          component={Link}\r\n          icon={<AssignmentOutlined />}\r\n          label={i18n.INSTAPP_JOBLIST_TASKS}\r\n          to=\"/taskManagerment\"\r\n          value=\"taskManagerment\"\r\n        />\r\n        <BottomNavigationAction\r\n          classes={{\r\n            root: classes.content,\r\n            selected: classes.selected,\r\n          }}\r\n          component={Link}\r\n          icon={\r\n            <img\r\n              src={selected === \"me\" ? fitter2 : fitter3}\r\n              width=\"26\"\r\n              alt=\"\"\r\n            />\r\n          }\r\n          label={i18n.INSTAPP_JOBLIST_ME}\r\n          to=\"/me\"\r\n          value=\"me\"\r\n        />\r\n      </BottomNavigation>\r\n      <Hint taskSum={taskSum} />\r\n    </div>\r\n  );\r\n});\r\n\r\nconst Hint = withStyles(({ spacing }) => {\r\n  return {\r\n    taskCount: {\r\n      position: \"fixed\",\r\n      right: \"30%\",\r\n      bottom: spacing(5),\r\n      backgroundColor: \"red\",\r\n      borderRadius: \"30px\",\r\n      color: \"white\",\r\n      width: \"24px\",\r\n      height: \"24px\",\r\n      textAlign: \"center\",\r\n      lineHeight: spacing(3) + \"px\",\r\n    },\r\n  };\r\n})(({ classes, taskSum }) => {\r\n  const history = useHistory();\r\n\r\n  return (\r\n    <div>\r\n      {taskSum > 0 && (\r\n        <span\r\n          className={classes.taskCount}\r\n          onClick={() => history.push(\"/taskManagerment\")}\r\n        >\r\n          {taskSum}\r\n        </span>\r\n      )}\r\n    </div>\r\n  );\r\n});\r\n\r\nconst PrimaryLayout = withStyles(({ spacing }) => {\r\n  return {\r\n    main: {\r\n      position: \"fixed\",\r\n      top: spacing(6.5),\r\n      left: 0,\r\n      right: 0,\r\n      bottom: window.screen.height >= \"812\" ? spacing(10) : spacing(9),\r\n      overflowY: \"scroll\",\r\n    },\r\n  };\r\n})(\r\n  ({\r\n    classes,\r\n    children,\r\n    name,\r\n    getData,\r\n    getLanguage,\r\n    getRefreshData,\r\n    title,\r\n    pageLevel,\r\n    isShowRefreshButton,\r\n    isDirectReturn = true,\r\n    goBack,\r\n    isFetchAll = true,\r\n    backPage,\r\n    setScrollPosition,\r\n    root,\r\n    taskSum,\r\n  }) => {\r\n    const history = useHistory();\r\n\r\n    const location = useLocation();\r\n\r\n    const mainRef = useRef(null);\r\n\r\n    let scrollPos = 0;\r\n    useEffect(() => {\r\n      repo.initDB();\r\n\r\n      getLanguage();\r\n      document.title = `安装质量管理App`;\r\n      isFetchAll && getData();\r\n      getRefreshData();\r\n    }, [getLanguage, title, getData, getRefreshData, isFetchAll]);\r\n\r\n    const scrollEvent = (e) => {\r\n      scrollPos = e.target.scrollTop;\r\n      setScrollPosition({ namepath: location.pathname, position: scrollPos });\r\n    };\r\n    return (\r\n      <Fragment>\r\n        <TitleBar\r\n          title={title}\r\n          pageLevel={pageLevel}\r\n          isShowRefreshButton={isShowRefreshButton}\r\n          goBack={() =>\r\n            isDirectReturn ? backPage(history, name, root) : goBack()\r\n          }\r\n        />\r\n        <main className={classes.main} onScroll={scrollEvent} ref={mainRef}>\r\n          {children}\r\n        </main>\r\n        <BottomBar selected={name} taskSum={taskSum} />\r\n        <Loading />\r\n        <Alert />\r\n      </Fragment>\r\n    );\r\n  }\r\n);\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(PrimaryLayout);\r\n"]},"metadata":{},"sourceType":"module"}