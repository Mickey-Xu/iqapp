{"ast":null,"code":"import _regeneratorRuntime from\"C:\\\\project\\\\SCF-NI_PM_App\\\\SCF.InstallationQuality\\\\react-client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";import _asyncToGenerator from\"C:\\\\project\\\\SCF-NI_PM_App\\\\SCF.InstallationQuality\\\\react-client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"C:\\\\project\\\\SCF-NI_PM_App\\\\SCF.InstallationQuality\\\\react-client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";import AppBar from'@material-ui/core/AppBar';import Dialog from'@material-ui/core/Dialog';import{IconButton,Button,Box}from'@material-ui/core';import List from'@material-ui/core/List';import Slide from'@material-ui/core/Slide';import{makeStyles}from'@material-ui/core/styles';import Toolbar from'@material-ui/core/Toolbar';import Typography from'@material-ui/core/Typography';import CloseIcon from'@material-ui/icons/Close';import React,{useRef,useState}from'react';var useStyles=makeStyles(function(theme){return{appBar:{position:'fixed'},title:{marginLeft:theme.spacing(2),flex:1}};});var Transition=React.forwardRef(function Transition(props,ref){return/*#__PURE__*/React.createElement(Slide,Object.assign({direction:\"up\",ref:ref},props));});export default function FullScreenDialog(props){var classes=useStyles();var _React$useState=React.useState(false),_React$useState2=_slicedToArray(_React$useState,2),open=_React$useState2[0],setOpen=_React$useState2[1];var videoRef=useRef(null);var canvasRef=useRef(null);var _useState=useState(false),_useState2=_slicedToArray(_useState,2),isCameraOn=_useState2[0],setIsCameraOn=_useState2[1];var _useState3=useState(null),_useState4=_slicedToArray(_useState3,2),photo=_useState4[0],setPhoto=_useState4[1];var handleClickOpen=function handleClickOpen(){setOpen(true);toggleCamera();};var handleClose=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var stream;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:setOpen(false);setPhoto(null);stream=videoRef.current.srcObject;if(stream){stream.getTracks().forEach(function(track){return track.stop();});videoRef.current.srcObject=null;}setIsCameraOn(false);case 5:case\"end\":return _context.stop();}}},_callee);}));return function handleClose(){return _ref.apply(this,arguments);};}();var toggleCamera=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var stream,_stream;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:if(!isCameraOn){_context2.next=6;break;}// 停止相机\nstream=videoRef.current.srcObject;if(stream){stream.getTracks().forEach(function(track){return track.stop();});videoRef.current.srcObject=null;}setIsCameraOn(false);_context2.next=17;break;case 6:_context2.prev=6;_context2.next=9;return navigator.mediaDevices.getUserMedia({video:true});case 9:_stream=_context2.sent;videoRef.current.srcObject=_stream;setIsCameraOn(true);_context2.next=17;break;case 14:_context2.prev=14;_context2.t0=_context2[\"catch\"](6);console.error(\"Error accessing the camera:\",_context2.t0);case 17:case\"end\":return _context2.stop();}}},_callee2,null,[[6,14]]);}));return function toggleCamera(){return _ref2.apply(this,arguments);};}();var takePhoto=function takePhoto(){var canvas=canvasRef.current;var video=videoRef.current;if(video&&canvas){var context=canvas.getContext('2d');canvas.width=video.videoWidth;canvas.height=video.videoHeight;context.drawImage(video,0,0,canvas.width,canvas.height);// 获取图像的 base64 编码\nvar base64Image=canvas.toDataURL('image/png');setPhoto(base64Image);console.log(base64Image);// 或者根据需要处理\nsetIsCameraOn(false);toggleCamera();}};return/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(Typography,{onClick:handleClickOpen,color:\"secondary\",variant:\"body2\"},\"\\u62CD\\u7167\"),/*#__PURE__*/React.createElement(Dialog,{fullScreen:true,open:open,onClose:handleClose,TransitionComponent:Transition},/*#__PURE__*/React.createElement(AppBar,{className:classes.appBar},/*#__PURE__*/React.createElement(Toolbar,null,/*#__PURE__*/React.createElement(IconButton,{edge:\"start\",color:\"inherit\",onClick:handleClose,\"aria-label\":\"close\"},/*#__PURE__*/React.createElement(CloseIcon,null)))),/*#__PURE__*/React.createElement(List,{style:{backgroundColor:\"black\",padding:0,margin:0,height:\"100%\"}},/*#__PURE__*/React.createElement(\"div\",{style:{display:'flex',flexDirection:'column',alignItems:'center',justifyContent:'center',height:\"100%\"}},/*#__PURE__*/React.createElement(\"div\",{style:{width:'100%',height:'100%',position:'relative',top:0,left:0}},/*#__PURE__*/React.createElement(\"video\",{ref:videoRef,playsInline:true,autoPlay:true,style:{display:isCameraOn?'block':'none',width:'100%',height:'100%',zIndex:1}}),/*#__PURE__*/React.createElement(\"img\",{src:photo,alt:\"\",style:{maxWidth:'100%',height:'auto',display:photo?'block':'none',position:'absolute',top:\"56px\"}}),/*#__PURE__*/React.createElement(\"canvas\",{ref:canvasRef,style:{display:'none'}}),isCameraOn&&(props===null||props===void 0?void 0:props.showCameraFrame)&&/*#__PURE__*/React.createElement(\"div\",{style:{position:\"absolute\",width:\"30%\",height:\"4%\",border:\"1px dashed red\",top:\"40%\",left:\"5%\",borderRadius:\"10%\",pointerEvents:'none',zIndex:100}}),isCameraOn&&(props===null||props===void 0?void 0:props.showCameraFrame)&&/*#__PURE__*/React.createElement(\"div\",{style:{position:\"absolute\",width:\"30%\",height:\"70%\",border:\"1px dashed red\",top:\"86px\",right:\"15%\",borderRadius:\"5%\",pointerEvents:'none',zIndex:'1000 !important'}}),/*#__PURE__*/React.createElement(Box,{style:{position:\"fixed\",bottom:0,left:0,right:0,fontWeight:600,display:\"flex\",justifyContent:\"space-around\",zIndex:100}},/*#__PURE__*/React.createElement(Button,{onClick:function onClick(){toggleCamera();setIsCameraOn(true);setPhoto(null);},disabled:isCameraOn,style:{color:'white'}},\"\\u91CD\\u62CD\"),/*#__PURE__*/React.createElement(Box,{style:{border:\" 5px solid white\",borderRadius:\"50%\",padding:\"2px\"}},/*#__PURE__*/React.createElement(Button,{onClick:function onClick(){return takePhoto();},disabled:!isCameraOn,style:{color:'black',width:\"60px\",height:\"60px\",backgroundColor:\"white\",borderRadius:\" 50%\"}},\"\\u62CD\\u7167\")),/*#__PURE__*/React.createElement(Button,{onClick:function onClick(){props.onChange(photo);setOpen(false);setPhoto(null);},disabled:isCameraOn,style:{color:'white'}},\"\\u4F7F\\u7528\\u7167\\u7247\")))))));}","map":{"version":3,"sources":["C:/project/SCF-NI_PM_App/SCF.InstallationQuality/react-client/src/components/Camera/index.js"],"names":["AppBar","Dialog","IconButton","Button","Box","List","Slide","makeStyles","Toolbar","Typography","CloseIcon","React","useRef","useState","useStyles","theme","appBar","position","title","marginLeft","spacing","flex","Transition","forwardRef","props","ref","FullScreenDialog","classes","open","setOpen","videoRef","canvasRef","isCameraOn","setIsCameraOn","photo","setPhoto","handleClickOpen","toggleCamera","handleClose","stream","current","srcObject","getTracks","forEach","track","stop","navigator","mediaDevices","getUserMedia","video","console","error","takePhoto","canvas","context","getContext","width","videoWidth","height","videoHeight","drawImage","base64Image","toDataURL","log","backgroundColor","padding","margin","display","flexDirection","alignItems","justifyContent","top","left","zIndex","maxWidth","showCameraFrame","border","borderRadius","pointerEvents","right","bottom","fontWeight","color","onChange"],"mappings":"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","sourcesContent":["import AppBar from '@material-ui/core/AppBar';\r\nimport Dialog from '@material-ui/core/Dialog';\r\nimport { IconButton,Button, Box } from '@material-ui/core';\r\nimport List from '@material-ui/core/List';\r\nimport Slide from '@material-ui/core/Slide';\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nimport Toolbar from '@material-ui/core/Toolbar';\r\nimport Typography from '@material-ui/core/Typography';\r\nimport CloseIcon from '@material-ui/icons/Close';\r\nimport React, { useRef, useState } from 'react';\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  appBar: {\r\n    position: 'fixed',\r\n  },\r\n  title: {\r\n    marginLeft: theme.spacing(2),\r\n    flex: 1,\r\n  },\r\n}));\r\n\r\nconst Transition = React.forwardRef(function Transition(props, ref) {\r\n  return <Slide direction=\"up\" ref={ref} {...props} />;\r\n});\r\n\r\nexport default function FullScreenDialog(props) {\r\n    const classes = useStyles();\r\n    const [open, setOpen] = React.useState(false);\r\n    const videoRef = useRef(null);\r\n    const canvasRef = useRef(null);\r\n    const [isCameraOn, setIsCameraOn] = useState(false);\r\n    const [photo, setPhoto] = useState(null);\r\n\r\n\r\n    const handleClickOpen = () => {\r\n        setOpen(true);\r\n        toggleCamera();\r\n    };\r\n\r\n    const handleClose = async () => {\r\n        setOpen(false);\r\n        setPhoto(null);\r\n        const stream = videoRef.current.srcObject;\r\n        if (stream) {\r\n            stream.getTracks().forEach(track => track.stop());\r\n            videoRef.current.srcObject = null;\r\n        }\r\n        setIsCameraOn(false); \r\n    };\r\n\r\n        const toggleCamera = async () => {\r\n            if (isCameraOn) {\r\n                // 停止相机\r\n                const stream = videoRef.current.srcObject;\r\n                if (stream) {\r\n                    stream.getTracks().forEach(track => track.stop());\r\n                    videoRef.current.srcObject = null;\r\n                }\r\n                setIsCameraOn(false);\r\n            } else {\r\n                // 开启相机\r\n                try {\r\n                    // const stream = await navigator.mediaDevices.getUserMedia({\r\n                    //     video: { facingMode: { exact: 'environment' } }\r\n                    // });\r\n                    const stream = await navigator.mediaDevices.getUserMedia({\r\n                        video: true\r\n                    });\r\n                    videoRef.current.srcObject = stream;\r\n                    setIsCameraOn(true);\r\n                } catch (error) {\r\n                    console.error(\"Error accessing the camera:\", error);\r\n                }\r\n            }\r\n        };\r\n\r\n    const takePhoto = () => {\r\n            const canvas = canvasRef.current;\r\n            const video = videoRef.current;\r\n\r\n            if (video && canvas) {\r\n                const context = canvas.getContext('2d');\r\n                canvas.width = video.videoWidth;\r\n                canvas.height = video.videoHeight;\r\n                context.drawImage(video, 0, 0, canvas.width, canvas.height);\r\n\r\n                // 获取图像的 base64 编码\r\n                const base64Image = canvas.toDataURL('image/png');\r\n                setPhoto(base64Image);\r\n                console.log(base64Image); // 或者根据需要处理\r\n                setIsCameraOn(false)\r\n                toggleCamera()\r\n            }\r\n        };\r\n\r\n\r\n  return (\r\n    <div>\r\n    <Typography onClick={handleClickOpen} color=\"secondary\" variant=\"body2\">\r\n        拍照\r\n    </Typography>\r\n      <Dialog fullScreen open={open} onClose={handleClose} TransitionComponent={Transition}>\r\n        <AppBar className={classes.appBar}>\r\n          <Toolbar>\r\n            <IconButton edge=\"start\" color=\"inherit\" onClick={handleClose} aria-label=\"close\">\r\n              <CloseIcon />\r\n            </IconButton>\r\n          </Toolbar>\r\n        </AppBar>\r\n        <List style={{backgroundColor:\"black\",padding:0,margin:0,height:\"100%\"}}>\r\n                  <div style={{ display: 'flex', flexDirection: 'column', alignItems: 'center', justifyContent: 'center',height:\"100%\" }}>\r\n                      <div style={{ width: '100%', height: '100%', position: 'relative', top: 0, left: 0 }}>\r\n                          <video\r\n                              ref={videoRef}\r\n                              playsInline \r\n                              autoPlay\r\n                              style={{ display: isCameraOn ? 'block' : 'none', width: '100%', height: '100%',zIndex:1 }}\r\n                          />\r\n                          <img src={photo} alt=\"\" style={{\r\n                              maxWidth: '100%', height: 'auto', display: photo ? 'block' : 'none', position: 'absolute',\r\n                              top:\"56px\"}} />\r\n                          <canvas ref={canvasRef} style={{ display: 'none' }} />\r\n\r\n                          {isCameraOn && props?.showCameraFrame && (\r\n                              <div style={{\r\n                                  position: \"absolute\",\r\n                                  width: \"30%\",\r\n                                  height: \"4%\",\r\n                                  border: \"1px dashed red\",\r\n                                  top: \"40%\",\r\n                                  left: \"5%\",\r\n                                  borderRadius: \"10%\",\r\n                                  pointerEvents: 'none',\r\n                                  zIndex: 100\r\n                              }}></div>\r\n                          )}\r\n                          {isCameraOn && props?.showCameraFrame && (\r\n                              <div style={{\r\n                                  position: \"absolute\",\r\n                                  width: \"30%\",\r\n                                  height: \"70%\",\r\n                                  border: \"1px dashed red\",\r\n                                  top: \"86px\",\r\n                                  right: \"15%\",\r\n                                  borderRadius: \"5%\",\r\n                                  pointerEvents: 'none',\r\n                                  zIndex: '1000 !important' \r\n                              }}></div>\r\n                          )}\r\n                          <Box style={{\r\n                              position: \"fixed\",\r\n                              bottom: 0,\r\n                              left: 0,\r\n                              right: 0,\r\n                              fontWeight: 600,\r\n                              display: \"flex\",\r\n                              justifyContent: \"space-around\",\r\n                              zIndex:100\r\n                              \r\n                          }}>\r\n                              <Button\r\n                                  onClick={() => {\r\n                                      toggleCamera();\r\n                                      setIsCameraOn(true)\r\n                                      setPhoto(null)\r\n                                  }}\r\n                                  disabled={isCameraOn}\r\n                                  style={{\r\n                                      color: 'white',\r\n                                  }}>\r\n                                  重拍\r\n                              </Button>\r\n                              <Box style={{\r\n                                  border: \" 5px solid white\",\r\n                                  borderRadius: \"50%\",\r\n                                  padding: \"2px\"\r\n                              }}>\r\n                                  <Button\r\n                                      onClick={() => takePhoto()}\r\n                                      disabled={!isCameraOn}\r\n                                      style={{\r\n                                          color: 'black',\r\n                                          width: \"60px\",\r\n                                          height: \"60px\",\r\n                                          backgroundColor: \"white\",\r\n                                          borderRadius: \" 50%\",\r\n\r\n                                      }}>\r\n                                      拍照\r\n                                  </Button>\r\n                              </Box>\r\n\r\n                              <Button\r\n                                  onClick={() => {\r\n                                      props.onChange(photo);\r\n                                      setOpen(false);\r\n                                      setPhoto(null);\r\n                                  }}\r\n                                  disabled={isCameraOn}\r\n                                  style={{\r\n                                      color: 'white',\r\n                                  }}>\r\n                                  使用照片\r\n                              </Button>\r\n                          </Box>\r\n\r\n                      </div>\r\n                  </div>\r\n              \r\n        </List>\r\n      </Dialog>\r\n    </div>\r\n  );\r\n}\r\n\r\n\r\n"]},"metadata":{},"sourceType":"module"}