{"ast":null,"code":"import _defineProperty from\"C:\\\\project\\\\SCF-NI_PM_App\\\\SCF.InstallationQuality\\\\react-client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/defineProperty\";/**\r\n * Copyright (C) 2016 All rights reserved.\r\n *\r\n * Redistribution and use in source and binary forms, with or without modification,\r\n * are not permitted unless explicitly granted in writing.\r\n *\r\n * Usage and modification rights granted to Schindler AG, Ebikon.\r\n */import{appendChild,appendQuestionBlock,hasChildNode,getChildNode,getChildNodes,getRequiredAttr,getAttrWithDefault,readQuestionBlock,getValueAttr}from\"./utils/xml\";import{FREE_TEXT_VALUE}from\"./utils/options\";import uuid from\"node-uuid\";import{DEFAULT_LANG}from\"./constants/global\";export default function genericMCIOFactory(fieldType,xmlElementName){return{serialize:function serialize(doc,findField,parentNode,field){var _field$settings=field.settings,options=_field$settings.options,includeOther=_field$settings.includeOther;var questionBlock=appendQuestionBlock(doc,findField,parentNode,\"string\",field);var radioGroupOrDropdown=appendChild(doc,questionBlock,xmlElementName);options.forEach(function(_ref){var id=_ref.id,nameI18n=_ref.nameI18n,value=_ref.value;var optionNode=appendChild(doc,radioGroupOrDropdown,\"option\",null,{value:value,selected:value===field.settings.value});Object.keys(nameI18n).forEach(function(lang){if(typeof nameI18n[lang]!==\"undefined\"){appendChild(doc,optionNode,\"text\",nameI18n[lang],{lang:lang});}});});if(includeOther){var optionNode=appendChild(doc,radioGroupOrDropdown,\"option\",null,{value:FREE_TEXT_VALUE,selected:false});appendChild(doc,optionNode,\"textfield\");}},canDeserialize:function canDeserialize(node){return node.nodeName===\"question_block\"&&hasChildNode(node,xmlElementName);},deserialize:function deserialize(node){var field=readQuestionBlock(node,fieldType,\"string\");// eslint-disable-line prefer-const\nfield.settings.required=getRequiredAttr(node,\"required\")===\"true\";field.settings.value=getValueAttr(node,\"value\");var radioOrDropdownNode=getChildNode(node,xmlElementName);var optionNodes=getChildNodes(radioOrDropdownNode,\"option\");var options=[];// eslint-disable-line prefer-const\nfield.settings.options=options;field.settings.selectedId=null;field.settings.includeOther=false;optionNodes.forEach(function(optionNode){if(hasChildNode(optionNode,\"textfield\")){var otherTextFieldNode=getChildNode(optionNode,\"textfield\");field.settings.includeOther=true;field.settings.otherOptionText=otherTextFieldNode.textContent;field.settings.otherOptionSelected=getAttrWithDefault(optionNode,\"selected\",\"false\")===\"true\";}else{var optionId=uuid.v4();var nameI18n=getChildNodes(optionNode,\"text\").reduce(function(acc,textNode){return Object.assign({},acc,_defineProperty({},getAttrWithDefault(textNode,\"lang\",DEFAULT_LANG),textNode.textContent));},{});options.push({id:optionId,nameI18n:nameI18n,value:getRequiredAttr(optionNode,\"value\")});if(getAttrWithDefault(optionNode,\"selected\",\"false\")===\"true\"){field.settings.selectedId=optionId;}}});if(field.settings.otherOptionSelected){field.settings.selectedId=null;}return field;}};}","map":{"version":3,"sources":["C:/project/SCF-NI_PM_App/SCF.InstallationQuality/react-client/src/js/sfdl/genericMCIOFactory.js"],"names":["appendChild","appendQuestionBlock","hasChildNode","getChildNode","getChildNodes","getRequiredAttr","getAttrWithDefault","readQuestionBlock","getValueAttr","FREE_TEXT_VALUE","uuid","DEFAULT_LANG","genericMCIOFactory","fieldType","xmlElementName","serialize","doc","findField","parentNode","field","settings","options","includeOther","questionBlock","radioGroupOrDropdown","forEach","id","nameI18n","value","optionNode","selected","Object","keys","lang","canDeserialize","node","nodeName","deserialize","required","radioOrDropdownNode","optionNodes","selectedId","otherTextFieldNode","otherOptionText","textContent","otherOptionSelected","optionId","v4","reduce","acc","textNode","assign","push"],"mappings":"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","sourcesContent":["/**\r\n * Copyright (C) 2016 All rights reserved.\r\n *\r\n * Redistribution and use in source and binary forms, with or without modification,\r\n * are not permitted unless explicitly granted in writing.\r\n *\r\n * Usage and modification rights granted to Schindler AG, Ebikon.\r\n */\r\n\r\nimport {\r\n  appendChild,\r\n  appendQuestionBlock,\r\n  hasChildNode,\r\n  getChildNode,\r\n  getChildNodes,\r\n  getRequiredAttr,\r\n  getAttrWithDefault,\r\n  readQuestionBlock,\r\n  getValueAttr,\r\n} from \"./utils/xml\";\r\nimport { FREE_TEXT_VALUE } from \"./utils/options\";\r\nimport uuid from \"node-uuid\";\r\nimport { DEFAULT_LANG } from \"./constants/global\";\r\n\r\nexport default function genericMCIOFactory(fieldType, xmlElementName) {\r\n  return {\r\n    serialize(doc, findField, parentNode, field) {\r\n      const { options, includeOther } = field.settings;\r\n\r\n      const questionBlock = appendQuestionBlock(\r\n        doc,\r\n        findField,\r\n        parentNode,\r\n        \"string\",\r\n        field\r\n      );\r\n\r\n      const radioGroupOrDropdown = appendChild(\r\n        doc,\r\n        questionBlock,\r\n        xmlElementName\r\n      );\r\n\r\n      options.forEach(({ id, nameI18n, value }) => {\r\n        const optionNode = appendChild(\r\n          doc,\r\n          radioGroupOrDropdown,\r\n          \"option\",\r\n          null,\r\n          {\r\n            value: value,\r\n            selected: value === field.settings.value,\r\n          }\r\n        );\r\n\r\n        Object.keys(nameI18n).forEach((lang) => {\r\n          if (typeof nameI18n[lang] !== \"undefined\") {\r\n            appendChild(doc, optionNode, \"text\", nameI18n[lang], { lang });\r\n          }\r\n        });\r\n      });\r\n\r\n      if (includeOther) {\r\n        const optionNode = appendChild(\r\n          doc,\r\n          radioGroupOrDropdown,\r\n          \"option\",\r\n          null,\r\n          {\r\n            value: FREE_TEXT_VALUE,\r\n            selected: false,\r\n          }\r\n        );\r\n        appendChild(doc, optionNode, \"textfield\");\r\n      }\r\n    },\r\n\r\n    canDeserialize(node) {\r\n      return (\r\n        node.nodeName === \"question_block\" && hasChildNode(node, xmlElementName)\r\n      );\r\n    },\r\n\r\n    deserialize(node) {\r\n      let field = readQuestionBlock(node, fieldType, \"string\"); // eslint-disable-line prefer-const\r\n      field.settings.required = getRequiredAttr(node, \"required\") === \"true\";\r\n\r\n      field.settings.value = getValueAttr(node, \"value\");\r\n\r\n      const radioOrDropdownNode = getChildNode(node, xmlElementName);\r\n      const optionNodes = getChildNodes(radioOrDropdownNode, \"option\");\r\n\r\n      let options = []; // eslint-disable-line prefer-const\r\n      field.settings.options = options;\r\n\r\n      field.settings.selectedId = null;\r\n      field.settings.includeOther = false;\r\n\r\n      optionNodes.forEach((optionNode) => {\r\n        if (hasChildNode(optionNode, \"textfield\")) {\r\n          const otherTextFieldNode = getChildNode(optionNode, \"textfield\");\r\n          field.settings.includeOther = true;\r\n          field.settings.otherOptionText = otherTextFieldNode.textContent;\r\n          field.settings.otherOptionSelected =\r\n            getAttrWithDefault(optionNode, \"selected\", \"false\") === \"true\";\r\n        } else {\r\n          const optionId = uuid.v4();\r\n\r\n          const nameI18n = getChildNodes(optionNode, \"text\").reduce(\r\n            (acc, textNode) => {\r\n              return Object.assign({}, acc, {\r\n                [getAttrWithDefault(\r\n                  textNode,\r\n                  \"lang\",\r\n                  DEFAULT_LANG\r\n                )]: textNode.textContent,\r\n              });\r\n            },\r\n            {}\r\n          );\r\n\r\n          options.push({\r\n            id: optionId,\r\n            nameI18n: nameI18n,\r\n            value: getRequiredAttr(optionNode, \"value\"),\r\n          });\r\n\r\n          if (getAttrWithDefault(optionNode, \"selected\", \"false\") === \"true\") {\r\n            field.settings.selectedId = optionId;\r\n          }\r\n        }\r\n      });\r\n\r\n      if (field.settings.otherOptionSelected) {\r\n        field.settings.selectedId = null;\r\n      }\r\n\r\n      return field;\r\n    },\r\n  };\r\n}\r\n"]},"metadata":{},"sourceType":"module"}