{"ast":null,"code":"import _objectSpread from\"C:\\\\project\\\\SCF-NI_PM_App\\\\SCF.InstallationQuality\\\\react-client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"C:\\\\project\\\\SCF-NI_PM_App\\\\SCF.InstallationQuality\\\\react-client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";import{Box,Button,makeStyles,Typography,TextField}from\"@material-ui/core\";import Divider from\"@material-ui/core/Divider\";import List from\"@material-ui/core/List\";import ListItem from\"@material-ui/core/ListItem\";import ListItemText from\"@material-ui/core/ListItemText\";import Loading from\"assets/img/loading.gif\";import Refresh from\"assets/img/refresh.png\";import{LocalizeContext}from\"i18n\";import{recordRefreshTime,updateOrdersData as _updateOrdersData}from\"js/util\";import PrimaryLayout from\"layouts/PrimaryLayout\";import React,{useState}from\"react\";import{connect}from\"react-redux\";import ConfirmModal from\"components/ConfirmModal\";import AddIcon from'@material-ui/icons/Add';import{showUploadButton}from\"js/util\";var useStyles=makeStyles(function(_ref){var spacing=_ref.spacing;return{root:{width:\"100%\",// color: \"#7e7a7a\",\nfontWeight:\"500\",marginBottom:spacing(2)},box:{width:\"90%\",margin:spacing(2,\"auto\",0),marginTop:spacing(2)},list:{padding:0,backgroundColor:\"#fff\"},secondList:{padding:0,backgroundColor:\"#fff\",paddingLeft:spacing(2)},title:{padding:\"0px 35px 0 16px\",marginTop:spacing(2),backgroundColor:\"#fff\",color:\"#666\",display:\"flex\",alignItems:\"center\",justifyContent:\"space-between\"},listItem:{backgroundColor:\"#fff\",paddingBottom:spacing(1),position:\"relative\"},listItemText:{padding:0},loadItem:{fontSize:\"12px\"},loading:{width:spacing(2),position:\"absolute\",right:spacing(1)},refreshTime:{marginLeft:spacing(2)},fail:{color:\"red\"}};});var SynchronizePage=function SynchronizePage(_ref2){var refresh=_ref2.refresh,refreshTime=_ref2.refreshTime,projects=_ref2.projects,_ref2$requestStatus=_ref2.requestStatus,documentStatus=_ref2$requestStatus.documentStatus,masterDataStatus=_ref2$requestStatus.masterDataStatus,ordersDataStatus=_ref2$requestStatus.ordersDataStatus,templateListStatus=_ref2$requestStatus.templateListStatus,taskListStatus=_ref2$requestStatus.taskListStatus,auth=_ref2.auth,updateOrdersData=_ref2.updateOrdersData;var i18n=React.useContext(LocalizeContext);var classes=useStyles();var _useState=useState(false),_useState2=_slicedToArray(_useState,2),open=_useState2[0],setOpen=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),SODialog=_useState4[0],setSODialog=_useState4[1];var _useState5=useState(null),_useState6=_slicedToArray(_useState5,2),userInfo=_useState6[0],setUserInfo=_useState6[1];var _useState7=useState({pNumber:auth.personalNumber}),_useState8=_slicedToArray(_useState7,2),SONO=_useState8[0],setSONO=_useState8[1];var _useState9=useState({}),_useState10=_slicedToArray(_useState9,2),moduleName=_useState10[0],setModuleName=_useState10[1];var status=[documentStatus,masterDataStatus,ordersDataStatus,templateListStatus,taskListStatus];var data=[{label:i18n.ISNTAPP_SYNCHRONIZE_ORDER,value:\"orders\",list:[{label:i18n.ISNTAPP_SYNCHRONIZE_MASTER_DATA,date:refreshTime.masterDataRefreshTime,loading:masterDataStatus},{label:i18n.ISNTAPP_SYNCHRONIZE_ORDER_DATA,date:refreshTime.orderDataRefreshTime,loading:ordersDataStatus}]},{label:i18n.ISNTAPP_SYNCHRONIZE_DOCUMENTS,value:\"documents\",list:[{label:i18n.ISNTAPP_SYNCHRONIZE_DOCUMENTS,date:refreshTime.templateListDataRefreshTime,loading:templateListStatus},{label:i18n.ISNTAPP_SYNCHRONIZE_DOCUMENT_LIST,date:refreshTime.documentListDataRefreshTime,loading:documentStatus}]},{label:i18n.ISNTAPP_SYNCHRONIZE_TASK,value:\"task\",list:[{label:i18n.ISNTAPP_SYNCHRONIZE_TASK_LIST,date:refreshTime.taskListDataRefreshTime,loading:taskListStatus}]}];var synchroData=function synchroData(name,projects){if((auth===null||auth===void 0?void 0:auth.roles[0])===\"SL\"){setOpen(true);}else{refresh(name,projects,userInfo);}};var confirmRefresh=function confirmRefresh(){if(!(userInfo===null||userInfo===void 0?void 0:userInfo.pNumber)){return false;}window.localStorage.setItem(\"peInfo\",JSON.stringify({pNumber:userInfo===null||userInfo===void 0?void 0:userInfo.pNumber}));refresh(moduleName.name,moduleName.projects,userInfo);setOpen(false);};var confirmSO=function confirmSO(){setSODialog(false);updateOrdersData(SONO);setSONO(null);};return/*#__PURE__*/React.createElement(PrimaryLayout,{name:\"synchronize\",title:i18n.ISNTAPP_SYNC_PAGE,isShowRefreshButton:false,isFetchAll:false},/*#__PURE__*/React.createElement(Box,{className:classes.root},/*#__PURE__*/React.createElement(Box,{className:classes.title},/*#__PURE__*/React.createElement(Typography,{variant:\"h6\"},i18n.ISNTAPP_SYNCHRONIZE_PAGE),/*#__PURE__*/React.createElement(Box,null,showUploadButton()&&/*#__PURE__*/React.createElement(Button,{onClick:function onClick(){return setSODialog(true);}},/*#__PURE__*/React.createElement(AddIcon,{color:\"error\"})),/*#__PURE__*/React.createElement(Button,{onClick:function onClick(){synchroData(\"all\",projects);setModuleName({name:\"all\",projects:projects});},disabled:status.indexOf(\"loading\")>-1?true:false},/*#__PURE__*/React.createElement(\"img\",{src:Refresh,width:\"32\",alt:\"\"})))),data.map(function(item,index){return/*#__PURE__*/React.createElement(Box,{key:index,className:classes.box},/*#__PURE__*/React.createElement(List,{className:classes.list},/*#__PURE__*/React.createElement(ListItem,null,/*#__PURE__*/React.createElement(ListItemText,{primary:/*#__PURE__*/React.createElement(Typography,{variant:\"subtitle2\"},item.label)}),/*#__PURE__*/React.createElement(Button,{onClick:function onClick(){synchroData(item.value,projects);setModuleName({name:item.value,projects:projects});},disabled:status.indexOf(\"loading\")>-1?true:false},/*#__PURE__*/React.createElement(\"img\",{src:Refresh,width:\"32\",alt:\"\"})))),/*#__PURE__*/React.createElement(Divider,null),/*#__PURE__*/React.createElement(List,{className:classes.secondList},item.list.map(function(item,index){return/*#__PURE__*/React.createElement(Box,{key:index},/*#__PURE__*/React.createElement(ListItem,{className:classes.listItem},/*#__PURE__*/React.createElement(ListItemText,{primary:/*#__PURE__*/React.createElement(Typography,{variant:\"body2\"},item.label)}),/*#__PURE__*/React.createElement(ListItemText,{primary:/*#__PURE__*/React.createElement(Typography,{className:classes.loadItem,color:\"textSecondary\"},/*#__PURE__*/React.createElement(\"span\",{className:item.loading===\"failToLoad\"?classes.fail:\"\"},item.loading===\"loading\"?i18n.ISNTAPP_LOADING:item.loading===\"loaded\"?i18n.ISNTAPP_LOADED:i18n.ISNTAPP_FEIL_TO_LOAD),/*#__PURE__*/React.createElement(\"span\",{className:classes.refreshTime},item.loading!==\"loading\"&&item.date))}),item.loading===\"loading\"&&/*#__PURE__*/React.createElement(\"img\",{src:Loading,className:classes.loading,alt:\"\"})),index===0&&item.label!==\"Synchronize Task list\"&&/*#__PURE__*/React.createElement(Divider,null));})));})),/*#__PURE__*/React.createElement(ConfirmModal,{open:open,onClose:function onClose(){return setOpen(false);},handleClick:function handleClick(){return confirmRefresh();},children:/*#__PURE__*/React.createElement(TextField,{label:i18n.ISNTAPP_INPUT_PE_JOB_NO,style:{margin:8},fullWidth:true,margin:\"normal\",onChange:function onChange(event){return setUserInfo({pNumber:event.target.value});}})}),/*#__PURE__*/React.createElement(ConfirmModal,{open:SODialog,onClose:function onClose(){return setSODialog(false);},handleClick:function handleClick(){return(SONO===null||SONO===void 0?void 0:SONO.orderNo)&&confirmSO();},children:/*#__PURE__*/React.createElement(TextField,{label:i18n.ISNTAPP_INPUT_ORDER_NO,style:{margin:8},value:(SONO===null||SONO===void 0?void 0:SONO.orderNo)||\"\",fullWidth:true,margin:\"normal\",onChange:function onChange(event){return setSONO(_objectSpread(_objectSpread({},SONO),{},{orderNo:event.target.value}));}})}));};export default connect(function(_ref3){var projects=_ref3.projects,refreshTime=_ref3.refreshTime,requestStatus=_ref3.requestStatus,auth=_ref3.auth;return{projects:projects,refreshTime:refreshTime,requestStatus:requestStatus,auth:auth};},function(dispatch){return{refresh:function refresh(name,projects,userInfo){recordRefreshTime(dispatch,name,projects,userInfo);},updateOrdersData:function updateOrdersData(soNo){_updateOrdersData(soNo,dispatch);}};})(SynchronizePage);","map":{"version":3,"sources":["C:/project/SCF-NI_PM_App/SCF.InstallationQuality/react-client/src/pages/SynchronizePage/index.js"],"names":["Box","Button","makeStyles","Typography","TextField","Divider","List","ListItem","ListItemText","Loading","Refresh","LocalizeContext","recordRefreshTime","updateOrdersData","PrimaryLayout","React","useState","connect","ConfirmModal","AddIcon","showUploadButton","useStyles","spacing","root","width","fontWeight","marginBottom","box","margin","marginTop","list","padding","backgroundColor","secondList","paddingLeft","title","color","display","alignItems","justifyContent","listItem","paddingBottom","position","listItemText","loadItem","fontSize","loading","right","refreshTime","marginLeft","fail","SynchronizePage","refresh","projects","requestStatus","documentStatus","masterDataStatus","ordersDataStatus","templateListStatus","taskListStatus","auth","i18n","useContext","classes","open","setOpen","SODialog","setSODialog","userInfo","setUserInfo","pNumber","personalNumber","SONO","setSONO","moduleName","setModuleName","status","data","label","ISNTAPP_SYNCHRONIZE_ORDER","value","ISNTAPP_SYNCHRONIZE_MASTER_DATA","date","masterDataRefreshTime","ISNTAPP_SYNCHRONIZE_ORDER_DATA","orderDataRefreshTime","ISNTAPP_SYNCHRONIZE_DOCUMENTS","templateListDataRefreshTime","ISNTAPP_SYNCHRONIZE_DOCUMENT_LIST","documentListDataRefreshTime","ISNTAPP_SYNCHRONIZE_TASK","ISNTAPP_SYNCHRONIZE_TASK_LIST","taskListDataRefreshTime","synchroData","name","roles","confirmRefresh","window","localStorage","setItem","JSON","stringify","confirmSO","ISNTAPP_SYNC_PAGE","ISNTAPP_SYNCHRONIZE_PAGE","indexOf","map","item","index","ISNTAPP_LOADING","ISNTAPP_LOADED","ISNTAPP_FEIL_TO_LOAD","ISNTAPP_INPUT_PE_JOB_NO","event","target","orderNo","ISNTAPP_INPUT_ORDER_NO","dispatch","soNo"],"mappings":"yXAAA,OAASA,GAAT,CAAcC,MAAd,CAAsBC,UAAtB,CAAkCC,UAAlC,CAA8CC,SAA9C,KAA+D,mBAA/D,CACA,MAAOC,CAAAA,OAAP,KAAoB,2BAApB,CACA,MAAOC,CAAAA,IAAP,KAAiB,wBAAjB,CACA,MAAOC,CAAAA,QAAP,KAAqB,4BAArB,CACA,MAAOC,CAAAA,YAAP,KAAyB,gCAAzB,CACA,MAAOC,CAAAA,OAAP,KAAoB,wBAApB,CACA,MAAOC,CAAAA,OAAP,KAAoB,wBAApB,CACA,OAASC,eAAT,KAAgC,MAAhC,CACA,OAASC,iBAAT,CAA4BC,gBAAgB,GAAhBA,CAAAA,iBAA5B,KAAoD,SAApD,CACA,MAAOC,CAAAA,aAAP,KAA0B,uBAA1B,CACA,MAAOC,CAAAA,KAAP,EAAgBC,QAAhB,KAAgC,OAAhC,CACA,OAASC,OAAT,KAAwB,aAAxB,CACA,MAAOC,CAAAA,YAAP,KAAyB,yBAAzB,CACA,MAAOC,CAAAA,OAAP,KAAoB,wBAApB,CACA,OAASC,gBAAT,KAAiC,SAAjC,CACA,GAAMC,CAAAA,SAAS,CAAGnB,UAAU,CAAC,kBAAGoB,CAAAA,OAAH,MAAGA,OAAH,OAAkB,CAC7CC,IAAI,CAAE,CACJC,KAAK,CAAE,MADH,CAEJ;AACAC,UAAU,CAAE,KAHR,CAIJC,YAAY,CAAEJ,OAAO,CAAC,CAAD,CAJjB,CADuC,CAO7CK,GAAG,CAAE,CACHH,KAAK,CAAE,KADJ,CAEHI,MAAM,CAAEN,OAAO,CAAC,CAAD,CAAI,MAAJ,CAAY,CAAZ,CAFZ,CAGHO,SAAS,CAAEP,OAAO,CAAC,CAAD,CAHf,CAPwC,CAY7CQ,IAAI,CAAE,CACJC,OAAO,CAAE,CADL,CAEJC,eAAe,CAAE,MAFb,CAZuC,CAgB7CC,UAAU,CAAE,CACVF,OAAO,CAAE,CADC,CAEVC,eAAe,CAAE,MAFP,CAGVE,WAAW,CAAEZ,OAAO,CAAC,CAAD,CAHV,CAhBiC,CAqB7Ca,KAAK,CAAE,CACLJ,OAAO,CAAE,iBADJ,CAELF,SAAS,CAAEP,OAAO,CAAC,CAAD,CAFb,CAGLU,eAAe,CAAE,MAHZ,CAILI,KAAK,CAAE,MAJF,CAKLC,OAAO,CAAE,MALJ,CAMLC,UAAU,CAAE,QANP,CAOLC,cAAc,CAAE,eAPX,CArBsC,CA8B7CC,QAAQ,CAAE,CACRR,eAAe,CAAE,MADT,CAERS,aAAa,CAAEnB,OAAO,CAAC,CAAD,CAFd,CAGRoB,QAAQ,CAAE,UAHF,CA9BmC,CAmC7CC,YAAY,CAAE,CACZZ,OAAO,CAAE,CADG,CAnC+B,CAuC7Ca,QAAQ,CAAE,CACRC,QAAQ,CAAE,MADF,CAvCmC,CA0C7CC,OAAO,CAAE,CACPtB,KAAK,CAAEF,OAAO,CAAC,CAAD,CADP,CAEPoB,QAAQ,CAAE,UAFH,CAGPK,KAAK,CAAEzB,OAAO,CAAC,CAAD,CAHP,CA1CoC,CA+C7C0B,WAAW,CAAE,CACXC,UAAU,CAAE3B,OAAO,CAAC,CAAD,CADR,CA/CgC,CAkD7C4B,IAAI,CAAE,CACJd,KAAK,CAAE,KADH,CAlDuC,CAAlB,EAAD,CAA5B,CAuDA,GAAMe,CAAAA,eAAe,CAAG,QAAlBA,CAAAA,eAAkB,OAalB,IAZJC,CAAAA,OAYI,OAZJA,OAYI,CAXJJ,WAWI,OAXJA,WAWI,CAVJK,QAUI,OAVJA,QAUI,2BATJC,aASI,CARFC,cAQE,qBARFA,cAQE,CAPFC,gBAOE,qBAPFA,gBAOE,CANFC,gBAME,qBANFA,gBAME,CALFC,kBAKE,qBALFA,kBAKE,CAJFC,cAIE,qBAJFA,cAIE,CAFJC,IAEI,OAFJA,IAEI,CADJ/C,gBACI,OADJA,gBACI,CACJ,GAAMgD,CAAAA,IAAI,CAAG9C,KAAK,CAAC+C,UAAN,CAAiBnD,eAAjB,CAAb,CACA,GAAMoD,CAAAA,OAAO,CAAG1C,SAAS,EAAzB,CAFI,cAGoBL,QAAQ,CAAC,KAAD,CAH5B,wCAGGgD,IAHH,eAGSC,OAHT,8BAI4BjD,QAAQ,CAAC,KAAD,CAJpC,yCAIGkD,QAJH,eAIaC,WAJb,8BAK4BnD,QAAQ,CAAC,IAAD,CALpC,yCAKGoD,QALH,eAKaC,WALb,8BAMoBrD,QAAQ,CAAC,CAAEsD,OAAO,CAAEV,IAAI,CAACW,cAAhB,CAAD,CAN5B,yCAMGC,IANH,eAMSC,OANT,8BAOgCzD,QAAQ,CAAC,EAAD,CAPxC,0CAOG0D,UAPH,gBAOeC,aAPf,gBASJ,GAAMC,CAAAA,MAAM,CAAG,CACbrB,cADa,CAEbC,gBAFa,CAGbC,gBAHa,CAIbC,kBAJa,CAKbC,cALa,CAAf,CAOA,GAAMkB,CAAAA,IAAI,CAAG,CACX,CACEC,KAAK,CAAEjB,IAAI,CAACkB,yBADd,CAEEC,KAAK,CAAE,QAFT,CAGElD,IAAI,CAAE,CACJ,CACEgD,KAAK,CAAEjB,IAAI,CAACoB,+BADd,CAEEC,IAAI,CAAElC,WAAW,CAACmC,qBAFpB,CAGErC,OAAO,CAAEU,gBAHX,CADI,CAMJ,CACEsB,KAAK,CAAEjB,IAAI,CAACuB,8BADd,CAEEF,IAAI,CAAElC,WAAW,CAACqC,oBAFpB,CAGEvC,OAAO,CAAEW,gBAHX,CANI,CAHR,CADW,CAiBX,CACEqB,KAAK,CAAEjB,IAAI,CAACyB,6BADd,CAEEN,KAAK,CAAE,WAFT,CAGElD,IAAI,CAAE,CACJ,CACEgD,KAAK,CAAEjB,IAAI,CAACyB,6BADd,CAEEJ,IAAI,CAAElC,WAAW,CAACuC,2BAFpB,CAGEzC,OAAO,CAAEY,kBAHX,CADI,CAMJ,CACEoB,KAAK,CAAEjB,IAAI,CAAC2B,iCADd,CAEEN,IAAI,CAAElC,WAAW,CAACyC,2BAFpB,CAGE3C,OAAO,CAAES,cAHX,CANI,CAHR,CAjBW,CAiCX,CACEuB,KAAK,CAAEjB,IAAI,CAAC6B,wBADd,CAEEV,KAAK,CAAE,MAFT,CAGElD,IAAI,CAAE,CACJ,CACEgD,KAAK,CAAEjB,IAAI,CAAC8B,6BADd,CAEET,IAAI,CAAElC,WAAW,CAAC4C,uBAFpB,CAGE9C,OAAO,CAAEa,cAHX,CADI,CAHR,CAjCW,CAAb,CA8CA,GAAMkC,CAAAA,WAAW,CAAG,QAAdA,CAAAA,WAAc,CAACC,IAAD,CAAOzC,QAAP,CAAoB,CACtC,GAAI,CAAAO,IAAI,OAAJ,EAAAA,IAAI,SAAJ,QAAAA,IAAI,CAAEmC,KAAN,CAAY,CAAZ,KAAmB,IAAvB,CAA6B,CACzB9B,OAAO,CAAC,IAAD,CAAP,CACH,CAFD,IAEO,CACLb,OAAO,CAAC0C,IAAD,CAAOzC,QAAP,CAAiBe,QAAjB,CAAP,CACD,CACF,CAND,CAQA,GAAM4B,CAAAA,cAAc,CAAG,QAAjBA,CAAAA,cAAiB,EAAM,CAC3B,GAAI,EAAC5B,QAAD,SAACA,QAAD,iBAACA,QAAQ,CAAEE,OAAX,CAAJ,CAAwB,CACtB,MAAO,MAAP,CACD,CACD2B,MAAM,CAACC,YAAP,CAAoBC,OAApB,CAA4B,QAA5B,CAAsCC,IAAI,CAACC,SAAL,CAAe,CAAE/B,OAAO,CAAEF,QAAF,SAAEA,QAAF,iBAAEA,QAAQ,CAAEE,OAArB,CAAf,CAAtC,EACAlB,OAAO,CAACsB,UAAU,CAACoB,IAAZ,CAAkBpB,UAAU,CAACrB,QAA7B,CAAuCe,QAAvC,CAAP,CACAH,OAAO,CAAC,KAAD,CAAP,CACD,CAPD,CASA,GAAMqC,CAAAA,SAAS,CAAG,QAAZA,CAAAA,SAAY,EAAM,CACtBnC,WAAW,CAAC,KAAD,CAAX,CACAtD,gBAAgB,CAAC2D,IAAD,CAAhB,CACAC,OAAO,CAAC,IAAD,CAAP,CACD,CAJD,CAMA,mBACE,oBAAC,aAAD,EACE,IAAI,CAAC,aADP,CAEE,KAAK,CAAEZ,IAAI,CAAC0C,iBAFd,CAGE,mBAAmB,CAAE,KAHvB,CAIE,UAAU,CAAE,KAJd,eAME,oBAAC,GAAD,EAAK,SAAS,CAAExC,OAAO,CAACxC,IAAxB,eACE,oBAAC,GAAD,EAAK,SAAS,CAAEwC,OAAO,CAAC5B,KAAxB,eACE,oBAAC,UAAD,EAAY,OAAO,CAAC,IAApB,EAA0B0B,IAAI,CAAC2C,wBAA/B,CADF,cAEE,oBAAC,GAAD,MACGpF,gBAAgB,iBACf,oBAAC,MAAD,EACE,OAAO,CAAE,yBAAM+C,CAAAA,WAAW,CAAC,IAAD,CAAjB,EADX,eAGE,oBAAC,OAAD,EAAS,KAAK,CAAC,OAAf,EAHF,CAFJ,cAQE,oBAAC,MAAD,EACE,OAAO,CAAE,kBAAM,CACb0B,WAAW,CAAC,KAAD,CAAQxC,QAAR,CAAX,CACAsB,aAAa,CAAC,CAAEmB,IAAI,CAAE,KAAR,CAAezC,QAAQ,CAAEA,QAAzB,CAAD,CAAb,CACD,CAJH,CAKE,QAAQ,CAAEuB,MAAM,CAAC6B,OAAP,CAAe,SAAf,EAA4B,CAAC,CAA7B,CAAiC,IAAjC,CAAwC,KALpD,eAOE,2BAAK,GAAG,CAAE/F,OAAV,CAAmB,KAAK,CAAC,IAAzB,CAA8B,GAAG,CAAC,EAAlC,EAPF,CARF,CAFF,CADF,CAuBGmE,IAAI,CAAC6B,GAAL,CAAS,SAACC,IAAD,CAAOC,KAAP,CAAiB,CACzB,mBACE,oBAAC,GAAD,EAAK,GAAG,CAAEA,KAAV,CAAiB,SAAS,CAAE7C,OAAO,CAACpC,GAApC,eACE,oBAAC,IAAD,EAAM,SAAS,CAAEoC,OAAO,CAACjC,IAAzB,eACE,oBAAC,QAAD,mBACE,oBAAC,YAAD,EACE,OAAO,cACL,oBAAC,UAAD,EAAY,OAAO,CAAC,WAApB,EAAiC6E,IAAI,CAAC7B,KAAtC,CAFJ,EADF,cAME,oBAAC,MAAD,EACE,OAAO,CAAE,kBAAM,CACbe,WAAW,CAACc,IAAI,CAAC3B,KAAN,CAAa3B,QAAb,CAAX,CACAsB,aAAa,CAAC,CAAEmB,IAAI,CAAEa,IAAI,CAAC3B,KAAb,CAAoB3B,QAAQ,CAAEA,QAA9B,CAAD,CAAb,CACD,CAJH,CAKE,QAAQ,CAAEuB,MAAM,CAAC6B,OAAP,CAAe,SAAf,EAA4B,CAAC,CAA7B,CAAiC,IAAjC,CAAwC,KALpD,eAOE,2BAAK,GAAG,CAAE/F,OAAV,CAAmB,KAAK,CAAC,IAAzB,CAA8B,GAAG,CAAC,EAAlC,EAPF,CANF,CADF,CADF,cAmBE,oBAAC,OAAD,MAnBF,cAoBE,oBAAC,IAAD,EAAM,SAAS,CAAEqD,OAAO,CAAC9B,UAAzB,EACG0E,IAAI,CAAC7E,IAAL,CAAU4E,GAAV,CAAc,SAACC,IAAD,CAAOC,KAAP,CAAiB,CAC9B,mBACE,oBAAC,GAAD,EAAK,GAAG,CAAEA,KAAV,eACE,oBAAC,QAAD,EAAU,SAAS,CAAE7C,OAAO,CAACvB,QAA7B,eACE,oBAAC,YAAD,EACE,OAAO,cACL,oBAAC,UAAD,EAAY,OAAO,CAAC,OAApB,EACGmE,IAAI,CAAC7B,KADR,CAFJ,EADF,cAQE,oBAAC,YAAD,EACE,OAAO,cACL,oBAAC,UAAD,EACE,SAAS,CAAEf,OAAO,CAACnB,QADrB,CAEE,KAAK,CAAC,eAFR,eAIE,4BACE,SAAS,CACP+D,IAAI,CAAC7D,OAAL,GAAiB,YAAjB,CACIiB,OAAO,CAACb,IADZ,CAEI,EAJR,EAOGyD,IAAI,CAAC7D,OAAL,GAAiB,SAAjB,CACGe,IAAI,CAACgD,eADR,CAEGF,IAAI,CAAC7D,OAAL,GAAiB,QAAjB,CACAe,IAAI,CAACiD,cADL,CAEAjD,IAAI,CAACkD,oBAXX,CAJF,cAkBE,4BAAM,SAAS,CAAEhD,OAAO,CAACf,WAAzB,EACG2D,IAAI,CAAC7D,OAAL,GAAiB,SAAjB,EAA8B6D,IAAI,CAACzB,IADtC,CAlBF,CAFJ,EARF,CAkCGyB,IAAI,CAAC7D,OAAL,GAAiB,SAAjB,eACC,2BACE,GAAG,CAAErC,OADP,CAEE,SAAS,CAAEsD,OAAO,CAACjB,OAFrB,CAGE,GAAG,CAAC,EAHN,EAnCJ,CADF,CA2CG8D,KAAK,GAAK,CAAV,EACCD,IAAI,CAAC7B,KAAL,GAAe,uBADhB,eAC2C,oBAAC,OAAD,MA5C9C,CADF,CAgDD,CAjDA,CADH,CApBF,CADF,CA2ED,CA5EA,CAvBH,CANF,cA4GE,oBAAC,YAAD,EACE,IAAI,CAAEd,IADR,CAEE,OAAO,CAAE,yBAAIC,CAAAA,OAAO,CAAC,KAAD,CAAX,EAFX,CAGE,WAAW,CAAE,6BAAM+B,CAAAA,cAAc,EAApB,EAHf,CAIE,QAAQ,cAAE,oBAAC,SAAD,EACR,KAAK,CAAEnC,IAAI,CAACmD,uBADJ,CAER,KAAK,CAAE,CAAEpF,MAAM,CAAE,CAAV,CAFC,CAGR,SAAS,KAHD,CAIR,MAAM,CAAC,QAJC,CAKR,QAAQ,CAAE,kBAACqF,KAAD,QAAW5C,CAAAA,WAAW,CAAC,CAACC,OAAO,CAAC2C,KAAK,CAACC,MAAN,CAAalC,KAAtB,CAAD,CAAtB,EALF,EAJZ,EA5GF,cAyHE,oBAAC,YAAD,EACE,IAAI,CAAEd,QADR,CAEE,OAAO,CAAE,yBAAMC,CAAAA,WAAW,CAAC,KAAD,CAAjB,EAFX,CAGE,WAAW,CAAE,6BAAM,CAAAK,IAAI,OAAJ,EAAAA,IAAI,SAAJ,QAAAA,IAAI,CAAE2C,OAAN,GAAiBb,SAAS,EAAhC,EAHf,CAIE,QAAQ,cAAE,oBAAC,SAAD,EACR,KAAK,CAAEzC,IAAI,CAACuD,sBADJ,CAER,KAAK,CAAE,CAAExF,MAAM,CAAE,CAAV,CAFC,CAGR,KAAK,CAAE,CAAA4C,IAAI,OAAJ,EAAAA,IAAI,SAAJ,QAAAA,IAAI,CAAE2C,OAAN,GAAe,EAHd,CAIR,SAAS,KAJD,CAKR,MAAM,CAAC,QALC,CAMR,QAAQ,CAAE,kBAACF,KAAD,QAAWxC,CAAAA,OAAO,gCAAMD,IAAN,MAAW2C,OAAO,CAAEF,KAAK,CAACC,MAAN,CAAalC,KAAjC,GAAlB,EANF,EAJZ,EAzHF,CADF,CAyID,CA3OD,CA6OA,cAAe/D,CAAAA,OAAO,CACpB,eAAmD,IAAhDoC,CAAAA,QAAgD,OAAhDA,QAAgD,CAAtCL,WAAsC,OAAtCA,WAAsC,CAAzBM,aAAyB,OAAzBA,aAAyB,CAAXM,IAAW,OAAXA,IAAW,CACjD,MAAO,CAAEP,QAAQ,CAARA,QAAF,CAAYL,WAAW,CAAXA,WAAZ,CAAyBM,aAAa,CAAbA,aAAzB,CAAuCM,IAAI,CAAJA,IAAvC,CAAP,CACD,CAHmB,CAIpB,SAACyD,QAAD,CAAc,CACZ,MAAO,CACLjE,OAAO,CAAE,iBAAC0C,IAAD,CAAOzC,QAAP,CAAiBe,QAAjB,CAA8B,CACrCxD,iBAAiB,CAACyG,QAAD,CAAWvB,IAAX,CAAiBzC,QAAjB,CAA2Be,QAA3B,CAAjB,CACD,CAHI,CAILvD,gBAAgB,CAAE,0BAACyG,IAAD,CAAU,CAC1BzG,iBAAgB,CAACyG,IAAD,CAAOD,QAAP,CAAhB,CACD,CANI,CAAP,CAQD,CAbmB,CAAP,CAcblE,eAda,CAAf","sourcesContent":["import { Box, Button, makeStyles, Typography, TextField } from \"@material-ui/core\";\r\nimport Divider from \"@material-ui/core/Divider\";\r\nimport List from \"@material-ui/core/List\";\r\nimport ListItem from \"@material-ui/core/ListItem\";\r\nimport ListItemText from \"@material-ui/core/ListItemText\";\r\nimport Loading from \"assets/img/loading.gif\";\r\nimport Refresh from \"assets/img/refresh.png\";\r\nimport { LocalizeContext } from \"i18n\";\r\nimport { recordRefreshTime, updateOrdersData } from \"js/util\";\r\nimport PrimaryLayout from \"layouts/PrimaryLayout\";\r\nimport React, { useState } from \"react\";\r\nimport { connect } from \"react-redux\";\r\nimport ConfirmModal from \"components/ConfirmModal\";\r\nimport AddIcon from '@material-ui/icons/Add';\r\nimport { showUploadButton } from \"js/util\";\r\nconst useStyles = makeStyles(({ spacing }) => ({\r\n  root: {\r\n    width: \"100%\",\r\n    // color: \"#7e7a7a\",\r\n    fontWeight: \"500\",\r\n    marginBottom: spacing(2),\r\n  },\r\n  box: {\r\n    width: \"90%\",\r\n    margin: spacing(2, \"auto\", 0),\r\n    marginTop: spacing(2),\r\n  },\r\n  list: {\r\n    padding: 0,\r\n    backgroundColor: \"#fff\",\r\n  },\r\n  secondList: {\r\n    padding: 0,\r\n    backgroundColor: \"#fff\",\r\n    paddingLeft: spacing(2),\r\n  },\r\n  title: {\r\n    padding: \"0px 35px 0 16px\",\r\n    marginTop: spacing(2),\r\n    backgroundColor: \"#fff\",\r\n    color: \"#666\",\r\n    display: \"flex\",\r\n    alignItems: \"center\",\r\n    justifyContent: \"space-between\",\r\n  },\r\n  listItem: {\r\n    backgroundColor: \"#fff\",\r\n    paddingBottom: spacing(1),\r\n    position: \"relative\",\r\n  },\r\n  listItemText: {\r\n    padding: 0,\r\n  },\r\n\r\n  loadItem: {\r\n    fontSize: \"12px\",\r\n  },\r\n  loading: {\r\n    width: spacing(2),\r\n    position: \"absolute\",\r\n    right: spacing(1),\r\n  },\r\n  refreshTime: {\r\n    marginLeft: spacing(2),\r\n  },\r\n  fail: {\r\n    color: \"red\",\r\n  },\r\n}));\r\n\r\nconst SynchronizePage = ({\r\n  refresh,\r\n  refreshTime,\r\n  projects,\r\n  requestStatus: {\r\n    documentStatus,\r\n    masterDataStatus,\r\n    ordersDataStatus,\r\n    templateListStatus,\r\n    taskListStatus,\r\n  },\r\n  auth,\r\n  updateOrdersData\r\n}) => {\r\n  const i18n = React.useContext(LocalizeContext);\r\n  const classes = useStyles();\r\n  const [open, setOpen] = useState(false);\r\n  const [SODialog, setSODialog] = useState(false);\r\n  const [userInfo, setUserInfo] = useState(null);\r\n  const [SONO, setSONO] = useState({ pNumber: auth.personalNumber });\r\n  const [moduleName, setModuleName] = useState({});\r\n\r\n  const status = [\r\n    documentStatus,\r\n    masterDataStatus,\r\n    ordersDataStatus,\r\n    templateListStatus,\r\n    taskListStatus,\r\n  ];\r\n  const data = [\r\n    {\r\n      label: i18n.ISNTAPP_SYNCHRONIZE_ORDER,\r\n      value: \"orders\",\r\n      list: [\r\n        {\r\n          label: i18n.ISNTAPP_SYNCHRONIZE_MASTER_DATA,\r\n          date: refreshTime.masterDataRefreshTime,\r\n          loading: masterDataStatus,\r\n        },\r\n        {\r\n          label: i18n.ISNTAPP_SYNCHRONIZE_ORDER_DATA,\r\n          date: refreshTime.orderDataRefreshTime,\r\n          loading: ordersDataStatus,\r\n        },\r\n      ],\r\n    },\r\n    {\r\n      label: i18n.ISNTAPP_SYNCHRONIZE_DOCUMENTS,\r\n      value: \"documents\",\r\n      list: [\r\n        {\r\n          label: i18n.ISNTAPP_SYNCHRONIZE_DOCUMENTS,\r\n          date: refreshTime.templateListDataRefreshTime,\r\n          loading: templateListStatus,\r\n        },\r\n        {\r\n          label: i18n.ISNTAPP_SYNCHRONIZE_DOCUMENT_LIST,\r\n          date: refreshTime.documentListDataRefreshTime,\r\n          loading: documentStatus,\r\n        },\r\n      ],\r\n    },\r\n    {\r\n      label: i18n.ISNTAPP_SYNCHRONIZE_TASK,\r\n      value: \"task\",\r\n      list: [\r\n        {\r\n          label: i18n.ISNTAPP_SYNCHRONIZE_TASK_LIST,\r\n          date: refreshTime.taskListDataRefreshTime,\r\n          loading: taskListStatus,\r\n        },\r\n      ],\r\n    },\r\n  ];\r\n\r\n  const synchroData = (name, projects) => {\r\n    if (auth?.roles[0] === \"SL\") {\r\n        setOpen(true)\r\n    } else {\r\n      refresh(name, projects, userInfo)\r\n    }\r\n  }\r\n\r\n  const confirmRefresh = () => {\r\n    if (!userInfo?.pNumber) {\r\n      return false;\r\n    }\r\n    window.localStorage.setItem(\"peInfo\", JSON.stringify({ pNumber: userInfo?.pNumber }));\r\n    refresh(moduleName.name, moduleName.projects, userInfo)\r\n    setOpen(false)\r\n  }\r\n\r\n  const confirmSO = () => {\r\n    setSODialog(false);\r\n    updateOrdersData(SONO);\r\n    setSONO(null);\r\n  }\r\n\r\n  return (\r\n    <PrimaryLayout\r\n      name=\"synchronize\"\r\n      title={i18n.ISNTAPP_SYNC_PAGE}\r\n      isShowRefreshButton={false}\r\n      isFetchAll={false}\r\n    >\r\n      <Box className={classes.root}>\r\n        <Box className={classes.title}>\r\n          <Typography variant=\"h6\">{i18n.ISNTAPP_SYNCHRONIZE_PAGE}</Typography>\r\n          <Box>\r\n            {showUploadButton() &&\r\n              <Button\r\n                onClick={() => setSODialog(true)}\r\n              >\r\n                <AddIcon color=\"error\" />\r\n              </Button>\r\n            }\r\n            <Button\r\n              onClick={() => {\r\n                synchroData(\"all\", projects);\r\n                setModuleName({ name: \"all\", projects: projects })\r\n              }}\r\n              disabled={status.indexOf(\"loading\") > -1 ? true : false}\r\n            >\r\n              <img src={Refresh} width=\"32\" alt=\"\" />\r\n            </Button>\r\n          </Box>\r\n        </Box>\r\n\r\n        {data.map((item, index) => {\r\n          return (\r\n            <Box key={index} className={classes.box}>\r\n              <List className={classes.list}>\r\n                <ListItem>\r\n                  <ListItemText\r\n                    primary={\r\n                      <Typography variant=\"subtitle2\">{item.label}</Typography>\r\n                    }\r\n                  />\r\n                  <Button\r\n                    onClick={() => {\r\n                      synchroData(item.value, projects);\r\n                      setModuleName({ name: item.value, projects: projects })\r\n                    }}\r\n                    disabled={status.indexOf(\"loading\") > -1 ? true : false}\r\n                  >\r\n                    <img src={Refresh} width=\"32\" alt=\"\" />\r\n                  </Button>\r\n                </ListItem>\r\n              </List>\r\n              <Divider />\r\n              <List className={classes.secondList}>\r\n                {item.list.map((item, index) => {\r\n                  return (\r\n                    <Box key={index}>\r\n                      <ListItem className={classes.listItem}>\r\n                        <ListItemText\r\n                          primary={\r\n                            <Typography variant=\"body2\">\r\n                              {item.label}\r\n                            </Typography>\r\n                          }\r\n                        />\r\n                        <ListItemText\r\n                          primary={\r\n                            <Typography\r\n                              className={classes.loadItem}\r\n                              color=\"textSecondary\"\r\n                            >\r\n                              <span\r\n                                className={\r\n                                  item.loading === \"failToLoad\"\r\n                                    ? classes.fail\r\n                                    : \"\"\r\n                                }\r\n                              >\r\n                                {item.loading === \"loading\"\r\n                                  ? i18n.ISNTAPP_LOADING\r\n                                  : item.loading === \"loaded\"\r\n                                  ? i18n.ISNTAPP_LOADED\r\n                                  : i18n.ISNTAPP_FEIL_TO_LOAD}\r\n                              </span>\r\n\r\n                              <span className={classes.refreshTime}>\r\n                                {item.loading !== \"loading\" && item.date}\r\n                              </span>\r\n                            </Typography>\r\n                          }\r\n                        />\r\n                        {item.loading === \"loading\" && (\r\n                          <img\r\n                            src={Loading}\r\n                            className={classes.loading}\r\n                            alt=\"\"\r\n                          />\r\n                        )}\r\n                      </ListItem>\r\n                      {index === 0 &&\r\n                        item.label !== \"Synchronize Task list\" && <Divider />}\r\n                    </Box>\r\n                  );\r\n                })}\r\n              </List>\r\n            </Box>\r\n          );\r\n        })}\r\n      </Box>\r\n\r\n      <ConfirmModal\r\n        open={open}\r\n        onClose={()=>setOpen(false)}\r\n        handleClick={() => confirmRefresh()}\r\n        children={<TextField\r\n          label={i18n.ISNTAPP_INPUT_PE_JOB_NO}\r\n          style={{ margin: 8 }}\r\n          fullWidth\r\n          margin=\"normal\"\r\n          onChange={(event) => setUserInfo({pNumber:event.target.value})}\r\n        />}\r\n      />\r\n\r\n      <ConfirmModal\r\n        open={SODialog}\r\n        onClose={() => setSODialog(false)}\r\n        handleClick={() => SONO?.orderNo && confirmSO()}\r\n        children={<TextField\r\n          label={i18n.ISNTAPP_INPUT_ORDER_NO}\r\n          style={{ margin: 8 }}\r\n          value={SONO?.orderNo||\"\"}\r\n          fullWidth\r\n          margin=\"normal\"\r\n          onChange={(event) => setSONO({ ...SONO,orderNo: event.target.value})}\r\n        />}\r\n      />\r\n      </PrimaryLayout>\r\n  );\r\n};\r\n\r\nexport default connect(\r\n  ({ projects, refreshTime, requestStatus,auth }) => {\r\n    return { projects, refreshTime, requestStatus,auth };\r\n  },\r\n  (dispatch) => {\r\n    return {\r\n      refresh: (name, projects, userInfo) => {\r\n        recordRefreshTime(dispatch, name, projects, userInfo);\r\n      },\r\n      updateOrdersData: (soNo) => {\r\n        updateOrdersData(soNo, dispatch)\r\n      }\r\n    };\r\n  }\r\n)(SynchronizePage);\r\n"]},"metadata":{},"sourceType":"module"}