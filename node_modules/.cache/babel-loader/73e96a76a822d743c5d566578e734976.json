{"ast":null,"code":"import _slicedToArray from\"C:\\\\project\\\\SCF-NI_PM_App\\\\SCF.InstallationQuality\\\\react-client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";import{Box,Button}from\"@material-ui/core\";import*as action from\"actions\";import FFTab from\"components/FFTab\";import OrderActivityList from\"components/OrderActivityList\";import OrderActivityListCard from\"components/OrderActivityListCard\";import OrderActivityListMiniCard from\"components/OrderActivityListMiniCard\";import OrderInfo from\"components/OrderInfo\";import ProjectSiteAddress from\"components/ProjectSiteAddress\";import{LocalizeContext}from\"i18n\";import gpsIcon from\"img/gps.png\";import installationIcon from\"img/installation.png\";import nameIcon from\"img/name.png\";import numberIcon from\"img/number.png\";import orderIcon from\"img/order.png\";import productlineIcon from\"img/productline.png\";import progressIcon from\"img/progress.png\";import subcontlIcon from\"img/subcontl.png\";import teamLeader from\"img/teamLeader.png\";import unitIcon from\"img/unit.png\";import*as util from\"js/util\";import{scrollToPosition}from\"js/util\";import PrimaryLayout from\"layouts/PrimaryLayout\";import moment from\"moment\";import React,{useEffect,useRef}from\"react\";import{connect}from\"react-redux\";import{useLocation}from\"react-router-dom\";import*as publicFn from\"../../js/publicFn/index\";import{useHistory}from\"react-router-dom\";import listIcon from\"img/checkList.svg\";import{getChecklistActivityNo}from\"js/util\";var OrderDetailPage=function OrderDetailPage(_ref){var orderNumber=_ref.orderNumber,data=_ref.data,projectNumber=_ref.projectNumber,showInstallations=_ref.showInstallations,_submit=_ref.submit,orderActivities=_ref.orderActivities,orders=_ref.orders,whetherToShutDown=_ref.whetherToShutDown,defaultTab=_ref.defaultTab,documentList=_ref.documentList;var i18n=React.useContext(LocalizeContext);var history=useHistory();var fields=[{icon:function icon(){return/*#__PURE__*/React.createElement(\"img\",{src:numberIcon,width:\"20\",alt:\"\"});},label:i18n.PROJECTLIST_PROJECT_NO,name:\"projectNumber\",title:i18n.PROJECTLIST_PROJECT},{icon:function icon(){return/*#__PURE__*/React.createElement(\"img\",{src:nameIcon,width:\"20\",alt:\"\"});},label:i18n.PROJECTLIST_PROJECT_DESCRIPTION,name:\"projectName\"},{icon:function icon(){return/*#__PURE__*/React.createElement(\"img\",{src:gpsIcon,width:\"20\",alt:\"\"});},label:i18n.PROJECTLIST_SITE_ADDRESS,name:\"projectSite\",component:function component(){return/*#__PURE__*/React.createElement(ProjectSiteAddress,{projectNumber:data.projectNumber});}},{icon:function icon(){return/*#__PURE__*/React.createElement(\"img\",{src:teamLeader,width:\"20\",alt:\"\"});},label:i18n.INSTAPP_PROJECTLIST_PROJECT_LEADER,name:\"PM\"},{icon:function icon(){return/*#__PURE__*/React.createElement(\"img\",{src:subcontlIcon,width:\"20\",alt:\"\"});},label:i18n.JOBLIST_SUBCON_TL,name:\"teamLeader\"},{icon:function icon(){return/*#__PURE__*/React.createElement(\"img\",{src:progressIcon,width:\"20\",alt:\"\"});},label:i18n.ISNTAPP_DESIGNATION,name:\"unitDesignation\"},{icon:function icon(){return/*#__PURE__*/React.createElement(\"img\",{src:unitIcon,width:\"20\",alt:\"\"});},label:i18n.INSTAPP_PROJECTLIST_UnitCount,name:\"orderQuantity\"},{icon:function icon(){return/*#__PURE__*/React.createElement(\"img\",{src:orderIcon,width:\"20\",alt:\"\"});},label:i18n.JOBLIST_ORDER_NUMBER,name:\"orderNumber\",title:i18n.JOBLIST_ORDER},{icon:function icon(){return/*#__PURE__*/React.createElement(\"img\",{src:productlineIcon,width:\"20\",alt:\"\"});},label:i18n.ORDERDETAILS_PRODUCT_FAMILY,name:\"productFamilyName\"},{icon:function icon(){return/*#__PURE__*/React.createElement(\"img\",{src:installationIcon,width:\"20\",alt:\"\"});},label:i18n.INSTAPP_JOBLIST_INSTMETHOD,name:\"installMethod\"},{icon:function icon(){return/*#__PURE__*/React.createElement(\"img\",{src:progressIcon,width:\"20\",alt:\"\"});},label:i18n.INSTAPP_JOBLIST_UNIT_PROGRESS,name:\"elevatorProgress\"},{icon:function icon(){return/*#__PURE__*/React.createElement(\"img\",{src:listIcon,alt:\"\"});},label:i18n.VIEW_INSTALLATION_CHECKLIST,name:\"installationChecklist\",component:function component(){return/*#__PURE__*/React.createElement(Button,{color:\"primary\",style:{padding:0,minWidth:\" fit-content\"},onClick:function onClick(){history.push(\"/documents/\".concat(getChecklistActivityNo(data),\"/\").concat(data.orderNumber,\"/\").concat(data.productFamily,\"/\",\"installationChecklist\"));}},\">>\");}}];var _React$useState=React.useState(defaultTab?defaultTab:\"basic\"),_React$useState2=_slicedToArray(_React$useState,2),tab=_React$useState2[0],setTab=_React$useState2[1];var tabs=[{title:i18n.ISNTAPP_BASIC,value:\"basic\"},{title:i18n.ISNTAPP_PENDING,value:\"pending\"},{title:i18n.ISNTAPP_ALL,value:\"all\"}];var title={backgroundColor:\"red\",padding:\"4px 0\",textAlign:\"center\",fontSize:\"16px\",color:\"white\"};var scrollRef=useRef(null);var location=useLocation();useEffect(function(){setTimeout(function(){scrollToPosition(scrollRef,location.pathname);},1000);},[location.pathname]);!getChecklistActivityNo(data)&&fields.splice(fields.length-1,1);return/*#__PURE__*/React.createElement(PrimaryLayout,{title:i18n.INSTAPP_JOBLIST_UNIT_DETAIL+\": \"+data[\"orderNumber\"]},/*#__PURE__*/React.createElement(Box,{style:{position:\"fixed\",top:\"52px\",width:\"100%\",zIndex:\"10000\"}},whetherToShutDown&&/*#__PURE__*/React.createElement(\"div\",{style:title},/*#__PURE__*/React.createElement(\"span\",null,whetherToShutDown)),/*#__PURE__*/React.createElement(FFTab,{tabs:tabs,selectedTabValue:tab,onTabChange:function onTabChange(value){setTab(value);}})),/*#__PURE__*/React.createElement(\"div\",{style:{width:\"100%\",padding:\"16px\",position:\"absolute\",top:whetherToShutDown?\"60px\":\"32px\",height:window.screen.height-187+\"px\",overflow:\"hidden auto\"},ref:scrollRef},tab===\"basic\"&&/*#__PURE__*/React.createElement(OrderInfo,{fields:fields,data:data}),tab===\"pending\"&&/*#__PURE__*/React.createElement(OrderActivityList,{data:data.filteredOrderActivities,oneThousandPlannedDate:moment(orderActivities[\"\".concat(orderNumber,\"-1000\")].leadingDate,\"YYYY/MM/DD\").format(\"YYYY-MM-DD\"),nineThousandPlannedDate:moment(orderActivities[\"\".concat(orderNumber,\"-9000\")].leadingDate,\"YYYY/MM/DD\").format(\"YYYY-MM-DD\"),component:OrderActivityListCard,tabType:\"activity\",submit:function submit(activityNumber,date,type){_submit(activityNumber,orderNumber,projectNumber,date,type,orderActivities,orders);}}),tab===\"all\"&&/*#__PURE__*/React.createElement(OrderActivityList,{data:data.allOrderActivities,component:OrderActivityListMiniCard})));};var mapStateToProps=function mapStateToProps(state,ownProps){var _orders$orderNumber,_partners$,_partners$2,_orders$orderNumber2,_orders$orderNumber3,_orderInstallationMet,_methodsList$filter$,_orders$orderNumber4;var orders=state.orders,projects=state.projects,orderInstallationMethods=state.orderInstallationMethods,productFamilies=state.productFamilies,partners=state.partners,orderActivities=state.orderActivities,activities=state.activities,auth=state.auth,documentList=state.documentList,templates=state.templates,wayToInstallList=state.wayToInstallList,defaultTab=state.settings.defaultTab;var match=ownProps.match;var params=match.params;var orderNumber=params.number;var projectNumber=(_orders$orderNumber=orders[orderNumber])===null||_orders$orderNumber===void 0?void 0:_orders$orderNumber.projectNumber;var _ref2=projects[projectNumber]?projects[projectNumber]:\"\",projectName=_ref2.description;var _ref3=orders[orderNumber]||{},productFamily=_ref3.productFamily;var _ref4=productFamilies[productFamily]?productFamilies[productFamily]:\"\",productFamilyName=_ref4.name;var teamLeader=(_partners$=partners[\"\".concat(orderNumber,\"-VW\")])===null||_partners$===void 0?void 0:_partners$.name1;var PM=(_partners$2=partners[\"\".concat(orderNumber,\"-YI\")])===null||_partners$2===void 0?void 0:_partners$2.name1;var getHint=function getHint(isExecutable){var finishedDateEditable=isExecutable.finishedDateEditablePermission;var finishedDateCancelable=isExecutable.finishedDateCancelablePermission;if(!finishedDateEditable&&!finishedDateCancelable){return\"(无确认权限)\";}else{return\"\";}};var filteredOrderActivitiesData=[];publicFn.orderDetailSteps(orderActivities,orderNumber,auth.activityAuth,auth.roles[0]).forEach(function(activityNo){if(orderActivities[orderNumber+\"-\"+activityNo]){var _orderActivities=orderActivities[orderNumber+\"-\"+activityNo],confirmedDate=_orderActivities.confirmedDate,leadingDate=_orderActivities.leadingDate,leadingEndDate=_orderActivities.leadingEndDate,leadingStartDate=_orderActivities.leadingStartDate,info=_orderActivities.info,originalStep=_orderActivities.originalStep,activityNumber=_orderActivities.activityNumber,editable=_orderActivities.editable,confPreStart=_orderActivities.confPreStart,confPast=_orderActivities.confPast,sort=_orderActivities.sort;var _ref5=activities[activityNo]||{},descriptionShort=_ref5.descriptionShort,descriptionShort14=_ref5.descriptionShort14;var description=orderActivities[orderNumber+\"-7030\"]?descriptionShort14?descriptionShort14:descriptionShort:descriptionShort;var authOrderActivities={auth:auth,orderActivities:orderActivities,documentList:documentList,templates:templates};var ownprops={activityNumber:activityNumber,orderNumber:orderNumber,projectNumber:projectNumber};var isExecutable=publicFn.DatePermissionControl(authOrderActivities,ownprops);if(orderActivities[orderNumber+\"-\"+activityNo].editable!==undefined&&orderActivities[orderNumber+\"-\"+activityNo].editable===false){confirmedDate?info=\"节点已确认\":info=\"节点可确认\";}filteredOrderActivitiesData.push({activityNumber:activityNo,confirmedDate:confirmedDate?new Date(confirmedDate).toLocaleDateString():\"-\",description:description,leadingDate:leadingDate?new Date(leadingDate).toLocaleDateString():leadingStartDate&&leadingEndDate?new Date(leadingEndDate).toLocaleDateString():\"-\",info:info||\"-\",orderNumber:orderNumber,productFamily:productFamily,originalStep:originalStep,editable:editable,isExecutable:isExecutable,hint:getHint(isExecutable),confPreStart:confPreStart,confPast:confPast,sort:sort});}});var allOrderActivitiesData=[];publicFn.allOrderDetailSteps(orderActivities,orderNumber,auth.activityAuth,auth.roles[0]).forEach(function(activityNo){if(orderActivities[orderNumber+\"-\"+activityNo]){var _ref6=orderActivities[orderNumber+\"-\"+activityNo]||{},confirmedDate=_ref6.confirmedDate,leadingDate=_ref6.leadingDate,leadingEndDate=_ref6.leadingEndDate,leadingStartDate=_ref6.leadingStartDate,activityNumber=_ref6.activityNumber,info=_ref6.info,sort=_ref6.sort;var _ref7=activities[activityNo]||{},descriptionShort=_ref7.descriptionShort,descriptionShort14=_ref7.descriptionShort14;var description=orderActivities[orderNumber+\"-7030\"]?descriptionShort14?descriptionShort14:descriptionShort:descriptionShort;var authOrderActivities={auth:auth,orderActivities:orderActivities,documentList:documentList,templates:templates};var ownprops={activityNumber:activityNumber,orderNumber:orderNumber,projectNumber:projectNumber};var isExecutable=publicFn.DatePermissionControl(authOrderActivities,ownprops);if(orderActivities[orderNumber+\"-\"+activityNo].editable!==undefined&&orderActivities[orderNumber+\"-\"+activityNo].editable===false){confirmedDate?info=\"节点已确认\":info=\"节点可确认\";}allOrderActivitiesData.push({activityNumber:activityNo,confirmedDate:confirmedDate?new Date(confirmedDate).toLocaleDateString():\"-\",description:description,leadingDate:leadingDate?new Date(leadingDate).toLocaleDateString():leadingStartDate&&leadingEndDate?new Date(leadingEndDate).toLocaleDateString():\"-\",info:info||\"-\",orderNumber:orderNumber,productFamily:productFamily,isExecutable:isExecutable,sort:sort});}});var progress=util.orderProgress(orderActivities,orderNumber);var whetherToShutDown=util.whetherToShutDown(orderActivities,orderNumber);var methods=wayToInstallList[(orders===null||orders===void 0?void 0:(_orders$orderNumber2=orders[orderNumber])===null||_orders$orderNumber2===void 0?void 0:_orders$orderNumber2.productLine)+\"-\"+(orders===null||orders===void 0?void 0:(_orders$orderNumber3=orders[orderNumber])===null||_orders$orderNumber3===void 0?void 0:_orders$orderNumber3.productFamily)];var methodsList=methods&&Object.keys(methods.installationMethods).map(function(item){return{label:methods.installationMethods[item],value:item};});var defaultselectValue=orderInstallationMethods===null||orderInstallationMethods===void 0?void 0:(_orderInstallationMet=orderInstallationMethods[orderNumber])===null||_orderInstallationMet===void 0?void 0:_orderInstallationMet.installationMethod;var defaultSelectInstalltion=methodsList===null||methodsList===void 0?void 0:(_methodsList$filter$=methodsList.filter(function(item){return item.value===defaultselectValue.toString();})[0])===null||_methodsList$filter$===void 0?void 0:_methodsList$filter$.label;var unitDesignation=(_orders$orderNumber4=orders[orderNumber])===null||_orders$orderNumber4===void 0?void 0:_orders$orderNumber4.unitDesignation;return{showInstallations:true,orderNumber:orderNumber,data:{projectNumber:projectNumber,fitterQuantity:5,orderQuantity:Object.keys(orders).filter(function(key){return orders[key].projectNumber===projectNumber;}).length,projectName:projectName,teamLeader:teamLeader,PM:PM,orderNumber:orderNumber,productFamily:productFamily,productFamilyName:productFamilyName,installMethod:defaultSelectInstalltion,installMethods:methodsList,defaultselectValue:defaultselectValue,elevatorProgress:progress+\"%\",filteredOrderActivities:filteredOrderActivitiesData,allOrderActivities:allOrderActivitiesData,unitDesignation:unitDesignation},projectNumber:projectNumber,orderActivities:orderActivities,confPreStart:orderActivities,confPast:orderActivities,orders:orders,whetherToShutDown:whetherToShutDown,defaultTab:defaultTab,documentList:documentList};};var mapDispatchToState=function mapDispatchToState(dispatch){return{submit:function submit(activityNumber,orderNumber,projectNumber,date,type,orderActivities,orders){if(util.isInstallationStepEditable(orderNumber,activityNumber,orderActivities)){var data=util.setActivityStatusParams(projectNumber,orderNumber,activityNumber,date,type,orderActivities,orders);dispatch(action.updateOrderActivityStatus(data));}else{var _data={projectNo:projectNumber,orderNo:orderNumber,stepNo:activityNumber,confirmedDate:date};dispatch(action.updateLocalInstallationStepConfirmDate(_data));};}};};export default connect(mapStateToProps,mapDispatchToState)(OrderDetailPage);","map":{"version":3,"sources":["C:/project/SCF-NI_PM_App/SCF.InstallationQuality/react-client/src/pages/OrderDetailPage/index.js"],"names":["Box","Button","action","FFTab","OrderActivityList","OrderActivityListCard","OrderActivityListMiniCard","OrderInfo","ProjectSiteAddress","LocalizeContext","gpsIcon","installationIcon","nameIcon","numberIcon","orderIcon","productlineIcon","progressIcon","subcontlIcon","teamLeader","unitIcon","util","scrollToPosition","PrimaryLayout","moment","React","useEffect","useRef","connect","useLocation","publicFn","useHistory","getChecklistActivityNo","OrderDetailPage","orderNumber","data","projectNumber","showInstallations","submit","orderActivities","orders","whetherToShutDown","defaultTab","documentList","i18n","useContext","history","fields","icon","label","PROJECTLIST_PROJECT_NO","name","title","PROJECTLIST_PROJECT","PROJECTLIST_PROJECT_DESCRIPTION","PROJECTLIST_SITE_ADDRESS","component","INSTAPP_PROJECTLIST_PROJECT_LEADER","JOBLIST_SUBCON_TL","ISNTAPP_DESIGNATION","INSTAPP_PROJECTLIST_UnitCount","JOBLIST_ORDER_NUMBER","JOBLIST_ORDER","ORDERDETAILS_PRODUCT_FAMILY","INSTAPP_JOBLIST_INSTMETHOD","INSTAPP_JOBLIST_UNIT_PROGRESS","listIcon","VIEW_INSTALLATION_CHECKLIST","padding","minWidth","push","productFamily","useState","tab","setTab","tabs","ISNTAPP_BASIC","value","ISNTAPP_PENDING","ISNTAPP_ALL","backgroundColor","textAlign","fontSize","color","scrollRef","location","setTimeout","pathname","splice","length","INSTAPP_JOBLIST_UNIT_DETAIL","position","top","width","zIndex","height","window","screen","overflow","filteredOrderActivities","leadingDate","format","activityNumber","date","type","allOrderActivities","mapStateToProps","state","ownProps","projects","orderInstallationMethods","productFamilies","partners","activities","auth","templates","wayToInstallList","settings","match","params","number","projectName","description","productFamilyName","name1","PM","getHint","isExecutable","finishedDateEditable","finishedDateEditablePermission","finishedDateCancelable","finishedDateCancelablePermission","filteredOrderActivitiesData","orderDetailSteps","activityAuth","roles","forEach","activityNo","confirmedDate","leadingEndDate","leadingStartDate","info","originalStep","editable","confPreStart","confPast","sort","descriptionShort","descriptionShort14","authOrderActivities","ownprops","DatePermissionControl","undefined","Date","toLocaleDateString","hint","allOrderActivitiesData","allOrderDetailSteps","progress","orderProgress","methods","productLine","methodsList","Object","keys","installationMethods","map","item","defaultselectValue","installationMethod","defaultSelectInstalltion","filter","toString","unitDesignation","fitterQuantity","orderQuantity","key","installMethod","installMethods","elevatorProgress","mapDispatchToState","dispatch","isInstallationStepEditable","setActivityStatusParams","updateOrderActivityStatus","projectNo","orderNo","stepNo","updateLocalInstallationStepConfirmDate"],"mappings":"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","sourcesContent":["import { Box, Button } from \"@material-ui/core\";\r\nimport * as action from \"actions\";\r\nimport FFTab from \"components/FFTab\";\r\nimport OrderActivityList from \"components/OrderActivityList\";\r\nimport OrderActivityListCard from \"components/OrderActivityListCard\";\r\nimport OrderActivityListMiniCard from \"components/OrderActivityListMiniCard\";\r\nimport OrderInfo from \"components/OrderInfo\";\r\nimport ProjectSiteAddress from \"components/ProjectSiteAddress\";\r\nimport { LocalizeContext } from \"i18n\";\r\nimport gpsIcon from \"img/gps.png\";\r\nimport installationIcon from \"img/installation.png\";\r\nimport nameIcon from \"img/name.png\";\r\nimport numberIcon from \"img/number.png\";\r\nimport orderIcon from \"img/order.png\";\r\nimport productlineIcon from \"img/productline.png\";\r\nimport progressIcon from \"img/progress.png\";\r\nimport subcontlIcon from \"img/subcontl.png\";\r\nimport teamLeader from \"img/teamLeader.png\";\r\nimport unitIcon from \"img/unit.png\";\r\nimport * as util from \"js/util\";\r\nimport { scrollToPosition } from \"js/util\";\r\nimport PrimaryLayout from \"layouts/PrimaryLayout\";\r\nimport moment from \"moment\";\r\nimport React, { useEffect, useRef } from \"react\";\r\nimport { connect } from \"react-redux\";\r\nimport { useLocation } from \"react-router-dom\";\r\nimport * as publicFn from \"../../js/publicFn/index\";\r\nimport { useHistory } from \"react-router-dom\";\r\nimport listIcon from \"img/checkList.svg\";\r\nimport { getChecklistActivityNo } from \"js/util\";\r\n\r\n\r\nconst OrderDetailPage = ({\r\n  orderNumber,\r\n  data,\r\n  projectNumber,\r\n  showInstallations,\r\n  submit,\r\n  orderActivities,\r\n  orders,\r\n  whetherToShutDown,\r\n  defaultTab,\r\n  documentList,\r\n}) => {\r\n  const i18n = React.useContext(LocalizeContext);\r\n  const history = useHistory();\r\n\r\n  const fields = [\r\n    {\r\n      icon: () => <img src={numberIcon} width=\"20\" alt=\"\" />,\r\n      label: i18n.PROJECTLIST_PROJECT_NO,\r\n      name: \"projectNumber\",\r\n      title: i18n.PROJECTLIST_PROJECT,\r\n    },\r\n    {\r\n      icon: () => <img src={nameIcon} width=\"20\" alt=\"\" />,\r\n      label: i18n.PROJECTLIST_PROJECT_DESCRIPTION,\r\n      name: \"projectName\",\r\n    },\r\n    {\r\n      icon: () => <img src={gpsIcon} width=\"20\" alt=\"\" />,\r\n      label: i18n.PROJECTLIST_SITE_ADDRESS,\r\n      name: \"projectSite\",\r\n      component: () => (\r\n        <ProjectSiteAddress projectNumber={data.projectNumber} />\r\n      ),\r\n    },\r\n    {\r\n      icon: () => <img src={teamLeader} width=\"20\" alt=\"\" />,\r\n      label: i18n.INSTAPP_PROJECTLIST_PROJECT_LEADER,\r\n      name: \"PM\",\r\n    },\r\n    {\r\n      icon: () => <img src={subcontlIcon} width=\"20\" alt=\"\" />,\r\n      label: i18n.JOBLIST_SUBCON_TL,\r\n      name: \"teamLeader\",\r\n    },\r\n    {\r\n      icon: () => <img src={progressIcon} width=\"20\" alt=\"\" />,\r\n      label: i18n.ISNTAPP_DESIGNATION,\r\n      name: \"unitDesignation\",\r\n    },\r\n    {\r\n      icon: () => <img src={unitIcon} width=\"20\" alt=\"\" />,\r\n      label: i18n.INSTAPP_PROJECTLIST_UnitCount,\r\n      name: \"orderQuantity\",\r\n    },\r\n    {\r\n      icon: () => <img src={orderIcon} width=\"20\" alt=\"\" />,\r\n      label: i18n.JOBLIST_ORDER_NUMBER,\r\n      name: \"orderNumber\",\r\n      title: i18n.JOBLIST_ORDER,\r\n    },\r\n    {\r\n      icon: () => <img src={productlineIcon} width=\"20\" alt=\"\" />,\r\n      label: i18n.ORDERDETAILS_PRODUCT_FAMILY,\r\n      name: \"productFamilyName\",\r\n    },\r\n    {\r\n      icon: () => <img src={installationIcon} width=\"20\" alt=\"\" />,\r\n      label: i18n.INSTAPP_JOBLIST_INSTMETHOD,\r\n      name: \"installMethod\",\r\n    },\r\n    {\r\n      icon: () => <img src={progressIcon} width=\"20\" alt=\"\" />,\r\n      label: i18n.INSTAPP_JOBLIST_UNIT_PROGRESS,\r\n      name: \"elevatorProgress\",\r\n    },\r\n    {\r\n      icon: () => <img src={listIcon} alt=\"\" />,\r\n      label: i18n.VIEW_INSTALLATION_CHECKLIST,\r\n      name: \"installationChecklist\",\r\n      component: () => (\r\n        <Button\r\n          color=\"primary\"\r\n          style={{ padding: 0, minWidth: \" fit-content\" }}\r\n          onClick={() => {\r\n            history.push(\r\n              `/documents/${getChecklistActivityNo(data)}/${data.orderNumber}/${data.productFamily\r\n              }/${`installationChecklist`}`\r\n            );\r\n          }}\r\n        >\r\n          >>\r\n        </Button>\r\n      ),\r\n    },\r\n  ];\r\n\r\n  const [tab, setTab] = React.useState(defaultTab ? defaultTab : \"basic\");\r\n\r\n  const tabs = [\r\n    { title: i18n.ISNTAPP_BASIC, value: \"basic\" },\r\n    { title: i18n.ISNTAPP_PENDING, value: \"pending\" },\r\n    { title: i18n.ISNTAPP_ALL, value: \"all\" },\r\n  ];\r\n\r\n  const title = {\r\n    backgroundColor: \"red\",\r\n    padding: \"4px 0\",\r\n    textAlign: \"center\",\r\n    fontSize: \"16px\",\r\n    color: \"white\",\r\n  };\r\n\r\n  const scrollRef = useRef(null);\r\n\r\n  const location = useLocation();\r\n\r\n  useEffect(() => {\r\n    setTimeout(() => {\r\n      scrollToPosition(scrollRef, location.pathname);\r\n    }, 1000);\r\n  }, [location.pathname]);\r\n\r\n  !getChecklistActivityNo(data) && fields.splice(fields.length - 1, 1);\r\n\r\n  return (\r\n    <PrimaryLayout\r\n      title={i18n.INSTAPP_JOBLIST_UNIT_DETAIL + \": \" + data[\"orderNumber\"]}\r\n    >\r\n      <Box\r\n        style={{\r\n          position: \"fixed\",\r\n          top: \"52px\",\r\n          width: \"100%\",\r\n          zIndex: \"10000\",\r\n        }}\r\n      >\r\n        {whetherToShutDown && (\r\n          <div style={title}>\r\n            <span>{whetherToShutDown}</span>\r\n          </div>\r\n        )}\r\n        <FFTab\r\n          tabs={tabs}\r\n          selectedTabValue={tab}\r\n          onTabChange={(value) => {\r\n            setTab(value);\r\n          }}\r\n        />\r\n      </Box>\r\n      <div\r\n        style={{\r\n          width: \"100%\",\r\n          padding: \"16px\",\r\n          position: \"absolute\",\r\n          top: whetherToShutDown ? \"60px\" : \"32px\",\r\n          height: window.screen.height - 187 + \"px\",\r\n          overflow: \"hidden auto\",\r\n        }}\r\n        ref={scrollRef}\r\n      >\r\n        {tab === \"basic\" && <OrderInfo fields={fields} data={data} />}\r\n        {tab === \"pending\" && (\r\n          <OrderActivityList\r\n            data={data.filteredOrderActivities}\r\n            oneThousandPlannedDate={moment(\r\n              orderActivities[`${orderNumber}-1000`].leadingDate,\r\n              \"YYYY/MM/DD\"\r\n            ).format(\"YYYY-MM-DD\")}\r\n            nineThousandPlannedDate={moment(\r\n              orderActivities[`${orderNumber}-9000`].leadingDate,\r\n              \"YYYY/MM/DD\"\r\n            ).format(\"YYYY-MM-DD\")}\r\n            component={OrderActivityListCard}\r\n            tabType=\"activity\"\r\n            submit={(activityNumber, date, type) => {\r\n              submit(\r\n                activityNumber,\r\n                orderNumber,\r\n                projectNumber,\r\n                date,\r\n                type,\r\n                orderActivities,\r\n                orders\r\n              );\r\n            }}\r\n          ></OrderActivityList>\r\n        )}\r\n        {tab === \"all\" && (\r\n          <OrderActivityList\r\n            data={data.allOrderActivities}\r\n            component={OrderActivityListMiniCard}\r\n          ></OrderActivityList>\r\n        )}\r\n      </div>\r\n    </PrimaryLayout>\r\n  );\r\n};\r\n\r\nconst mapStateToProps = (state, ownProps) => {\r\n  const {\r\n    orders,\r\n    projects,\r\n    orderInstallationMethods,\r\n    productFamilies,\r\n    partners,\r\n    orderActivities,\r\n    activities,\r\n    // installations,\r\n    auth,\r\n    documentList,\r\n    templates,\r\n    wayToInstallList,\r\n    settings: { defaultTab },\r\n  } = state;\r\n  const { match } = ownProps;\r\n  const { params } = match;\r\n  const { number: orderNumber } = params;\r\n  const projectNumber = orders[orderNumber]?.projectNumber;\r\n  const { description: projectName } = projects[projectNumber]\r\n    ? projects[projectNumber]\r\n    : \"\";\r\n  const { productFamily } = orders[orderNumber] || {};\r\n  const { name: productFamilyName } = productFamilies[productFamily]\r\n    ? productFamilies[productFamily]\r\n    : \"\";\r\n  const teamLeader = partners[`${orderNumber}-VW`]?.name1;\r\n  const PM = partners[`${orderNumber}-YI`]?.name1;\r\n  const getHint = (isExecutable) => {\r\n    const finishedDateEditable = isExecutable.finishedDateEditablePermission;\r\n    const finishedDateCancelable =\r\n      isExecutable.finishedDateCancelablePermission;\r\n\r\n    if (!finishedDateEditable && !finishedDateCancelable) {\r\n      return \"(无确认权限)\";\r\n    } else {\r\n      return \"\";\r\n    }\r\n  };\r\n\r\n  const filteredOrderActivitiesData = [];\r\n\r\n  publicFn\r\n    .orderDetailSteps(\r\n      orderActivities,\r\n      orderNumber,\r\n      auth.activityAuth,\r\n      auth.roles[0]\r\n    )\r\n    .forEach((activityNo) => {\r\n      if (orderActivities[orderNumber + \"-\" + activityNo]) {\r\n        let {\r\n          confirmedDate,\r\n          leadingDate,\r\n          leadingEndDate,\r\n          leadingStartDate,\r\n          info,\r\n          originalStep,\r\n          activityNumber,\r\n          editable,\r\n          confPreStart,\r\n          confPast,\r\n          sort,\r\n        } = orderActivities[orderNumber + \"-\" + activityNo];\r\n\r\n        const { descriptionShort, descriptionShort14 } =\r\n          activities[activityNo] || {};\r\n\r\n        const description = orderActivities[orderNumber + \"-7030\"]\r\n          ? descriptionShort14\r\n            ? descriptionShort14\r\n            : descriptionShort\r\n          : descriptionShort;\r\n\r\n        let authOrderActivities = {\r\n          auth,\r\n          orderActivities,\r\n          documentList,\r\n          templates,\r\n        };\r\n\r\n        let ownprops = {\r\n          activityNumber,\r\n          orderNumber,\r\n          projectNumber,\r\n        };\r\n\r\n        const isExecutable = publicFn.DatePermissionControl(\r\n          authOrderActivities,\r\n          ownprops\r\n        );\r\n\r\n        if (\r\n          orderActivities[orderNumber + \"-\" + activityNo].editable !==\r\n          undefined &&\r\n          orderActivities[orderNumber + \"-\" + activityNo].editable === false\r\n        ) {\r\n          confirmedDate ? (info = \"节点已确认\") : (info = \"节点可确认\");\r\n        }\r\n\r\n        filteredOrderActivitiesData.push({\r\n          activityNumber: activityNo,\r\n          confirmedDate: confirmedDate\r\n            ? new Date(confirmedDate).toLocaleDateString()\r\n            : \"-\",\r\n          description: description,\r\n          leadingDate: leadingDate\r\n            ? new Date(leadingDate).toLocaleDateString()\r\n            : leadingStartDate && leadingEndDate\r\n              ? new Date(leadingEndDate).toLocaleDateString()\r\n              : \"-\",\r\n          info: info || \"-\",\r\n          orderNumber: orderNumber,\r\n          productFamily,\r\n          originalStep,\r\n          editable,\r\n          isExecutable,\r\n          hint: getHint(isExecutable),\r\n          confPreStart,\r\n          confPast,\r\n          sort,\r\n        });\r\n      }\r\n    });\r\n\r\n  const allOrderActivitiesData = [];\r\n\r\n  publicFn\r\n    .allOrderDetailSteps(\r\n      orderActivities,\r\n      orderNumber,\r\n      auth.activityAuth,\r\n      auth.roles[0]\r\n    )\r\n    .forEach((activityNo) => {\r\n      if (orderActivities[orderNumber + \"-\" + activityNo]) {\r\n        let {\r\n          confirmedDate,\r\n          leadingDate,\r\n          leadingEndDate,\r\n          leadingStartDate,\r\n          activityNumber,\r\n          info,\r\n          sort,\r\n        } = orderActivities[orderNumber + \"-\" + activityNo] || {};\r\n\r\n        const { descriptionShort, descriptionShort14 } =\r\n          activities[activityNo] || {};\r\n\r\n        const description = orderActivities[orderNumber + \"-7030\"]\r\n          ? descriptionShort14\r\n            ? descriptionShort14\r\n            : descriptionShort\r\n          : descriptionShort;\r\n\r\n        let authOrderActivities = {\r\n          auth,\r\n          orderActivities,\r\n          documentList,\r\n          templates,\r\n        };\r\n\r\n        let ownprops = {\r\n          activityNumber,\r\n          orderNumber,\r\n          projectNumber,\r\n        };\r\n\r\n        const isExecutable = publicFn.DatePermissionControl(\r\n          authOrderActivities,\r\n          ownprops\r\n        );\r\n\r\n        if (\r\n          orderActivities[orderNumber + \"-\" + activityNo].editable !==\r\n          undefined &&\r\n          orderActivities[orderNumber + \"-\" + activityNo].editable === false\r\n        ) {\r\n          confirmedDate ? (info = \"节点已确认\") : (info = \"节点可确认\");\r\n        }\r\n\r\n        allOrderActivitiesData.push({\r\n          activityNumber: activityNo,\r\n          confirmedDate: confirmedDate\r\n            ? new Date(confirmedDate).toLocaleDateString()\r\n            : \"-\",\r\n          description: description,\r\n          leadingDate: leadingDate\r\n            ? new Date(leadingDate).toLocaleDateString()\r\n            : leadingStartDate && leadingEndDate\r\n              ? new Date(leadingEndDate).toLocaleDateString()\r\n              : \"-\",\r\n          info: info || \"-\",\r\n          orderNumber: orderNumber,\r\n          productFamily,\r\n          isExecutable,\r\n          sort,\r\n        });\r\n      }\r\n    });\r\n\r\n  const progress = util.orderProgress(orderActivities, orderNumber);\r\n  const whetherToShutDown = util.whetherToShutDown(\r\n    orderActivities,\r\n    orderNumber\r\n  );\r\n\r\n  const methods =\r\n    wayToInstallList[\r\n    orders?.[orderNumber]?.productLine +\r\n    \"-\" +\r\n    orders?.[orderNumber]?.productFamily\r\n    ];\r\n\r\n  const methodsList =\r\n    methods &&\r\n    Object.keys(methods.installationMethods).map((item) => {\r\n      return { label: methods.installationMethods[item], value: item };\r\n    });\r\n\r\n  const defaultselectValue =\r\n    orderInstallationMethods?.[orderNumber]?.installationMethod;\r\n  const defaultSelectInstalltion = methodsList?.filter((item) => {\r\n    return item.value === defaultselectValue.toString();\r\n  })[0]?.label;\r\n\r\n  const unitDesignation = orders[orderNumber]?.unitDesignation;\r\n\r\n  return {\r\n    showInstallations: true,\r\n    orderNumber,\r\n    data: {\r\n      projectNumber,\r\n      fitterQuantity: 5,\r\n      orderQuantity: Object.keys(orders).filter((key) => {\r\n        return orders[key].projectNumber === projectNumber;\r\n      }).length,\r\n      projectName,\r\n      teamLeader,\r\n      PM,\r\n      orderNumber,\r\n      productFamily,\r\n      productFamilyName,\r\n      installMethod: defaultSelectInstalltion,\r\n      installMethods: methodsList,\r\n      defaultselectValue,\r\n      elevatorProgress: progress + \"%\",\r\n      filteredOrderActivities: filteredOrderActivitiesData,\r\n      allOrderActivities: allOrderActivitiesData,\r\n      unitDesignation,\r\n    },\r\n    projectNumber,\r\n    orderActivities,\r\n    confPreStart: orderActivities,\r\n    confPast: orderActivities,\r\n    orders,\r\n    whetherToShutDown,\r\n    defaultTab,\r\n    documentList,\r\n  };\r\n};\r\n\r\nconst mapDispatchToState = (dispatch) => {\r\n  return {\r\n    submit: (\r\n      activityNumber,\r\n      orderNumber,\r\n      projectNumber,\r\n      date,\r\n      type,\r\n      orderActivities,\r\n      orders\r\n    ) => {\r\n      if (\r\n        util.isInstallationStepEditable(\r\n          orderNumber,\r\n          activityNumber,\r\n          orderActivities\r\n        )\r\n      ) {\r\n        const data = util.setActivityStatusParams(\r\n          projectNumber,\r\n          orderNumber,\r\n          activityNumber,\r\n          date,\r\n          type,\r\n          orderActivities,\r\n          orders\r\n        );\r\n        dispatch(action.updateOrderActivityStatus(data));\r\n      } else {\r\n        const data = {\r\n          projectNo: projectNumber,\r\n          orderNo: orderNumber,\r\n          stepNo: activityNumber,\r\n          confirmedDate: date,\r\n        };\r\n        dispatch(action.updateLocalInstallationStepConfirmDate(data));\r\n      };\r\n\r\n    },\r\n  };\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToState)(OrderDetailPage);\r\n"]},"metadata":{},"sourceType":"module"}