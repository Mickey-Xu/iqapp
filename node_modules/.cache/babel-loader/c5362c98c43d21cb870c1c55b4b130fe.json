{"ast":null,"code":"import _slicedToArray from\"C:\\\\project\\\\SCF-NI_PM_App\\\\SCF.InstallationQuality\\\\react-client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";import{Box,FormLabel,makeStyles,Typography}from\"@material-ui/core\";import Compressor from\"compressorjs\";import{LocalizeContext}from\"i18n\";import{fillTextToImg}from\"js/util\";import React,{useRef,useState}from\"react\";import{useParams}from'react-router-dom';import Camera from\"../../Camera\";var useStyles=makeStyles(function(_ref){var spacing=_ref.spacing;return{btm:{display:\"flex\",justifyContent:\"space-between\",margin:spacing(1,1,0,1)},root:{display:\"grid\",padding:spacing(1,0),borderBottom:\" 1px solid #e0e0e0\",backgroundColor:\"#FFF\"},lable:{margin:spacing(0,0,1,0),color:\"rgba(0, 0, 0, 0.87)\"},inputFile:{width:\"0.1px\",height:\"0.1px\",opacity:0,overflow:\"hidden\",position:\"absolute\",top:\"0\",zIndex:-1},file:{height:\"160px\",position:\"relative\",overflow:\"hidden\",textAlign:\"center\"}};});export var Photo=function Photo(props){var i18n=React.useContext(LocalizeContext);var classes=useStyles();var _useState=useState({width:\"auto\",height:\"100%\"}),_useState2=_slicedToArray(_useState,2),photoStyle=_useState2[0],setPhotoStyle=_useState2[1];var photoEl=useRef(null);var iptRef=useRef(null);var projectData=useParams();var showWatermark=(projectData===null||projectData===void 0?void 0:projectData.activityNo)===\"7030\"&&((props===null||props===void 0?void 0:props.identifier)===\"photoJ\"||(props===null||props===void 0?void 0:props.identifier)===\"photoP\");var onPhotoChange=function onPhotoChange(e,type){var _e$target,_e$target$files;var fileReader=new FileReader();var file=e===null||e===void 0?void 0:(_e$target=e.target)===null||_e$target===void 0?void 0:(_e$target$files=_e$target.files)===null||_e$target$files===void 0?void 0:_e$target$files[0];if(type===\"camera\"){if(showWatermark){fillTextToImg(e,projectData).then(function(res){props.onChange(res);});}else{props.onChange(e);}}else{fileReader.onloadend=function(e){var photo=e.target.result;if(showWatermark){fillTextToImg(photo,projectData).then(function(res){props.onChange(res);});}else{props.onChange(photo);}var i=new Image();i.onload=function(){setPhotoStyle({// width: photoEl.current.clientWidth,\n// height: (photoEl.current.clientWidth / i.width) * i.height,\nwidth:\"auto\",height:\"100%\"});};i.src=photo;};}if(file||e){new Compressor(file,{quality:0.2,convertSize:400000,success:function success(result){fileReader.readAsDataURL(result);},error:function error(err){console.log(err.message);}});}else{props.onChange(\"#\");}};return/*#__PURE__*/React.createElement(\"div\",{className:classes.root},/*#__PURE__*/React.createElement(Typography,{variant:\"subtitle2\",className:classes.lable},props.label),/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"input\",{className:classes.inputFile,type:\"file\",accept:\"image/x-png,image/jpeg,image/gif\"// accept=\"image/*\"\n// capture=\"user\"\n,id:props.id,ref:iptRef,onChange:onPhotoChange})),/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(FormLabel,{required:props.required},/*#__PURE__*/React.createElement(Typography,{component:\"span\",variant:\"subtitle2\",className:classes.lable},props.description))),/*#__PURE__*/React.createElement(Box,{border:1,className:classes.file},/*#__PURE__*/React.createElement(\"img\",{src:props.value,style:photoStyle,ref:photoEl,alt:\"\"})),/*#__PURE__*/React.createElement(Box,{className:classes.btm},/*#__PURE__*/React.createElement(Typography,{color:\"secondary\",variant:\"body2\",onClick:function onClick(){props.onChange(\"#\");iptRef.current.value=\"\";}},i18n.ISNTAPP_DELETE),/*#__PURE__*/React.createElement(\"label\",{htmlFor:props.id},!showWatermark&&/*#__PURE__*/React.createElement(Typography,{color:\"secondary\",variant:\"body2\"},i18n.ISNTAPP_IMPORT_PICTURES)),showWatermark&&/*#__PURE__*/React.createElement(Camera,{onChange:function onChange(photo){return onPhotoChange(photo,'camera');},showCameraFrame:showWatermark})));};","map":{"version":3,"sources":["C:/project/SCF-NI_PM_App/SCF.InstallationQuality/react-client/src/components/TemplateForm/Photo/index.js"],"names":["Box","FormLabel","makeStyles","Typography","Compressor","LocalizeContext","fillTextToImg","React","useRef","useState","useParams","Camera","useStyles","spacing","btm","display","justifyContent","margin","root","padding","borderBottom","backgroundColor","lable","color","inputFile","width","height","opacity","overflow","position","top","zIndex","file","textAlign","Photo","props","i18n","useContext","classes","photoStyle","setPhotoStyle","photoEl","iptRef","projectData","showWatermark","activityNo","identifier","onPhotoChange","e","type","fileReader","FileReader","target","files","then","res","onChange","onloadend","photo","result","i","Image","onload","src","quality","convertSize","success","readAsDataURL","error","err","console","log","message","label","id","required","description","value","current","ISNTAPP_DELETE","ISNTAPP_IMPORT_PICTURES"],"mappings":"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","sourcesContent":["import { Box, FormLabel, makeStyles, Typography } from \"@material-ui/core\";\r\nimport Compressor from \"compressorjs\";\r\nimport { LocalizeContext } from \"i18n\";\r\nimport { fillTextToImg } from \"js/util\";\r\nimport React, { useRef, useState } from \"react\";\r\nimport { useParams } from 'react-router-dom';\r\nimport Camera from \"../../Camera\"\r\n\r\nconst useStyles = makeStyles(({ spacing }) => ({\r\n  btm: {\r\n    display: \"flex\",\r\n    justifyContent: \"space-between\",\r\n    margin: spacing(1, 1, 0, 1),\r\n  },\r\n  root: {\r\n    display: \"grid\",\r\n    padding: spacing(1, 0),\r\n    borderBottom: \" 1px solid #e0e0e0\",\r\n    backgroundColor: \"#FFF\",\r\n  },\r\n  lable: {\r\n    margin: spacing(0, 0, 1, 0),\r\n    color: \"rgba(0, 0, 0, 0.87)\",\r\n  },\r\n  inputFile: {\r\n    width: \"0.1px\",\r\n    height: \"0.1px\",\r\n    opacity: 0,\r\n    overflow: \"hidden\",\r\n    position: \"absolute\",\r\n    top: \"0\",\r\n    zIndex: -1,\r\n  },\r\n  file: {\r\n    height: \"160px\",\r\n    position: \"relative\",\r\n    overflow: \"hidden\",\r\n    textAlign: \"center\",\r\n  },\r\n}));\r\n\r\nexport const Photo = (props) => {\r\n  const i18n = React.useContext(LocalizeContext);\r\n  const classes = useStyles();\r\n  const [photoStyle, setPhotoStyle] = useState({\r\n    width: \"auto\",\r\n    height: \"100%\",\r\n  });\r\n  const photoEl = useRef(null);\r\n  const iptRef = useRef(null);\r\n  const projectData = useParams();\r\n  const showWatermark = projectData?.activityNo === \"7030\" && (props?.identifier === \"photoJ\" || props?.identifier === \"photoP\")\r\n  const onPhotoChange = (e, type) => {\r\n    const fileReader = new FileReader();\r\n    const file = e?.target?.files?.[0];\r\n\r\n    if (type === \"camera\") {\r\n      if (showWatermark) {\r\n        fillTextToImg(e, projectData).then((res) => {\r\n          props.onChange(res);\r\n        })\r\n      } else {\r\n        props.onChange(e);\r\n      }\r\n    } else {\r\n      fileReader.onloadend = (e) => {\r\n        const photo = e.target.result;\r\n        if (showWatermark) {\r\n          fillTextToImg(photo, projectData).then((res) => {\r\n            props.onChange(res);\r\n          })\r\n        } else {\r\n          props.onChange(photo);\r\n        }\r\n\r\n        const i = new Image();\r\n        i.onload = () => {\r\n          setPhotoStyle({\r\n            // width: photoEl.current.clientWidth,\r\n            // height: (photoEl.current.clientWidth / i.width) * i.height,\r\n            width: \"auto\",\r\n            height: \"100%\",\r\n          });\r\n        };\r\n        i.src = photo;\r\n      };\r\n\r\n    }\r\n\r\n \r\n    if (file||e) {\r\n      new Compressor(file, {\r\n        quality: 0.2,\r\n        convertSize: 400000,\r\n        success(result) {\r\n          fileReader.readAsDataURL(result);\r\n        },\r\n        error(err) {\r\n          console.log(err.message);\r\n        },\r\n      });\r\n    } else {\r\n      props.onChange(\"#\");\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className={classes.root}>\r\n      <Typography variant=\"subtitle2\" className={classes.lable}>\r\n        {props.label}\r\n      </Typography>\r\n      <div>\r\n        <input\r\n          className={classes.inputFile}\r\n          type=\"file\"\r\n          accept=\"image/x-png,image/jpeg,image/gif\"\r\n          // accept=\"image/*\"\r\n          // capture=\"user\"\r\n          id={props.id}\r\n          ref={iptRef}\r\n          onChange={onPhotoChange}\r\n        />\r\n      </div>\r\n      <div>\r\n        {/* <Typography variant=\"body2\">{props.description}</Typography> */}\r\n        <FormLabel required={props.required}>\r\n          <Typography\r\n            component=\"span\"\r\n            variant=\"subtitle2\"\r\n            className={classes.lable}\r\n          >\r\n            {props.description}\r\n          </Typography>\r\n        </FormLabel>\r\n      </div>\r\n      <Box border={1} className={classes.file}>\r\n        <img src={props.value} style={photoStyle} ref={photoEl} alt=\"\" />\r\n      </Box>\r\n      <Box className={classes.btm}>\r\n        <Typography\r\n          color=\"secondary\"\r\n          variant=\"body2\"\r\n          onClick={() => {\r\n            props.onChange(\"#\");\r\n            iptRef.current.value = \"\";\r\n          }}\r\n        >\r\n          {i18n.ISNTAPP_DELETE}\r\n        </Typography>\r\n        <label htmlFor={props.id}>\r\n          {!showWatermark && <Typography color=\"secondary\" variant=\"body2\">\r\n            {i18n.ISNTAPP_IMPORT_PICTURES}\r\n          </Typography>\r\n          }  \r\n        </label>\r\n        {showWatermark && (\r\n          <Camera onChange={(photo) => onPhotoChange(photo, 'camera')}\r\n            showCameraFrame={showWatermark}\r\n          />\r\n        )}\r\n      </Box>\r\n    </div>\r\n  );\r\n};\r\n"]},"metadata":{},"sourceType":"module"}