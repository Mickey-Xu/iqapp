{"ast":null,"code":"import _slicedToArray from\"C:\\\\project\\\\SCF-NI_PM_App\\\\SCF.InstallationQuality\\\\react-client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";import{Box}from\"@material-ui/core\";import ProjectItemList from\"components/ProjectItemList\";import ProjectSearchBar from\"components/ProjectSearchBar\";import SwitchActivityNumber from\"components/SwitchActivityNumber\";import{LocalizeContext}from\"i18n\";import PrimaryLayout from\"layouts/PrimaryLayout\";import React,{useEffect,useState}from\"react\";import{connect}from\"react-redux\";var ProjectInstallationStepsPage=function ProjectInstallationStepsPage(_ref){var data=_ref.data,projectNumber=_ref.projectNumber,activityNumberList=_ref.activityNumberList,activityNumberAndUnitDesignationMapping=_ref.activityNumberAndUnitDesignationMapping;var i18n=React.useContext(LocalizeContext);var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),searchValue=_useState2[0],setSearchValue=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),selectedActivityNumber=_useState4[0],setSelectedActivityNumber=_useState4[1];data=data.filter(function(item){return item.activityNumber===selectedActivityNumber;});data=searchValue?data.filter(function(item){var _item$orderNumber,_item$installationMet;return((_item$orderNumber=item.orderNumber)===null||_item$orderNumber===void 0?void 0:_item$orderNumber.indexOf(searchValue))>-1||((_item$installationMet=item.installationMethod)===null||_item$installationMet===void 0?void 0:_item$installationMet.indexOf(searchValue))>-1;}):data;var useInitSelectedActivityNumber=function useInitSelectedActivityNumber(){useEffect(function(){setSelectedActivityNumber(activityNumberList.length>0?activityNumberList[0]:\"7010\");},[]);};useInitSelectedActivityNumber();return/*#__PURE__*/React.createElement(PrimaryLayout,{title:\"\".concat(i18n.ISNTAPP_PROJECT_PROGRESS,\": \").concat(projectNumber)},/*#__PURE__*/React.createElement(Box,{style:{padding:\"14px\"}},/*#__PURE__*/React.createElement(ProjectSearchBar,{placeholder:i18n.ISNTAPP_SEARCH_ORDER,onChange:function onChange(value){setSearchValue(value);}}),/*#__PURE__*/React.createElement(Box,{style:{margin:\"10px 0\"}},/*#__PURE__*/React.createElement(SwitchActivityNumber,{projectNumber:projectNumber,isInstallationStep:true,initValue:activityNumberList.length>0?activityNumberList[0]:\"7010\",activityNumberList:activityNumberList,activityNumberAndUnitDesignationMapping:activityNumberAndUnitDesignationMapping,onChange:function onChange(value){setSelectedActivityNumber(value);}})),/*#__PURE__*/React.createElement(ProjectItemList,{data:data})));};var mapStateToProps=function mapStateToProps(_ref2,_ref3){var orderActivities=_ref2.orderActivities,orders=_ref2.orders,orderInstallationMethods=_ref2.orderInstallationMethods,productFamilies=_ref2.productFamilies,activities=_ref2.activities,wayToInstallList=_ref2.wayToInstallList;var match=_ref3.match;var projectNumber=match.params.projectNumber;var activityNumberAndUnitDesignationMapping={};var data=[];var activityNumberList=[\"7010\",\"7020\",\"7030\",\"7040\",\"7050\",\"7060\",\"7070\",\"7080\",\"7090\",\"70A0\",\"70B0\",\"70C0\",\"70D0\",\"7600\"];activityNumberList.forEach(function(number){var _activities$number;activityNumberAndUnitDesignationMapping[number]=(_activities$number=activities[number])===null||_activities$number===void 0?void 0:_activities$number.descriptionShort;});var ordersOfThisProject=Object.keys(orders).filter(function(order){return orders[order].projectNumber===projectNumber;});for(var i=0;i<ordersOfThisProject.length;i++){var _wayToInstallList$pro,_wayToInstallList$pro2;var installationMethodCode=orderInstallationMethods[ordersOfThisProject[i]].installationMethod;var productLine=orders[ordersOfThisProject[i]].productLine;var installationMethodName=(_wayToInstallList$pro=wayToInstallList[productLine])===null||_wayToInstallList$pro===void 0?void 0:(_wayToInstallList$pro2=_wayToInstallList$pro.installationMethods)===null||_wayToInstallList$pro2===void 0?void 0:_wayToInstallList$pro2[installationMethodCode];for(var j=0;j<activityNumberList.length;j++){var orderActivity=orderActivities[ordersOfThisProject[i]+\"-\"+activityNumberList[j]];if(orderActivity){var confirmedDateFormatter=orderActivity.confirmedDate?new Date(orderActivity.confirmedDate).toLocaleDateString():\"-\";var leadingDateFormatter=orderActivity.leadingDate?new Date(orderActivity.leadingDate).toLocaleDateString():orderActivity.leadingStartDate&&orderActivity.leadingEndDate?new Date(orderActivity.leadingEndDate).toLocaleDateString():\"-\";data.push({unitDesignation:orders[ordersOfThisProject[i]].unitDesignation,productFamily:productFamilies[orders[ordersOfThisProject[i]].productFamily].name,installationMethod:installationMethodName,ConfirmDate:confirmedDateFormatter,PlanDate:leadingDateFormatter,orderNumber:ordersOfThisProject[i],activityNumber:activityNumberList[j]});}}}return{data:data,projectNumber:projectNumber,activityNumberList:activityNumberList,activityNumberAndUnitDesignationMapping:activityNumberAndUnitDesignationMapping};};export default connect(mapStateToProps)(ProjectInstallationStepsPage);","map":{"version":3,"sources":["C:/project/SCF-NI_PM_App/SCF.InstallationQuality/react-client/src/pages/ProjectInstallationStepsPage/index.js"],"names":["Box","ProjectItemList","ProjectSearchBar","SwitchActivityNumber","LocalizeContext","PrimaryLayout","React","useEffect","useState","connect","ProjectInstallationStepsPage","data","projectNumber","activityNumberList","activityNumberAndUnitDesignationMapping","i18n","useContext","searchValue","setSearchValue","selectedActivityNumber","setSelectedActivityNumber","filter","item","activityNumber","orderNumber","indexOf","installationMethod","useInitSelectedActivityNumber","length","ISNTAPP_PROJECT_PROGRESS","padding","ISNTAPP_SEARCH_ORDER","value","margin","mapStateToProps","orderActivities","orders","orderInstallationMethods","productFamilies","activities","wayToInstallList","match","params","forEach","number","descriptionShort","ordersOfThisProject","Object","keys","order","i","installationMethodCode","productLine","installationMethodName","installationMethods","j","orderActivity","confirmedDateFormatter","confirmedDate","Date","toLocaleDateString","leadingDateFormatter","leadingDate","leadingStartDate","leadingEndDate","push","unitDesignation","productFamily","name","ConfirmDate","PlanDate"],"mappings":"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","sourcesContent":["import { Box } from \"@material-ui/core\";\r\nimport ProjectItemList from \"components/ProjectItemList\";\r\nimport ProjectSearchBar from \"components/ProjectSearchBar\";\r\nimport SwitchActivityNumber from \"components/SwitchActivityNumber\";\r\nimport { LocalizeContext } from \"i18n\";\r\nimport PrimaryLayout from \"layouts/PrimaryLayout\";\r\nimport React, { useEffect, useState } from \"react\";\r\nimport { connect } from \"react-redux\";\r\n\r\nconst ProjectInstallationStepsPage = ({\r\n  data,\r\n  projectNumber,\r\n  activityNumberList,\r\n  activityNumberAndUnitDesignationMapping,\r\n}) => {\r\n  const i18n = React.useContext(LocalizeContext);\r\n\r\n  const [searchValue, setSearchValue] = useState(\"\");\r\n  const [selectedActivityNumber, setSelectedActivityNumber] = useState(\"\");\r\n\r\n  data = data.filter((item) => {\r\n    return item.activityNumber === selectedActivityNumber;\r\n  });\r\n\r\n  data = searchValue\r\n    ? data.filter((item) => {\r\n        return (\r\n          item.orderNumber?.indexOf(searchValue) > -1 ||\r\n          item.installationMethod?.indexOf(searchValue) > -1\r\n        );\r\n      })\r\n    : data;\r\n\r\n  const useInitSelectedActivityNumber = () => {\r\n    useEffect(() => {\r\n      setSelectedActivityNumber(\r\n        activityNumberList.length > 0 ? activityNumberList[0] : \"7010\"\r\n      );\r\n    }, []);\r\n  };\r\n\r\n  useInitSelectedActivityNumber();\r\n\r\n  return (\r\n    <PrimaryLayout title={`${i18n.ISNTAPP_PROJECT_PROGRESS}: ${projectNumber}`}>\r\n      <Box style={{ padding: \"14px\" }}>\r\n        <ProjectSearchBar\r\n          placeholder={i18n.ISNTAPP_SEARCH_ORDER}\r\n          onChange={(value) => {\r\n            setSearchValue(value);\r\n          }}\r\n        />\r\n        <Box style={{ margin: \"10px 0\" }}>\r\n          <SwitchActivityNumber\r\n            projectNumber={projectNumber}\r\n            isInstallationStep={true}\r\n            initValue={\r\n              activityNumberList.length > 0 ? activityNumberList[0] : \"7010\"\r\n            }\r\n            activityNumberList={activityNumberList}\r\n            activityNumberAndUnitDesignationMapping={\r\n              activityNumberAndUnitDesignationMapping\r\n            }\r\n            onChange={(value) => {\r\n              setSelectedActivityNumber(value);\r\n            }}\r\n          />\r\n        </Box>\r\n        <ProjectItemList data={data} />\r\n      </Box>\r\n    </PrimaryLayout>\r\n  );\r\n};\r\n\r\nconst mapStateToProps = (\r\n  {\r\n    orderActivities,\r\n    orders,\r\n    orderInstallationMethods,\r\n    productFamilies,\r\n    activities,\r\n    wayToInstallList,\r\n  },\r\n  { match }\r\n) => {\r\n  const { projectNumber } = match.params;\r\n  const activityNumberAndUnitDesignationMapping = {};\r\n\r\n  const data = [];\r\n\r\n  const activityNumberList = [\r\n    \"7010\",\r\n    \"7020\",\r\n    \"7030\",\r\n    \"7040\",\r\n    \"7050\",\r\n    \"7060\",\r\n    \"7070\",\r\n    \"7080\",\r\n    \"7090\",\r\n    \"70A0\",\r\n    \"70B0\",\r\n    \"70C0\",\r\n    \"70D0\",\r\n    \"7600\",\r\n  ];\r\n\r\n  activityNumberList.forEach((number) => {\r\n    activityNumberAndUnitDesignationMapping[number] =\r\n      activities[number]?.descriptionShort;\r\n  });\r\n\r\n  const ordersOfThisProject = Object.keys(orders).filter((order) => {\r\n    return orders[order].projectNumber === projectNumber;\r\n  });\r\n\r\n  for (let i = 0; i < ordersOfThisProject.length; i++) {\r\n    const installationMethodCode =\r\n      orderInstallationMethods[ordersOfThisProject[i]].installationMethod;\r\n    const productLine = orders[ordersOfThisProject[i]].productLine;\r\n    const installationMethodName =\r\n      wayToInstallList[productLine]?.installationMethods?.[\r\n        installationMethodCode\r\n      ];\r\n\r\n    for (let j = 0; j < activityNumberList.length; j++) {\r\n      const orderActivity =\r\n        orderActivities[ordersOfThisProject[i] + \"-\" + activityNumberList[j]];\r\n\r\n      if (orderActivity) {\r\n        const confirmedDateFormatter = orderActivity.confirmedDate\r\n          ? new Date(orderActivity.confirmedDate).toLocaleDateString()\r\n          : \"-\";\r\n        const leadingDateFormatter = orderActivity.leadingDate\r\n          ? new Date(orderActivity.leadingDate).toLocaleDateString()\r\n          : orderActivity.leadingStartDate && orderActivity.leadingEndDate\r\n          ? new Date(orderActivity.leadingEndDate).toLocaleDateString()\r\n          : \"-\";\r\n\r\n        data.push({\r\n          unitDesignation: orders[ordersOfThisProject[i]].unitDesignation,\r\n          productFamily:\r\n            productFamilies[orders[ordersOfThisProject[i]].productFamily].name,\r\n          installationMethod: installationMethodName,\r\n          ConfirmDate: confirmedDateFormatter,\r\n          PlanDate: leadingDateFormatter,\r\n          orderNumber: ordersOfThisProject[i],\r\n          activityNumber: activityNumberList[j],\r\n        });\r\n      }\r\n    }\r\n  }\r\n\r\n  return {\r\n    data,\r\n    projectNumber,\r\n    activityNumberList,\r\n    activityNumberAndUnitDesignationMapping,\r\n  };\r\n};\r\n\r\nexport default connect(mapStateToProps)(ProjectInstallationStepsPage);\r\n"]},"metadata":{},"sourceType":"module"}