{"ast":null,"code":"import{Box,makeStyles}from\"@material-ui/core\";import*as action from\"actions\";import ActivityList from\"components/ActivityList\";import CheckforUpdates from\"components/CheckforUpdates\";import FFTab from\"components/FFTab\";import{LocalizeContext}from\"i18n\";import*as repo from\"js/fetch\";import{scrollToPosition}from\"js/util\";import PrimaryLayout from\"layouts/PrimaryLayout\";import React,{useEffect,useRef}from\"react\";import{connect}from\"react-redux\";import{useLocation}from\"react-router-dom\";var useStyles=makeStyles(function(_ref){var theme=_ref.theme,spacing=_ref.spacing;return{main:{backgroundColor:\"#f3f3f3\",padding:6,position:\"absolute\",top:spacing(6),height:window.screen.height-173+\"px\",width:\"100%\",overflow:\"hidden auto\"}};});var ActivityListPage=function ActivityListPage(_ref2){var timeHorizon=_ref2.timeHorizon,setTimeHorizon=_ref2.setTimeHorizon,historyPage=_ref2.historyPage,serviceWorkerRegistration=_ref2.serviceWorkerRegistration,isServiceWorkerUpdated=_ref2.isServiceWorkerUpdated;var i18n=React.useContext(LocalizeContext);var classes=useStyles();var scrollRef=useRef(null);var location=useLocation();useEffect(function(){setTimeout(function(){scrollToPosition(scrollRef,location.pathname);},1000);},[location.pathname]);var tabs=[{title:i18n.COCKPIT_FILTER_NONE,value:\"all\"},{title:i18n.COCKPIT_FILTER_THISWEEK,value:\"thisWeek\"},{title:\"2 \"+i18n.INSTALLATION_WEEKS,value:\"twoWeeks\"},{title:\"4 \"+i18n.INSTALLATION_WEEKS,value:\"fourWeeks\"},{title:\"8 \"+i18n.INSTALLATION_WEEKS,value:\"eightWeeks\"}];var updateServiceWorker=function updateServiceWorker(){var registrationWaiting=serviceWorkerRegistration.waiting;if(registrationWaiting){registrationWaiting.postMessage({type:\"SKIP_WAITING\"});registrationWaiting.addEventListener(\"statechange\",function(e){if(e.target.state===\"activated\"){window.localStorage.removeItem(\"versionUpdating\");window.location.reload();}});}};return/*#__PURE__*/React.createElement(PrimaryLayout,{name:\"activities\",title:i18n.INSTAPP_JOBLIST_ACTIVITY_COCKPIT,pageLevel:1},/*#__PURE__*/React.createElement(Box,{style:{width:\"100%\",position:\"fixed\",zIndex:\"100\",backgroundColor:\"#fafafa\",height:\"48px\"}},/*#__PURE__*/React.createElement(FFTab,{tabs:tabs,selectedTabValue:timeHorizon,onTabChange:function onTabChange(value){return setTimeHorizon(value);}})),/*#__PURE__*/React.createElement(\"div\",{className:classes.main,ref:scrollRef},/*#__PURE__*/React.createElement(ActivityList,null)),/*#__PURE__*/React.createElement(\"div\",null,historyPage===\"loginPage\"&&isServiceWorkerUpdated&&/*#__PURE__*/React.createElement(CheckforUpdates,{type:\"SW_UPDATE\",page:\"activity\",open:isServiceWorkerUpdated,onClick:updateServiceWorker})));};var mapStateToPops=function mapStateToPops(state,ownProps){var timeHorizon=state.timeHorizon,settings=state.settings,_state$versionUpdatin=state.versionUpdating,serviceWorkerUpdated=_state$versionUpdatin.serviceWorkerUpdated,serviceWorkerRegistration=_state$versionUpdatin.serviceWorkerRegistration;var historyPage=settings.historyPage?settings.historyPage:\"\";return{timeHorizon:timeHorizon,historyPage:historyPage,isServiceWorkerUpdated:serviceWorkerUpdated,serviceWorkerRegistration:serviceWorkerRegistration};};var mapDispatchToState=function mapDispatchToState(dispatch){return{refresh:function refresh(){dispatch(action.fetchAll(repo.type.CACHE));},setTimeHorizon:function setTimeHorizon(timeHorizon){dispatch(action.setTimeHorizon(timeHorizon));},setScrollPosition:function setScrollPosition(data){dispatch(action.setScrollPosition(data));}};};export default connect(mapStateToPops,mapDispatchToState)(ActivityListPage);","map":{"version":3,"sources":["C:/project/SCF-NI_PM_App/SCF.InstallationQuality/react-client/src/pages/ActivityListPage/index.js"],"names":["Box","makeStyles","action","ActivityList","CheckforUpdates","FFTab","LocalizeContext","repo","scrollToPosition","PrimaryLayout","React","useEffect","useRef","connect","useLocation","useStyles","theme","spacing","main","backgroundColor","padding","position","top","height","window","screen","width","overflow","ActivityListPage","timeHorizon","setTimeHorizon","historyPage","serviceWorkerRegistration","isServiceWorkerUpdated","i18n","useContext","classes","scrollRef","location","setTimeout","pathname","tabs","title","COCKPIT_FILTER_NONE","value","COCKPIT_FILTER_THISWEEK","INSTALLATION_WEEKS","updateServiceWorker","registrationWaiting","waiting","postMessage","type","addEventListener","e","target","state","localStorage","removeItem","reload","INSTAPP_JOBLIST_ACTIVITY_COCKPIT","zIndex","mapStateToPops","ownProps","settings","versionUpdating","serviceWorkerUpdated","mapDispatchToState","dispatch","refresh","fetchAll","CACHE","setScrollPosition","data"],"mappings":"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","sourcesContent":["import { Box, makeStyles } from \"@material-ui/core\";\r\nimport * as action from \"actions\";\r\nimport ActivityList from \"components/ActivityList\";\r\nimport CheckforUpdates from \"components/CheckforUpdates\";\r\nimport FFTab from \"components/FFTab\";\r\nimport { LocalizeContext } from \"i18n\";\r\nimport * as repo from \"js/fetch\";\r\nimport { scrollToPosition } from \"js/util\";\r\nimport PrimaryLayout from \"layouts/PrimaryLayout\";\r\nimport React, { useEffect, useRef } from \"react\";\r\nimport { connect } from \"react-redux\";\r\nimport { useLocation } from \"react-router-dom\";\r\n\r\nconst useStyles = makeStyles(({ theme, spacing }) => ({\r\n  main: {\r\n    backgroundColor: \"#f3f3f3\",\r\n    padding: 6,\r\n    position: \"absolute\",\r\n    top: spacing(6),\r\n    height: window.screen.height - 173 + \"px\",\r\n    width: \"100%\",\r\n    overflow: \"hidden auto\",\r\n  },\r\n}));\r\n\r\nconst ActivityListPage = ({\r\n  timeHorizon,\r\n  setTimeHorizon,\r\n  historyPage,\r\n  serviceWorkerRegistration,\r\n  isServiceWorkerUpdated,\r\n}) => {\r\n  const i18n = React.useContext(LocalizeContext);\r\n  const classes = useStyles();\r\n  const scrollRef = useRef(null);\r\n  const location = useLocation();\r\n\r\n  useEffect(() => {\r\n    setTimeout(() => {\r\n      scrollToPosition(scrollRef, location.pathname);\r\n    }, 1000);\r\n  }, [location.pathname]);\r\n\r\n  const tabs = [\r\n    { title: i18n.COCKPIT_FILTER_NONE, value: \"all\" },\r\n    { title: i18n.COCKPIT_FILTER_THISWEEK, value: \"thisWeek\" },\r\n    { title: \"2 \" + i18n.INSTALLATION_WEEKS, value: \"twoWeeks\" },\r\n    { title: \"4 \" + i18n.INSTALLATION_WEEKS, value: \"fourWeeks\" },\r\n    { title: \"8 \" + i18n.INSTALLATION_WEEKS, value: \"eightWeeks\" },\r\n  ];\r\n\r\n  const updateServiceWorker = () => {\r\n    const registrationWaiting = serviceWorkerRegistration.waiting;\r\n    if (registrationWaiting) {\r\n      registrationWaiting.postMessage({ type: \"SKIP_WAITING\" });\r\n\r\n      registrationWaiting.addEventListener(\"statechange\", (e) => {\r\n        if (e.target.state === \"activated\") {\r\n          window.localStorage.removeItem(\"versionUpdating\");\r\n          window.location.reload();\r\n        }\r\n      });\r\n    }\r\n  };\r\n\r\n  return (\r\n    <PrimaryLayout\r\n      name=\"activities\"\r\n      title={i18n.INSTAPP_JOBLIST_ACTIVITY_COCKPIT}\r\n      pageLevel={1}\r\n    >\r\n      <Box\r\n        style={{\r\n          width: \"100%\",\r\n          position: \"fixed\",\r\n          zIndex: \"100\",\r\n          backgroundColor: \"#fafafa\",\r\n          height: \"48px\",\r\n        }}\r\n      >\r\n        <FFTab\r\n          tabs={tabs}\r\n          selectedTabValue={timeHorizon}\r\n          onTabChange={(value) => setTimeHorizon(value)}\r\n        />\r\n      </Box>\r\n      <div className={classes.main} ref={scrollRef}>\r\n        <ActivityList />\r\n      </div>\r\n\r\n      <div>\r\n        {historyPage === \"loginPage\" && isServiceWorkerUpdated && (\r\n          <CheckforUpdates\r\n            type=\"SW_UPDATE\"\r\n            page=\"activity\"\r\n            open={isServiceWorkerUpdated}\r\n            onClick={updateServiceWorker}\r\n          />\r\n        )}\r\n      </div>\r\n    </PrimaryLayout>\r\n  );\r\n};\r\n\r\nconst mapStateToPops = (state, ownProps) => {\r\n  const {\r\n    timeHorizon,\r\n    settings,\r\n    versionUpdating: { serviceWorkerUpdated, serviceWorkerRegistration },\r\n  } = state;\r\n  const historyPage = settings.historyPage ? settings.historyPage : \"\";\r\n\r\n  return {\r\n    timeHorizon,\r\n    historyPage,\r\n    isServiceWorkerUpdated: serviceWorkerUpdated,\r\n    serviceWorkerRegistration,\r\n  };\r\n};\r\n\r\nconst mapDispatchToState = (dispatch) => {\r\n  return {\r\n    refresh: () => {\r\n      dispatch(action.fetchAll(repo.type.CACHE));\r\n    },\r\n    setTimeHorizon: (timeHorizon) => {\r\n      dispatch(action.setTimeHorizon(timeHorizon));\r\n    },\r\n    setScrollPosition: (data) => {\r\n      dispatch(action.setScrollPosition(data));\r\n    },\r\n  };\r\n};\r\n\r\nexport default connect(mapStateToPops, mapDispatchToState)(ActivityListPage);\r\n"]},"metadata":{},"sourceType":"module"}