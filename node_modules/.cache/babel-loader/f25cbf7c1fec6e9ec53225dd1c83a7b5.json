{"ast":null,"code":"import*as action from\"actions\";import*as api from\"api\";import{db}from\"js/db\";export var setUserManual=function setUserManual(data){return{type:\"SET_USER_MANUAL_LIST\",payload:data};};export var getUserManual=function getUserManual(){return function(dispatch){dispatch(action.showLoading());return api.getUserManual().then(function(res){return Promise.resolve(res.data);}).finally(function(){dispatch(action.hideLoading());});};};export var getPdfData=function getPdfData(id){return function(dispatch){dispatch(action.showLoading());return db.cache.get(\"userManualData\").then(function(cache){if(cache===null||cache===void 0?void 0:cache.data[id]){var pdfurl=\"data:application/pdf;base64,\".concat(cache===null||cache===void 0?void 0:cache.data[id].blob);dispatch(action.hideLoading());return Promise.resolve(pdfurl);}else{return api.downLoadPdf(id).then(function(res){var userManualData=(cache===null||cache===void 0?void 0:cache.data)||{};userManualData[id]={name:res.data.name,blob:res.data.blob};if(cache===null||cache===void 0?void 0:cache.data){return db.cache.put({id:\"userManualData\",data:userManualData}).then(function(){var pdfurl=\"data:application/pdf;base64,\".concat(res.data.blob);return Promise.resolve(pdfurl);});}else{return db.cache.put({id:\"userManualData\",data:userManualData}).then(function(){var pdfurl=\"data:application/pdf;base64,\".concat(res.data.blob);return Promise.resolve(pdfurl);});}}).finally(function(){dispatch(action.hideLoading());});}});};};","map":{"version":3,"sources":["C:/project/SCF-NI_PM_App/SCF.InstallationQuality/react-client/src/actions/userManual.js"],"names":["action","api","db","setUserManual","data","type","payload","getUserManual","dispatch","showLoading","then","res","Promise","resolve","finally","hideLoading","getPdfData","id","cache","get","pdfurl","blob","downLoadPdf","userManualData","name","put"],"mappings":"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","sourcesContent":["import * as action from \"actions\";\r\nimport * as api from \"api\";\r\nimport { db } from \"js/db\";\r\n\r\nexport const setUserManual = (data) => ({\r\n  type: \"SET_USER_MANUAL_LIST\",\r\n  payload: data,\r\n});\r\n\r\nexport const getUserManual = () => (dispatch) => {\r\n  dispatch(action.showLoading());\r\n  return api\r\n    .getUserManual()\r\n    .then((res) => {\r\n      return Promise.resolve(res.data);\r\n    })\r\n    .finally(() => {\r\n      dispatch(action.hideLoading());\r\n    });\r\n};\r\n\r\nexport const getPdfData = (id) => (dispatch) => {\r\n  dispatch(action.showLoading());\r\n\r\n  return db.cache.get(\"userManualData\").then((cache) => {\r\n    if (cache?.data[id]) {\r\n      const pdfurl = `data:application/pdf;base64,${cache?.data[id].blob}`;\r\n      dispatch(action.hideLoading());\r\n      return Promise.resolve(pdfurl);\r\n    } else {\r\n      return api\r\n        .downLoadPdf(id)\r\n        .then((res) => {\r\n          const userManualData = cache?.data || {};\r\n          userManualData[id] = { name: res.data.name, blob: res.data.blob };\r\n\r\n          if (cache?.data) {\r\n            return db.cache\r\n              .put({\r\n                id: \"userManualData\",\r\n                data: userManualData,\r\n              })\r\n              .then(() => {\r\n                const pdfurl = `data:application/pdf;base64,${res.data.blob}`;\r\n                return Promise.resolve(pdfurl);\r\n              });\r\n          } else {\r\n            return db.cache\r\n              .put({\r\n                id: \"userManualData\",\r\n                data: userManualData,\r\n              })\r\n              .then(() => {\r\n                const pdfurl = `data:application/pdf;base64,${res.data.blob}`;\r\n                return Promise.resolve(pdfurl);\r\n              });\r\n          }\r\n        })\r\n        .finally(() => {\r\n          dispatch(action.hideLoading());\r\n        });\r\n    }\r\n  });\r\n};\r\n"]},"metadata":{},"sourceType":"module"}