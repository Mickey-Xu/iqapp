{"ast":null,"code":"import*as action from\"actions\";import OrderActivityList from\"components/OrderActivityList\";import OrderActivityListCard from\"components/OrderActivityListCard\";import{LocalizeContext}from\"i18n\";import PrimaryLayout from\"layouts/PrimaryLayout\";import React from\"react\";import{connect}from\"react-redux\";import*as publicFn from\"../../js/publicFn/index\";var OrderInstallationListPage=function OrderInstallationListPage(_ref){var data=_ref.data,orderNumber=_ref.orderNumber,_submit=_ref.submit;var i18n=React.useContext(LocalizeContext);return/*#__PURE__*/React.createElement(PrimaryLayout,{title:i18n.ISNTAPP_JOBLIST_INST_STEPS+\": \"+orderNumber},/*#__PURE__*/React.createElement(OrderActivityList,{data:data,component:OrderActivityListCard,tabType:\"\",submit:function submit(activityNumber,date,type){_submit(activityNumber,orderNumber,date,type);}}));};var mapDispatchToState=function mapDispatchToState(dispatch){return{submit:function submit(activityNumber,orderNumber,date,type){var data={activityNo:activityNumber,date:date?date:\"\",orderNo:orderNumber,type:type};dispatch(action.updateOrderActivityStatus(data));}};};export default connect(function(_ref2,_ref3){var auth=_ref2.auth,installations=_ref2.installations,orderActivities=_ref2.orderActivities,orders=_ref2.orders;var orderNumber=_ref3.match.params.number;var _ref4=orders[orderNumber]||{},productFamily=_ref4.productFamily;return{data:Object.keys(installations).filter(function(key){return installations[key].orderNumber===orderNumber;}).map(function(key){var stepNumber=installations[key].stepNumber;var description=installations[key].description;var _ref5=orderActivities[key]||{},confirmedDate=_ref5.confirmedDate,leadingDate=_ref5.leadingDate,leadingEndDate=_ref5.leadingEndDate,leadingStartDate=_ref5.leadingStartDate,info=_ref5.info,originalStep=_ref5.originalStep,activityNumber=_ref5.activityNumber,editable=_ref5.editable;var authOrderActivities={auth:auth,orderActivities:orderActivities};var ownprops={activityNumber:activityNumber,orderNumber:orderNumber};var isExecutable=publicFn.DatePermissionControl(authOrderActivities,ownprops);return{activityNumber:activityNumber,confirmedDate:confirmedDate?new Date(confirmedDate).toLocaleDateString():\"-\",descriptionShort:description,leadingDate:leadingDate?new Date(leadingDate).toLocaleDateString():leadingStartDate&&leadingEndDate?new Date(leadingEndDate).toLocaleDateString():\"-\",info:info||\"-\",orderNumber:orderNumber,stepNumber:stepNumber,productFamily:productFamily,originalStep:originalStep,editable:editable,isExecutable:isExecutable};}),orderNumber:orderNumber};},mapDispatchToState)(OrderInstallationListPage);","map":{"version":3,"sources":["C:/project/SCF-NI_PM_App/SCF.InstallationQuality/react-client/src/pages/OrderInstallationListPage/index.js"],"names":["action","OrderActivityList","OrderActivityListCard","LocalizeContext","PrimaryLayout","React","connect","publicFn","OrderInstallationListPage","data","orderNumber","submit","i18n","useContext","ISNTAPP_JOBLIST_INST_STEPS","activityNumber","date","type","mapDispatchToState","dispatch","activityNo","orderNo","updateOrderActivityStatus","auth","installations","orderActivities","orders","match","params","number","productFamily","Object","keys","filter","key","map","stepNumber","description","confirmedDate","leadingDate","leadingEndDate","leadingStartDate","info","originalStep","editable","authOrderActivities","ownprops","isExecutable","DatePermissionControl","Date","toLocaleDateString","descriptionShort"],"mappings":"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","sourcesContent":["import * as action from \"actions\";\r\nimport OrderActivityList from \"components/OrderActivityList\";\r\nimport OrderActivityListCard from \"components/OrderActivityListCard\";\r\nimport { LocalizeContext } from \"i18n\";\r\nimport PrimaryLayout from \"layouts/PrimaryLayout\";\r\nimport React from \"react\";\r\nimport { connect } from \"react-redux\";\r\nimport * as publicFn from \"../../js/publicFn/index\";\r\n\r\nconst OrderInstallationListPage = ({ data, orderNumber, submit }) => {\r\n  const i18n = React.useContext(LocalizeContext);\r\n\r\n  return (\r\n    <PrimaryLayout title={i18n.ISNTAPP_JOBLIST_INST_STEPS + \": \" + orderNumber}>\r\n      <OrderActivityList\r\n        data={data}\r\n        component={OrderActivityListCard}\r\n        tabType=\"\"\r\n        submit={(activityNumber, date, type) => {\r\n          submit(activityNumber, orderNumber, date, type);\r\n        }}\r\n      ></OrderActivityList>\r\n    </PrimaryLayout>\r\n  );\r\n};\r\n\r\nconst mapDispatchToState = (dispatch) => {\r\n  return {\r\n    submit: (activityNumber, orderNumber, date, type) => {\r\n      let data = {\r\n        activityNo: activityNumber,\r\n        date: date ? date : \"\",\r\n        orderNo: orderNumber,\r\n        type: type,\r\n      };\r\n      dispatch(action.updateOrderActivityStatus(data));\r\n    },\r\n  };\r\n};\r\n\r\nexport default connect(\r\n  (\r\n    { auth, installations, orderActivities, orders },\r\n    {\r\n      match: {\r\n        params: { number: orderNumber },\r\n      },\r\n    }\r\n  ) => {\r\n    const { productFamily } = orders[orderNumber] || {};\r\n\r\n    return {\r\n      data: Object.keys(installations)\r\n        .filter((key) => {\r\n          return installations[key].orderNumber === orderNumber;\r\n        })\r\n        .map((key) => {\r\n          const stepNumber = installations[key].stepNumber;\r\n          const description = installations[key].description;\r\n          const {\r\n            confirmedDate,\r\n            leadingDate,\r\n            leadingEndDate,\r\n            leadingStartDate,\r\n            info,\r\n            originalStep,\r\n            activityNumber,\r\n            editable,\r\n          } = orderActivities[key] || {};\r\n\r\n          let authOrderActivities = {\r\n            auth,\r\n            orderActivities,\r\n          };\r\n\r\n          let ownprops = {\r\n            activityNumber,\r\n            orderNumber,\r\n          };\r\n\r\n          const isExecutable = publicFn.DatePermissionControl(\r\n            authOrderActivities,\r\n            ownprops\r\n          );\r\n          return {\r\n            activityNumber: activityNumber,\r\n            confirmedDate: confirmedDate\r\n              ? new Date(confirmedDate).toLocaleDateString()\r\n              : \"-\",\r\n            descriptionShort: description,\r\n            leadingDate: leadingDate\r\n              ? new Date(leadingDate).toLocaleDateString()\r\n              : leadingStartDate && leadingEndDate\r\n              ? new Date(leadingEndDate).toLocaleDateString()\r\n              : \"-\",\r\n            info: info || \"-\",\r\n            orderNumber: orderNumber,\r\n            stepNumber: stepNumber,\r\n            productFamily,\r\n            originalStep,\r\n            editable,\r\n            isExecutable,\r\n          };\r\n        }),\r\n      orderNumber: orderNumber,\r\n    };\r\n  },\r\n  mapDispatchToState\r\n)(OrderInstallationListPage);\r\n"]},"metadata":{},"sourceType":"module"}