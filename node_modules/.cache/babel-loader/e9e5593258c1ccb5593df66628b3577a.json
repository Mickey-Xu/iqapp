{"ast":null,"code":"import*as action from\"actions\";import*as api from\"api\";import*as repo from\"js/fetch\";import{saveDraftToLocal}from\"js/util\";export var updateDocumentList=function updateDocumentList(data){return{type:\"UPDATE_DOCUMENT_LIST\",payload:data};};export var uploadDocumentForm=function uploadDocumentForm(data,draftData,param){return function(dispatch){dispatch(action.showLoading());return savePdf(data,draftData).then(function(response){repo.updateDocumentList(response.data).then(function(){dispatch(action.updateDocumentList(response.data));});var orderNo=draftData.orderNo,form=draftData.form;var documentNo=param.documentNo,documentPart=param.documentPart,activityNo=param.activityNo,productFamily=param.productFamily,productLine=param.productLine,language=param.language;saveDraftToLocal(form,{documentNo:documentNo,documentPart:documentPart},{orderNo:orderNo,activityNo:activityNo,productFamily:productFamily,productLine:productLine,language:language});dispatch(action.removeTemplateFormState(param));}).catch(function(error){if(error.code===401){window.localStorage.removeItem(\"auth\");dispatch(action.setAuth(null));}dispatch(action.setError(error.message));}).finally(function(){dispatch(action.hideLoading());window.history.back(-1);});};};var savePdf=function savePdf(data,dataDraft){var promises=[];promises.push(api.uploadDocumentForm(data));return Promise.all(promises).then(function(response){return Promise.resolve(response[0]);});};","map":{"version":3,"sources":["C:/project/SCF-NI_PM_App/SCF.InstallationQuality/react-client/src/actions/documents.js"],"names":["action","api","repo","saveDraftToLocal","updateDocumentList","data","type","payload","uploadDocumentForm","draftData","param","dispatch","showLoading","savePdf","then","response","orderNo","form","documentNo","documentPart","activityNo","productFamily","productLine","language","removeTemplateFormState","catch","error","code","window","localStorage","removeItem","setAuth","setError","message","finally","hideLoading","history","back","dataDraft","promises","push","Promise","all","resolve"],"mappings":"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","sourcesContent":["import * as action from \"actions\";\r\nimport * as api from \"api\";\r\nimport * as repo from \"js/fetch\";\r\nimport { saveDraftToLocal } from \"js/util\";\r\n\r\nexport const updateDocumentList = (data) => ({\r\n  type: \"UPDATE_DOCUMENT_LIST\",\r\n  payload: data,\r\n});\r\n\r\nexport const uploadDocumentForm = (data, draftData, param) => (dispatch) => {\r\n  dispatch(action.showLoading());\r\n  return savePdf(data, draftData)\r\n    .then((response) => {\r\n      repo.updateDocumentList(response.data).then(() => {\r\n        dispatch(action.updateDocumentList(response.data));\r\n      });\r\n      const { orderNo, form } = draftData;\r\n      const {\r\n        documentNo,\r\n        documentPart,\r\n        activityNo,\r\n        productFamily,\r\n        productLine,\r\n        language,\r\n      } = param;\r\n\r\n      saveDraftToLocal(\r\n        form,\r\n        { documentNo, documentPart },\r\n        { orderNo, activityNo, productFamily, productLine, language }\r\n      );\r\n      dispatch(action.removeTemplateFormState(param));\r\n    })\r\n    .catch((error) => {\r\n      if (error.code === 401) {\r\n        window.localStorage.removeItem(\"auth\");\r\n        dispatch(action.setAuth(null));\r\n      }\r\n      dispatch(action.setError(error.message));\r\n    })\r\n    .finally(() => {\r\n      dispatch(action.hideLoading());\r\n      window.history.back(-1);\r\n    });\r\n};\r\n\r\nconst savePdf = (data, dataDraft) => {\r\n  let promises = [];\r\n\r\n  promises.push(api.uploadDocumentForm(data));\r\n\r\n  return Promise.all(promises).then((response) => {\r\n    return Promise.resolve(response[0]);\r\n  });\r\n};\r\n"]},"metadata":{},"sourceType":"module"}