{"ast":null,"code":"import _slicedToArray from\"C:\\\\project\\\\SCF-NI_PM_App\\\\SCF.InstallationQuality\\\\react-client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";import{Box}from\"@material-ui/core\";import FFTab from\"components/FFTab\";import TaskListItem from\"components/TaskListItem\";import{LocalizeContext}from\"i18n\";import{toDoOrDone}from\"js/util\";import PrimaryLayout from\"layouts/PrimaryLayout\";import React from\"react\";import{connect}from\"react-redux\";import{useParams}from\"react-router-dom\";import*as action from\"actions\";import*as util from\"js/util\";var Tasks=function Tasks(_ref){var type=_ref.type,tasksData=_ref.tasksData,getTaskCount=_ref.getTaskCount,_submit=_ref.submit,orders=_ref.orders,orderActivities=_ref.orderActivities;var i18n=React.useContext(LocalizeContext);var _React$useState=React.useState(\"open\"),_React$useState2=_slicedToArray(_React$useState,2),status=_React$useState2[0],setStatus=_React$useState2[1];var params=useParams();var awaitStart=getTaskCount(tasksData,'awaitStart');var awaitComplate=getTaskCount(tasksData,'awaitComplate');var awaitClose=getTaskCount(tasksData,'awaitClose');var tabs=[{title:i18n.ISNTAPP_TO_COMPLETE,value:\"open\"},{title:i18n.ISNTAPP_TO_CLOSE,value:\"pending\"},{title:i18n.ISNTAPP_CLOSED,value:\"close\"}];var currentStatusTasks=[];if(status===\"open\"){tasksData.forEach(function(item){if(item.status===\"awaitComplate\"||item.status===\"awaitStart\"){currentStatusTasks.push(item);}});}if(status===\"pending\"){tasksData.forEach(function(item){if(item.status===\"awaitClose\"){currentStatusTasks.push(item);}});}if(status===\"close\"){tasksData.forEach(function(item){if(item.status===\"closed\"){currentStatusTasks.push(item);}});}return/*#__PURE__*/React.createElement(PrimaryLayout,{name:\"tasks\",title:params.type},/*#__PURE__*/React.createElement(Box,{style:{position:\"fixed\",top:\"52px\",width:\"100%\",zIndex:\"10000\"}},/*#__PURE__*/React.createElement(FFTab,{tabs:tabs,selectedTabValue:\"open\",onTabChange:function onTabChange(value){return setStatus(value);}}),/*#__PURE__*/React.createElement(\"span\",{style:{position:\"absolute\",top:\"0\",left:\"22%\",padding:\"2px 8px\",backgroundColor:\"red\",borderRadius:\"40px\",color:\"white\",display:awaitComplate+awaitStart>0?'block':'none'}},awaitComplate+awaitStart),/*#__PURE__*/React.createElement(\"span\",{style:{position:\"absolute\",top:\"0\",left:\"55%\",padding:\"2px 8px\",backgroundColor:\"red\",borderRadius:\"40px\",color:\"white\",display:awaitClose>0?'block':'none'}},awaitClose)),/*#__PURE__*/React.createElement(Box,{style:{width:\"100%\",padding:\"16px\",position:\"absolute\",top:\"32px\",height:window.screen.height-157+\"px\",overflow:\"hidden auto\"}},/*#__PURE__*/React.createElement(TaskListItem,{data:currentStatusTasks,status:status,type:type,submit:function submit(type,data){var activityParams=util.setActivityStatusParams(data.projectNo,data.orderNo,data.activityNo,util.formatDateToYMD(new Date()),1,orderActivities,orders);_submit(type,data,activityParams);}})));};var mapStateToProps=function mapStateToProps(state,ownProps){var match=ownProps.match;var params=match.params;var type=params.type;var tasks=state.tasks,orders=state.orders,templates=state.templates,documentList=state.documentList,orderActivities=state.orderActivities;var data=Object.keys(tasks).length>0?tasks:[];var taskList=data.filter(function(item){return item.taskType===type;});taskList.forEach(function(item){var _orders$item$orderNo,_orders$item$orderNo2;item['productFamily']=(_orders$item$orderNo=orders[item===null||item===void 0?void 0:item.orderNo])===null||_orders$item$orderNo===void 0?void 0:_orders$item$orderNo.productFamily;item['documentStatus']=toDoOrDone((_orders$item$orderNo2=orders[item===null||item===void 0?void 0:item.orderNo])===null||_orders$item$orderNo2===void 0?void 0:_orders$item$orderNo2.projectNumber,item.orderNo,item.activityNo,templates,documentList);});return{type:type,tasksData:taskList,orders:orders,orderActivities:orderActivities};};var mapDispatchToProps=function mapDispatchToProps(dispatch){return{submit:function submit(type,data,activityParams){dispatch(action.processingTasks(type,data,activityParams,dispatch));},getTaskCount:function getTaskCount(task,status){var count=task.filter(function(item){return item.status===status;}).length;return count;}};};export default connect(mapStateToProps,mapDispatchToProps)(Tasks);","map":{"version":3,"sources":["C:/project/SCF-NI_PM_App/SCF.InstallationQuality/react-client/src/pages/TaskListPage/index.js"],"names":["Box","FFTab","TaskListItem","LocalizeContext","toDoOrDone","PrimaryLayout","React","connect","useParams","action","util","Tasks","type","tasksData","getTaskCount","submit","orders","orderActivities","i18n","useContext","useState","status","setStatus","params","awaitStart","awaitComplate","awaitClose","tabs","title","ISNTAPP_TO_COMPLETE","value","ISNTAPP_TO_CLOSE","ISNTAPP_CLOSED","currentStatusTasks","forEach","item","push","position","top","width","zIndex","left","padding","backgroundColor","borderRadius","color","display","height","window","screen","overflow","data","activityParams","setActivityStatusParams","projectNo","orderNo","activityNo","formatDateToYMD","Date","mapStateToProps","state","ownProps","match","tasks","templates","documentList","Object","keys","length","taskList","filter","taskType","productFamily","projectNumber","mapDispatchToProps","dispatch","processingTasks","task","count"],"mappings":"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","sourcesContent":["import { Box } from \"@material-ui/core\";\r\nimport FFTab from \"components/FFTab\";\r\nimport TaskListItem from \"components/TaskListItem\";\r\nimport { LocalizeContext } from \"i18n\";\r\nimport { toDoOrDone } from \"js/util\";\r\nimport PrimaryLayout from \"layouts/PrimaryLayout\";\r\nimport React from \"react\";\r\nimport { connect } from \"react-redux\";\r\nimport { useParams } from \"react-router-dom\";\r\nimport * as action from \"actions\";\r\nimport * as util from \"js/util\";\r\n\r\nconst Tasks = ({ type, tasksData, getTaskCount, submit, orders, orderActivities }) => {\r\n  const i18n = React.useContext(LocalizeContext);\r\n  const [status, setStatus] = React.useState(\"open\");\r\n  const params = useParams()\r\n  const awaitStart = getTaskCount(tasksData, 'awaitStart');\r\n  const awaitComplate = getTaskCount(tasksData,'awaitComplate');\r\n  const awaitClose = getTaskCount(tasksData, 'awaitClose');\r\n  const tabs = [\r\n    { title: i18n.ISNTAPP_TO_COMPLETE, value: \"open\" },\r\n    { title: i18n.ISNTAPP_TO_CLOSE, value: \"pending\" },\r\n    { title: i18n.ISNTAPP_CLOSED, value: \"close\" },\r\n  ];\r\n\r\n  let currentStatusTasks = [];\r\n\r\n  if (status === \"open\") {\r\n    tasksData.forEach((item) => {\r\n      if (item.status === \"awaitComplate\" || item.status === \"awaitStart\") {\r\n        currentStatusTasks.push(item);\r\n      }\r\n    });\r\n  }\r\n\r\n  if (status === \"pending\") {\r\n    tasksData.forEach((item) => {\r\n      if (item.status === \"awaitClose\") {\r\n        currentStatusTasks.push(item);\r\n      }\r\n    });\r\n  }\r\n\r\n  if (status === \"close\") {\r\n    tasksData.forEach((item) => {\r\n      if (item.status === \"closed\") {\r\n        currentStatusTasks.push(item);\r\n      }\r\n    });\r\n  }\r\n  \r\n  return (\r\n    <PrimaryLayout name=\"tasks\" title={params.type}>\r\n      <Box\r\n        style={{\r\n          position: \"fixed\",\r\n          top: \"52px\",\r\n          width: \"100%\",\r\n          zIndex: \"10000\",\r\n        }}\r\n      >\r\n        <FFTab\r\n          tabs={tabs}\r\n          selectedTabValue={\"open\"}\r\n          onTabChange={(value) => setStatus(value)}\r\n        />\r\n        <span\r\n          style={{\r\n            position: \"absolute\",\r\n            top: \"0\",\r\n            left: \"22%\",\r\n            padding: \"2px 8px\",\r\n            backgroundColor: \"red\",\r\n            borderRadius: \"40px\",\r\n            color: \"white\",\r\n            display: (awaitComplate + awaitStart) >0?'block':'none'\r\n          }}\r\n        >\r\n          {awaitComplate + awaitStart}\r\n        </span>\r\n            <span\r\n              style={{\r\n                position: \"absolute\",\r\n                top: \"0\",\r\n                left: \"55%\",\r\n                padding: \"2px 8px\",\r\n                backgroundColor: \"red\",\r\n                borderRadius: \"40px\",\r\n                color: \"white\",\r\n                display: awaitClose > 0 ? 'block' : 'none'\r\n              }}\r\n            >\r\n          {awaitClose}\r\n        </span>\r\n      </Box>\r\n\r\n      <Box\r\n        style={{\r\n          width: \"100%\",\r\n          padding: \"16px\",\r\n          position: \"absolute\",\r\n          top: \"32px\",\r\n          height: window.screen.height - 157 + \"px\",\r\n          overflow: \"hidden auto\",\r\n        }}\r\n      >\r\n        <TaskListItem\r\n          data={currentStatusTasks}\r\n          status={status}\r\n          type={type}\r\n          submit={(type, data) => { \r\n              const activityParams = util.setActivityStatusParams(\r\n                                    data.projectNo,\r\n                                    data.orderNo,\r\n                                    data.activityNo,\r\n                                    util.formatDateToYMD(new Date()),\r\n                                    1,\r\n                                    orderActivities,\r\n                                    orders\r\n            );\r\n            submit(type, data,activityParams)\r\n          }}\r\n        ></TaskListItem>\r\n      </Box>\r\n    </PrimaryLayout>\r\n  );\r\n};\r\n\r\nconst mapStateToProps = (state, ownProps) => {\r\n  const { match } = ownProps;\r\n  const { params } = match;\r\n  const { type } = params;\r\n  const { tasks, orders, templates, documentList, orderActivities } = state;\r\n  let data = Object.keys(tasks).length > 0 ? tasks : [];\r\n  let taskList = data.filter((item) => item.taskType === type);\r\n\r\n  taskList.forEach((item) =>\r\n  {\r\n    item['productFamily'] = orders[item?.orderNo]?.productFamily;\r\n    item['documentStatus'] = toDoOrDone(\r\n      orders[item?.orderNo]?.projectNumber,\r\n      item.orderNo,\r\n      item.activityNo,\r\n      templates,\r\n      documentList\r\n      );\r\n    }\r\n  )\r\n\r\n  return {\r\n    type,\r\n    tasksData: taskList,\r\n    orders,\r\n    orderActivities\r\n  };\r\n};\r\n\r\nconst mapDispatchToProps = (dispatch) => {\r\n  return {\r\n    submit: (type, data, activityParams) => {\r\n      dispatch(action.processingTasks(type, data,activityParams,dispatch))\r\n    },\r\n    getTaskCount: (task, status) => {\r\n      let count = task.filter((item) => item.status === status).length\r\n      return count\r\n    }\r\n  };\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(Tasks);\r\n"]},"metadata":{},"sourceType":"module"}