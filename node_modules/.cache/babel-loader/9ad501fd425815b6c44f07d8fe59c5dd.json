{"ast":null,"code":"import _toConsumableArray from\"C:\\\\project\\\\SCF-NI_PM_App\\\\SCF.InstallationQuality\\\\react-client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/toConsumableArray\";import _slicedToArray from\"C:\\\\project\\\\SCF-NI_PM_App\\\\SCF.InstallationQuality\\\\react-client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";import{Accordion,AccordionDetails,AccordionSummary,Box,Grid,Typography,withStyles,Divider,Button,AccordionActions,List,Checkbox}from\"@material-ui/core\";import AddCircleOutlineIcon from\"@material-ui/icons/AddCircleOutline\";import ArrowRightIcon from\"@material-ui/icons/ArrowRight\";import*as action from\"actions\";import Model from\"components/Model\";import Pdf from\"components/Pdf\";import{LocalizeContext}from\"i18n\";import{documentAuthorizationC}from\"js/publicFn\";import{getTemplateList,showUploadButton}from\"js/util\";import PrimaryLayout from\"layouts/PrimaryLayout\";import React,{useEffect}from\"react\";import{connect}from\"react-redux\";import{useHistory}from\"react-router-dom\";import Square from\"img/square.png\";import Triangle from\"img/triangle.png\";import{makeStyles}from\"@material-ui/styles\";var getSquareORTriangle=function getSquareORTriangle(type){var imgSource=type===\"Square\"?Square:type===\"Triangle\"?Triangle:\"No\";return imgSource===\"No\"?imgSource:/*#__PURE__*/React.createElement(\"img\",{src:imgSource,alt:\"\"});};var getSpecifyStr=function getSpecifyStr(item){var str=\"Chinese:\";var splitChar=item.split(\"||\");return splitChar.find(function(e){return e.startsWith(str)||splitChar.findIndex(function(e){return e.startsWith(str);})===-1&&splitChar[0];}).split(\":\").slice(-1)[0];};// const isShowUpLoadButon = (allowreupload, param, documents) => {\n//   if (documents.length > 0) {\n//     if (!allowreupload) {\n//       return false\n//     } else {\n//       if (getChecklistActivityNo(param)) {\n//         return false\n//       } else {\n//         return true;\n//       }\n//     }\n//   } else {\n//     return true\n//   }\n// }\nvar dynamicDisplay=function dynamicDisplay(root,config,version){if(root===\"listCard\"){if(version!==\"Latest\"){return false;}return config.closeEnabledInOILScreen;}else if(root===\"installationChecklist\"){if(version!==\"Latest\"){return false;}else{return true;}}return false;};var useStyles=makeStyles(function(_ref){var spacing=_ref.spacing;return{root:{\"& .MuiAccordionSummary-content.Mui-expanded\":{margin:0},\"& .MuiAccordionSummary-content\":{margin:0},\"& .MuiAccordionSummary-root.Mui-expanded\":{minHeight:\"auto\",paddingTop:spacing(1)}}};});var ListofIncongruentItems=function ListofIncongruentItems(_ref2){var data=_ref2.data,getHistoryList=_ref2.getHistoryList,version=_ref2.version,root=_ref2.root,nonConformityConfig=_ref2.nonConformityConfig,activityNo=_ref2.activityNo,closeNonConfirmityItems=_ref2.closeNonConfirmityItems;var i18n=React.useContext(LocalizeContext);var _React$useState=React.useState(true),_React$useState2=_slicedToArray(_React$useState,2),expanded=_React$useState2[0],setExpanded=_React$useState2[1];var classes=useStyles();var handleChange=function handleChange(event,newExpanded){setExpanded(newExpanded);};var canClick=true;return/*#__PURE__*/React.createElement(List,{component:\"nav\",\"aria-label\":\"contacts\",style:{marginBottom:20}},version===\"Latest\"&&/*#__PURE__*/React.createElement(Box,{style:{display:\"flex\",justifyContent:\"space-between\"}},/*#__PURE__*/React.createElement(Button,{size:\"large\",color:\"secondary\",onClick:function onClick(){return getHistoryList();}},\"\\u5386\\u53F2\"),dynamicDisplay(root,nonConformityConfig[activityNo],version)&&data.nonConformities.find(function(item){return item.nonConformityItems.length>0;})&&/*#__PURE__*/React.createElement(Button,{size:\"large\",color:\"secondary\",onClick:function onClick(){if(!canClick){alert('请稍候再试！');return;};setTimeout(function(){canClick=true;},2000);canClick=false;closeNonConfirmityItems(data);}},i18n.Close_NONCONFORMANCE_ITEMS)),/*#__PURE__*/React.createElement(Accordion,{className:classes.root,style:{margin:\"0 16px\"},expanded:expanded,onChange:handleChange},/*#__PURE__*/React.createElement(AccordionSummary,{style:{margin:0}},/*#__PURE__*/React.createElement(ArrowRightIcon,{fontSize:\"large\",style:expanded?{transform:\"rotate(90deg)\"}:{}}),/*#__PURE__*/React.createElement(Typography,{variant:\"h6\"},version===\"Latest\"?\"\\u5F53\\u524D\\u7248\\u672C\":\"\\u7248\\u672C\\uFF1A\".concat(version))),/*#__PURE__*/React.createElement(AccordionDetails,null,/*#__PURE__*/React.createElement(Box,{style:{width:\"100%\"}},data.nonConformities.map(function(key,index){return/*#__PURE__*/React.createElement(Box,{key:index,ml:2,mr:2},/*#__PURE__*/React.createElement(Typography,{style:{fontWeight:600},gutterBottom:true,variant:\"body2\",component:\"h2\"},key.documentName),/*#__PURE__*/React.createElement(Box,null,key.nonConformityItems.map(function(item,index){return/*#__PURE__*/React.createElement(Grid,{key:index,container:true},/*#__PURE__*/React.createElement(Grid,{item:true,xs:8},/*#__PURE__*/React.createElement(Typography,{variant:\"caption\"},getSpecifyStr(item.itemName))),/*#__PURE__*/React.createElement(Grid,{item:true,xs:2},/*#__PURE__*/React.createElement(\"p\",{style:{fontWeight:800,paddingLeft:24,marginBottom:0,marginTop:8}},\" \",getSquareORTriangle(item.questionType))),/*#__PURE__*/React.createElement(Grid,{item:true,xs:2,style:{textAlign:\"end\"}},dynamicDisplay(root,nonConformityConfig[activityNo],version)&&/*#__PURE__*/React.createElement(Checkbox,{style:{padding:4},color:\"default\",inputProps:{'aria-label':'checkbox with default color'},onChange:function onChange(event){var checkedVlaue=event.target.checked;item[\"itemValue\"]=checkedVlaue?\"yes\":\"no\";item[\"activityNo\"]=key.activityNo;}})));})));})))));};var Template=withStyles(function(_ref3){var spacing=_ref3.spacing;return{root:{padding:0},add:{marginLeft:spacing(5)},navIcon:{transform:\"rotate(90deg)\"},documentName:{marginLeft:spacing(1)}};})(function(_ref4){var classes=_ref4.classes,_ref4$template=_ref4.template,activityNo=_ref4$template.activityNo,documentNo=_ref4$template.documentNo,documentPart=_ref4$template.documentPart,mandDoc=_ref4$template.mandDoc,documentDescription=_ref4$template.documentDescription,productFamily=_ref4$template.productFamily,productLine=_ref4$template.productLine,language=_ref4$template.language,orderNo=_ref4.orderNo,projectNumber=_ref4.projectNumber,fetchPdf=_ref4.fetchPdf,documents=_ref4.documents,foe=_ref4.foe,region=_ref4.region,branch=_ref4.branch,DisableTheEntranceroot=_ref4.DisableTheEntranceroot,canUploadDoc=_ref4.canUploadDoc,fetchNoConformityList=_ref4.fetchNoConformityList,root=_ref4.root,i18n=_ref4.i18n,fetchHistoryList=_ref4.fetchHistoryList,nonConformityConfig=_ref4.nonConformityConfig,closeNonConfirmity=_ref4.closeNonConfirmity;var _React$useState3=React.useState(true),_React$useState4=_slicedToArray(_React$useState3,2),expanded=_React$useState4[0],setExpanded=_React$useState4[1];var _React$useState5=React.useState(false),_React$useState6=_slicedToArray(_React$useState5,2),open=_React$useState6[0],setOpen=_React$useState6[1];var _React$useState7=React.useState(),_React$useState8=_slicedToArray(_React$useState7,2),modelContent=_React$useState8[0],setModelContent=_React$useState8[1];var _React$useState9=React.useState(documentDescription),_React$useState10=_slicedToArray(_React$useState9,2),title=_React$useState10[0],setTitle=_React$useState10[1];var _React$useState11=React.useState([]),_React$useState12=_slicedToArray(_React$useState11,2),data=_React$useState12[0],setData=_React$useState12[1];useEffect(function(){setModelContent(data.map(function(item,index){return/*#__PURE__*/React.createElement(ListofIncongruentItems,{key:index,data:item,getHistoryList:getHistoryList,version:item===null||item===void 0?void 0:item.versionIdentifier,root:root,nonConformityConfig:nonConformityConfig,activityNo:activityNo,closeNonConfirmityItems:closeNonConfirmityItems});}));// eslint-disable-next-line\n},[data]);var handleClickOpen=function handleClickOpen(name){var data={ProjectNo:projectNumber,OrderNo:orderNo,ActivityNo:activityNo,DocumentName:name,foe:foe,region:region,branch:branch};root===\"installationChecklist\"&&delete data.ActivityNo;fetchPdf(data).then(function(url){setOpen(true);setModelContent(/*#__PURE__*/React.createElement(Pdf,{filePath:url}));});};var handleClose=function handleClose(){setOpen(false);};var handleChange=function handleChange(event,newExpanded){setExpanded(newExpanded);};var getHistoryList=function getHistoryList(){var param={ProjectNo:projectNumber,OrderNo:orderNo,ActivityNo:root===\"listCard\"?activityNo:\"\",Description:root===\"listCard\"?documentDescription:\"\",foe:foe,region:region,branch:branch};fetchHistoryList(param).then(function(res){var newData=res.data.map(function(item,index){return{nonConformities:item.nonConformities,versionIdentifier:res.data.length-index};});var historyData=[].concat(_toConsumableArray(data),_toConsumableArray(newData));var result=Array.from(new Set(historyData.map(JSON.stringify))).map(JSON.parse);setData(result);});};var closeNonConfirmityItems=function closeNonConfirmityItems(checkContent){var _checkContent$nonConf;var filteredData=checkContent===null||checkContent===void 0?void 0:(_checkContent$nonConf=checkContent.nonConformities)===null||_checkContent$nonConf===void 0?void 0:_checkContent$nonConf.filter(function(item){return item.nonConformityItems.some(function(subItem){return subItem.itemValue===\"yes\";});});var checkedData=filteredData.map(function(item){return{documentInfo:{projectNo:projectNumber,orderNo:orderNo,activityNo:item.activityNo,description:item.documentName,foe:foe,region:region,branch:branch},items:item.nonConformityItems};});if(checkedData.length<1){alert(\"至少要选择一个不符合项\");return false;}closeNonConfirmity(checkedData).then(function(res){setOpen(false);});};var getNoConformityList=function getNoConformityList(param){setTitle(i18n.NONCONFORMITY_LIST);fetchNoConformityList(param).then(function(res){setOpen(true);res.data[\"versionIdentifier\"]=\"Latest\";setData(res.data);});};var showButton=showUploadButton()?showUploadButton()&&DisableTheEntranceroot&&canUploadDoc:DisableTheEntranceroot&&canUploadDoc;var history=useHistory();return/*#__PURE__*/React.createElement(Accordion,{expanded:expanded,onChange:handleChange},/*#__PURE__*/React.createElement(AccordionSummary,{className:classes.root},/*#__PURE__*/React.createElement(ArrowRightIcon,{className:expanded?classes.navIcon:\"\"}),mandDoc===\"X\"?/*#__PURE__*/React.createElement(Typography,{color:\"error\"},documentDescription,\"*\"):/*#__PURE__*/React.createElement(Typography,null,documentDescription),showButton&&/*#__PURE__*/React.createElement(AddCircleOutlineIcon,{color:\"error\",className:classes.add,onClick:function onClick(event){event.stopPropagation();history.push(\"/template/\".concat(documentNo,\"/\").concat(documentPart,\"/\").concat(activityNo,\"/\").concat(orderNo,\"/\").concat(projectNumber,\"/\").concat(productFamily,\"/\").concat(productLine,\"/\").concat(language));}})),/*#__PURE__*/React.createElement(AccordionDetails,null,/*#__PURE__*/React.createElement(Box,null,documents[0]&&(root===\"installationChecklist\"?documents:Array.from(new Set(documents)).filter(function(item){return item.name.indexOf(documentDescription)>-1&&item.name===documentDescription+\".pdf\";})).map(function(item,index){return/*#__PURE__*/React.createElement(Grid,{className:classes.documentName,key:index,item:true,xs:12,onClick:function onClick(){setTitle(documentDescription);handleClickOpen(item.name);}},item.name);}))),documents.length>0&&/*#__PURE__*/React.createElement(Box,null,/*#__PURE__*/React.createElement(Divider,null),/*#__PURE__*/React.createElement(AccordionActions,null,/*#__PURE__*/React.createElement(Button,{size:\"small\",color:\"secondary\",onClick:function onClick(){var param={ProjectNo:projectNumber,OrderNo:orderNo,ActivityNo:activityNo,Description:documentDescription,foe:foe,region:region,branch:branch};root===\"installationChecklist\"&&delete param.ActivityNo;getNoConformityList(param);}},i18n.VIEW_NONCONFORMANCE_ITEMS))),/*#__PURE__*/React.createElement(Model,{open:open,title:title,handleClose:handleClose},modelContent));});var DocumentsPage=withStyles(function(_ref5){var spacing=_ref5.spacing;return{root:{margin:spacing(2)},content:{marginBottom:spacing(5)},title:{lineHeight:\"2.5\"}};})(function(_ref6){var descriptionShort=_ref6.descriptionShort,classes=_ref6.classes,data=_ref6.data,orderNo=_ref6.orderNo,projectNumber=_ref6.projectNumber,fetchPdf=_ref6.fetchPdf,documents=_ref6.documents,foe=_ref6.foe,region=_ref6.region,branch=_ref6.branch,DisableTheEntranceroot=_ref6.DisableTheEntranceroot,canUploadDoc=_ref6.canUploadDoc,root=_ref6.root,fetchNoConformityList=_ref6.fetchNoConformityList,getHistoryList=_ref6.getHistoryList,nonConformityConfig=_ref6.nonConformityConfig,closeNonConfirmityItems=_ref6.closeNonConfirmityItems;var i18n=React.useContext(LocalizeContext);var _React$useState13=React.useState(i18n.INSTALLATION_ACTIVITY_DOCUMENT),_React$useState14=_slicedToArray(_React$useState13,2),pageDescription=_React$useState14[0],setPageDescription=_React$useState14[1];var pageSource=root===\"minCard\"?\"all\":root===\"listCard\"?\"pending\":\"basic\";useEffect(function(){if(root===\"installationChecklist\")setPageDescription(i18n.INSTALLATION_CHECKLIST);},[root,i18n]);return/*#__PURE__*/React.createElement(PrimaryLayout,{name:\"activity Document\",root:pageSource,title:pageDescription},/*#__PURE__*/React.createElement(Box,{className:classes.root},/*#__PURE__*/React.createElement(Box,{fontSize:\"h6.fontSize\",fontWeight:\"fontWeightMedium\",my:1},\"\".concat(orderNo)),/*#__PURE__*/React.createElement(Typography,{variant:\"body1\",className:classes.title},descriptionShort),/*#__PURE__*/React.createElement(Box,{className:classes.content},data.map(function(item,index){return/*#__PURE__*/React.createElement(Template,{template:item,key:index,orderNo:orderNo,projectNumber:projectNumber,fetchPdf:fetchPdf,documents:documents,foe:foe,region:region,branch:branch,DisableTheEntranceroot:DisableTheEntranceroot,canUploadDoc:canUploadDoc,fetchNoConformityList:fetchNoConformityList,root:root,i18n:i18n,fetchHistoryList:getHistoryList,nonConformityConfig:nonConformityConfig,closeNonConfirmity:closeNonConfirmityItems});}))));});export default connect(function(_ref7,_ref8){var _orders$orderNo,_orders$orderNo2,_orders$orderNo3,_documentList$project,_documentList$project2;var activities=_ref7.activities,orderActivities=_ref7.orderActivities,documentList=_ref7.documentList,templates=_ref7.templates,orders=_ref7.orders,auth=_ref7.auth,nonConformityConfig=_ref7.nonConformityConfig;var _ref8$match$params=_ref8.match.params,activityNo=_ref8$match$params.activityNo,orderNo=_ref8$match$params.orderNo,productFamily=_ref8$match$params.productFamily,root=_ref8$match$params.root;var projectNumber=(_orders$orderNo=orders[orderNo])===null||_orders$orderNo===void 0?void 0:_orders$orderNo.projectNumber;var productCategory=(_orders$orderNo2=orders[orderNo])===null||_orders$orderNo2===void 0?void 0:_orders$orderNo2.productCategory;var productLine=(_orders$orderNo3=orders[orderNo])===null||_orders$orderNo3===void 0?void 0:_orders$orderNo3.productLine;var templatesData=templates[activityNo]||[];var order=orders===null||orders===void 0?void 0:orders[orderNo];var documents=[];var documentsItem=(_documentList$project=documentList[projectNumber])===null||_documentList$project===void 0?void 0:(_documentList$project2=_documentList$project[orderNo])===null||_documentList$project2===void 0?void 0:_documentList$project2[activityNo];var data=getTemplateList(templatesData,productLine,productFamily,productCategory);var description=data.map(function(item){return item.documentDescription;});description.forEach(function(item){return documentsItem&&documentsItem.filter(function(ele){return ele.name.indexOf(item)>-1&&documents.push(ele);})||[];});var docAuthActivityNos=documentAuthorizationC(orderActivities,orderNo,auth.activityAuth,auth.roles[0]);var canUploadDoc=docAuthActivityNos.includes(activityNo);var _ref9=activities[activityNo]||{},descriptionShort=_ref9.descriptionShort,descriptionShort14=_ref9.descriptionShort14;var title=orderActivities[orderNo+\"-7030\"]?descriptionShort14?descriptionShort14:descriptionShort:descriptionShort;if(root===\"installationChecklist\"){var _documentList$project3,_documentList$project4;var template={mandDoc:\"Y\",documentDescription:\"\\u5B89\\u88C5\\u68C0\\u67E5\\u6E05\\u5355\"};data.push(template);documents.push(documentList===null||documentList===void 0?void 0:(_documentList$project3=documentList[projectNumber])===null||_documentList$project3===void 0?void 0:(_documentList$project4=_documentList$project3[orderNo])===null||_documentList$project4===void 0?void 0:_documentList$project4[activityNo][0]);}return{data:data,descriptionShort:title,orderNo:orderNo,projectNumber:projectNumber,documents:documents,foe:order===null||order===void 0?void 0:order.fo,region:order===null||order===void 0?void 0:order.region,branch:order===null||order===void 0?void 0:order.prctr,DisableTheEntranceroot:root===\"listCard\",canUploadDoc:canUploadDoc,root:root,nonConformityConfig:nonConformityConfig};},function(dispatch){return{fetchPdf:function fetchPdf(data){return dispatch(action.fetchPdf(data));},fetchNoConformityList:function fetchNoConformityList(data){return dispatch(action.getNoConformityList(data));},getHistoryList:function getHistoryList(data){return dispatch(action.getHistoryList(data));},closeNonConfirmityItems:function closeNonConfirmityItems(data){return dispatch(action.closeNonConfirmityItems(data));}};})(DocumentsPage);","map":{"version":3,"sources":["C:/project/SCF-NI_PM_App/SCF.InstallationQuality/react-client/src/pages/DocumentsPage/index.js"],"names":["Accordion","AccordionDetails","AccordionSummary","Box","Grid","Typography","withStyles","Divider","Button","AccordionActions","List","Checkbox","AddCircleOutlineIcon","ArrowRightIcon","action","Model","Pdf","LocalizeContext","documentAuthorizationC","getTemplateList","showUploadButton","PrimaryLayout","React","useEffect","connect","useHistory","Square","Triangle","makeStyles","getSquareORTriangle","type","imgSource","getSpecifyStr","item","str","splitChar","split","find","e","startsWith","findIndex","slice","dynamicDisplay","root","config","version","closeEnabledInOILScreen","useStyles","spacing","margin","minHeight","paddingTop","ListofIncongruentItems","data","getHistoryList","nonConformityConfig","activityNo","closeNonConfirmityItems","i18n","useContext","useState","expanded","setExpanded","classes","handleChange","event","newExpanded","canClick","marginBottom","display","justifyContent","nonConformities","nonConformityItems","length","alert","setTimeout","Close_NONCONFORMANCE_ITEMS","transform","width","map","key","index","fontWeight","documentName","itemName","paddingLeft","marginTop","questionType","textAlign","padding","checkedVlaue","target","checked","Template","add","marginLeft","navIcon","template","documentNo","documentPart","mandDoc","documentDescription","productFamily","productLine","language","orderNo","projectNumber","fetchPdf","documents","foe","region","branch","DisableTheEntranceroot","canUploadDoc","fetchNoConformityList","fetchHistoryList","closeNonConfirmity","open","setOpen","modelContent","setModelContent","title","setTitle","setData","versionIdentifier","handleClickOpen","name","ProjectNo","OrderNo","ActivityNo","DocumentName","then","url","handleClose","param","Description","res","newData","historyData","result","Array","from","Set","JSON","stringify","parse","checkContent","filteredData","filter","some","subItem","itemValue","checkedData","documentInfo","projectNo","description","items","getNoConformityList","NONCONFORMITY_LIST","showButton","history","stopPropagation","push","indexOf","VIEW_NONCONFORMANCE_ITEMS","DocumentsPage","content","lineHeight","descriptionShort","INSTALLATION_ACTIVITY_DOCUMENT","pageDescription","setPageDescription","pageSource","INSTALLATION_CHECKLIST","activities","orderActivities","documentList","templates","orders","auth","match","params","productCategory","templatesData","order","documentsItem","forEach","ele","docAuthActivityNos","activityAuth","roles","includes","descriptionShort14","fo","prctr","dispatch"],"mappings":"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","sourcesContent":["import {\r\n  Accordion,\r\n  AccordionDetails,\r\n  AccordionSummary,\r\n  Box,\r\n  Grid,\r\n  Typography,\r\n  withStyles,\r\n  Divider,\r\n  Button,\r\n  AccordionActions,\r\n  List,\r\n  Checkbox\r\n} from \"@material-ui/core\";\r\nimport AddCircleOutlineIcon from \"@material-ui/icons/AddCircleOutline\";\r\nimport ArrowRightIcon from \"@material-ui/icons/ArrowRight\";\r\nimport * as action from \"actions\";\r\nimport Model from \"components/Model\";\r\nimport Pdf from \"components/Pdf\";\r\nimport { LocalizeContext } from \"i18n\";\r\nimport { documentAuthorizationC } from \"js/publicFn\";\r\nimport { getTemplateList,  showUploadButton } from \"js/util\";\r\nimport PrimaryLayout from \"layouts/PrimaryLayout\";\r\nimport React, { useEffect } from \"react\";\r\nimport { connect } from \"react-redux\";\r\nimport { useHistory } from \"react-router-dom\";\r\nimport Square from \"img/square.png\"\r\nimport Triangle from \"img/triangle.png\"\r\nimport { makeStyles } from \"@material-ui/styles\";\r\n\r\n\r\nconst getSquareORTriangle = (type) => {\r\n  let imgSource = type === \"Square\" ? Square : type === \"Triangle\" ? Triangle : \"No\";\r\n  return imgSource === \"No\" ? imgSource : <img src={imgSource} alt=\"\" />\r\n}\r\n\r\nconst getSpecifyStr = (item) => {\r\n  const str = \"Chinese:\";\r\n  var splitChar = item.split(\"||\");\r\n\r\n  return splitChar\r\n    .find((e) => {\r\n      return (\r\n        e.startsWith(str) ||\r\n        (splitChar.findIndex((e) => e.startsWith(str)) === -1 && splitChar[0])\r\n      );\r\n    })\r\n    .split(\":\")\r\n    .slice(-1)[0];\r\n};\r\n\r\n// const isShowUpLoadButon = (allowreupload, param, documents) => {\r\n//   if (documents.length > 0) {\r\n//     if (!allowreupload) {\r\n//       return false\r\n//     } else {\r\n//       if (getChecklistActivityNo(param)) {\r\n//         return false\r\n//       } else {\r\n//         return true;\r\n//       }\r\n//     }\r\n//   } else {\r\n//     return true\r\n//   }\r\n// }\r\n\r\nconst dynamicDisplay = (root, config, version) => {\r\n  if (root === \"listCard\") {\r\n    if (version !== \"Latest\") {\r\n      return false\r\n    }\r\n    return config.closeEnabledInOILScreen\r\n  } else if (root === \"installationChecklist\") {\r\n    if (version !== \"Latest\") {\r\n      return false\r\n    } else {\r\n      return true\r\n    }\r\n\r\n  }\r\n  return false\r\n}\r\n\r\nconst useStyles = makeStyles(({ spacing }) => ({\r\n  root: {\r\n    \"& .MuiAccordionSummary-content.Mui-expanded\": {\r\n      margin: 0\r\n    },\r\n    \"& .MuiAccordionSummary-content\": {\r\n      margin: 0\r\n    },\r\n    \"& .MuiAccordionSummary-root.Mui-expanded\": {\r\n      minHeight: \"auto\",\r\n      paddingTop: spacing(1)\r\n    }\r\n\r\n  },\r\n}))\r\n\r\nconst ListofIncongruentItems = ({ data, getHistoryList, version, root, nonConformityConfig, activityNo, closeNonConfirmityItems }) => {\r\n  const i18n = React.useContext(LocalizeContext);\r\n  const [expanded, setExpanded] = React.useState(true);\r\n\r\n  const classes = useStyles();\r\n\r\n  const handleChange = (event, newExpanded) => {\r\n    setExpanded(newExpanded);\r\n  };\r\n\r\n  let canClick = true;\r\n\r\n  return <List component=\"nav\" aria-label=\"contacts\" style={{ marginBottom: 20 }}>\r\n    {version === \"Latest\" &&\r\n      <Box style={{ display: \"flex\", justifyContent: \"space-between\" }}>\r\n        <Button size=\"large\" color=\"secondary\" onClick={() => getHistoryList()}>历史</Button>\r\n        {dynamicDisplay(root, nonConformityConfig[activityNo], version) && data.nonConformities.find(item => item.nonConformityItems.length > 0) &&\r\n          <Button size=\"large\" color=\"secondary\" onClick={() =>\r\n            \r\n          {\r\n            if (!canClick) {\r\n              alert('请稍候再试！');\r\n              return;\r\n            };\r\n\r\n            setTimeout(() => {\r\n              canClick = true;\r\n            }, 2000); \r\n        \r\n            canClick = false;\r\n            closeNonConfirmityItems(data)\r\n          }\r\n          \r\n          }>{i18n.Close_NONCONFORMANCE_ITEMS}</Button>\r\n        }\r\n      </Box>\r\n    }\r\n    <Accordion className={classes.root} style={{ margin: \"0 16px\" }} expanded={expanded} onChange={handleChange}>\r\n      <AccordionSummary style={{ margin: 0 }}>\r\n        <ArrowRightIcon fontSize=\"large\" style={expanded ? { transform: \"rotate(90deg)\" } : {}} />\r\n        <Typography variant=\"h6\">{version === \"Latest\" ? `当前版本` : `版本：${version}`}</Typography>\r\n      </AccordionSummary>\r\n      <AccordionDetails>\r\n        <Box style={{ width: \"100%\" }}>\r\n          {data.nonConformities.map((key, index) => {\r\n            return (\r\n              <Box key={index} ml={2} mr={2}>\r\n                <Typography\r\n                  style={{ fontWeight: 600 }}\r\n                  gutterBottom\r\n                  variant=\"body2\"\r\n                  component=\"h2\"\r\n                >\r\n                  {key.documentName}\r\n                </Typography>\r\n                <Box>\r\n                  {key.nonConformityItems.map((item, index) => {\r\n                    return (\r\n                      <Grid key={index} container >\r\n                        <Grid item xs={8}>\r\n                          <Typography variant=\"caption\">{getSpecifyStr(item.itemName)}</Typography>\r\n                        </Grid>\r\n                        <Grid item xs={2}>\r\n                          <p style={{ fontWeight: 800, paddingLeft: 24, marginBottom: 0, marginTop: 8 }}> {getSquareORTriangle(item.questionType)}</p>\r\n                        </Grid>\r\n                        <Grid item xs={2} style={{ textAlign: \"end\" }}>\r\n                          {dynamicDisplay(root, nonConformityConfig[activityNo], version) &&\r\n                            <Checkbox\r\n                              style={{ padding: 4 }}\r\n                              color=\"default\"\r\n                              inputProps={{ 'aria-label': 'checkbox with default color' }}\r\n                              onChange={(event) => {\r\n                                let checkedVlaue = event.target.checked;\r\n                                item[\"itemValue\"] = checkedVlaue ? \"yes\" : \"no\"\r\n                                item[\"activityNo\"] = key.activityNo\r\n\r\n                              }}\r\n                            />\r\n                          }\r\n                        </Grid>\r\n                      </Grid>\r\n                    );\r\n                  })}\r\n                </Box>\r\n              </Box>\r\n            );\r\n          })}\r\n        </Box>\r\n      </AccordionDetails>\r\n    </Accordion>\r\n\r\n  </List>\r\n};\r\n\r\n\r\nconst Template = withStyles(({ spacing }) => ({\r\n  root: {\r\n    padding: 0,\r\n  },\r\n  add: {\r\n    marginLeft: spacing(5),\r\n  },\r\n  navIcon: {\r\n    transform: \"rotate(90deg)\",\r\n  },\r\n  documentName: {\r\n    marginLeft: spacing(1),\r\n  },\r\n}))(\r\n  ({\r\n    classes,\r\n    template: {\r\n      activityNo,\r\n      documentNo,\r\n      documentPart,\r\n      mandDoc,\r\n      documentDescription,\r\n      productFamily,\r\n      productLine,\r\n      language,\r\n    },\r\n    orderNo,\r\n    projectNumber,\r\n    fetchPdf,\r\n    documents,\r\n    foe,\r\n    region,\r\n    branch,\r\n    DisableTheEntranceroot,\r\n    canUploadDoc,\r\n    fetchNoConformityList,\r\n    root,\r\n    i18n,\r\n    fetchHistoryList,\r\n    nonConformityConfig,\r\n    closeNonConfirmity\r\n  }) => {\r\n    const [expanded, setExpanded] = React.useState(true);\r\n    const [open, setOpen] = React.useState(false);\r\n    const [modelContent, setModelContent] = React.useState();\r\n    const [title, setTitle] = React.useState(documentDescription);\r\n    const [data, setData] = React.useState([]);\r\n    useEffect(() => {\r\n      setModelContent(\r\n        data.map((item, index) =>\r\n          < ListofIncongruentItems\r\n            key={index}\r\n            data={item}\r\n            getHistoryList={getHistoryList}\r\n            version={item?.versionIdentifier}\r\n            root={root}\r\n            nonConformityConfig={nonConformityConfig}\r\n            activityNo={activityNo}\r\n            closeNonConfirmityItems={closeNonConfirmityItems}\r\n          />))\r\n      // eslint-disable-next-line\r\n    }, [data]);\r\n\r\n\r\n    const handleClickOpen = (name) => {\r\n      const data = {\r\n        ProjectNo: projectNumber,\r\n        OrderNo: orderNo,\r\n        ActivityNo: activityNo,\r\n        DocumentName: name,\r\n        foe,\r\n        region,\r\n        branch,\r\n      };\r\n      root === \"installationChecklist\" && delete data.ActivityNo;\r\n      fetchPdf(data).then((url) => {\r\n        setOpen(true);\r\n        setModelContent(<Pdf filePath={url} />);\r\n      });\r\n    };\r\n\r\n    const handleClose = () => {\r\n      setOpen(false);\r\n    };\r\n\r\n    const handleChange = (event, newExpanded) => {\r\n      setExpanded(newExpanded);\r\n    };\r\n\r\n    const getHistoryList = () => {\r\n      const param = {\r\n        ProjectNo: projectNumber,\r\n        OrderNo: orderNo,\r\n        ActivityNo: root === \"listCard\" ? activityNo : \"\",\r\n        Description: root === \"listCard\" ? documentDescription : \"\",\r\n        foe,\r\n        region,\r\n        branch,\r\n      };\r\n      fetchHistoryList(param).then((res) => {\r\n        const newData = res.data.map((item, index) => {\r\n          return {\r\n            nonConformities: item.nonConformities,\r\n            versionIdentifier: res.data.length - index\r\n          }\r\n        });\r\n        const historyData = [\r\n          ...data, ...newData\r\n        ]\r\n        const result = Array.from(new Set(historyData.map(JSON.stringify))).map(JSON.parse);\r\n        setData(result)\r\n      })\r\n    }\r\n\r\n    const closeNonConfirmityItems = (checkContent) => {\r\n\r\n      const filteredData = checkContent?.nonConformities?.filter(item => {\r\n        return item.nonConformityItems.some(subItem => subItem.itemValue === \"yes\");\r\n      });\r\n\r\n      let checkedData = filteredData.map((item) => {\r\n        return {\r\n          documentInfo: {\r\n            projectNo: projectNumber,\r\n            orderNo: orderNo,\r\n            activityNo: item.activityNo,\r\n            description: item.documentName,\r\n            foe,\r\n            region,\r\n            branch,\r\n          },\r\n          items: item.nonConformityItems,\r\n        }\r\n      })\r\n\r\n      if (checkedData.length < 1) {\r\n        alert(\"至少要选择一个不符合项\")\r\n        return false\r\n      }\r\n      closeNonConfirmity(checkedData).then((res) => {\r\n        setOpen(false);\r\n      })\r\n    }\r\n\r\n\r\n    const getNoConformityList = (param) => {\r\n      setTitle(i18n.NONCONFORMITY_LIST);\r\n      fetchNoConformityList(param).then((res) => {\r\n        setOpen(true);\r\n        res.data[\"versionIdentifier\"] = \"Latest\"\r\n        setData(res.data)\r\n      })\r\n    }\r\n    const showButton = showUploadButton() ? (showUploadButton() && DisableTheEntranceroot && canUploadDoc) : (DisableTheEntranceroot && canUploadDoc)\r\n    const history = useHistory();\r\n    return (\r\n      <Accordion expanded={expanded} onChange={handleChange}>\r\n        <AccordionSummary className={classes.root}>\r\n          <ArrowRightIcon className={expanded ? classes.navIcon : \"\"} />\r\n          {mandDoc === \"X\" ? (\r\n            <Typography color=\"error\">{documentDescription}*</Typography>\r\n          ) : (\r\n            <Typography>{documentDescription}</Typography>\r\n          )}\r\n\r\n          {showButton &&\r\n            (\r\n              <AddCircleOutlineIcon\r\n                color=\"error\"\r\n                className={classes.add}\r\n                onClick={(event) => {\r\n                  event.stopPropagation();\r\n                  history.push(\r\n                    `/template/${documentNo}/${documentPart}/${activityNo}/${orderNo}/${projectNumber}/${productFamily}/${productLine}/${language}`\r\n                  );\r\n                }}\r\n              />\r\n             )}\r\n        </AccordionSummary>\r\n        <AccordionDetails>\r\n          <Box>\r\n            {documents[0] &&\r\n              (root === \"installationChecklist\"\r\n                ? documents\r\n                : Array.from(new Set(documents)).filter((item) => {\r\n                  return (\r\n                    item.name.indexOf(documentDescription) > -1 &&\r\n                    item.name === documentDescription + \".pdf\"\r\n                  );\r\n                })\r\n              ).map((item, index) => {\r\n                return (\r\n                  <Grid\r\n                    className={classes.documentName}\r\n                    key={index}\r\n                    item\r\n                    xs={12}\r\n                    onClick={() => {\r\n                      setTitle(documentDescription);\r\n                      handleClickOpen(item.name);\r\n                    }}\r\n                  >\r\n                    {item.name}\r\n                  </Grid>\r\n                );\r\n              })}\r\n          </Box>\r\n        </AccordionDetails>\r\n        {documents.length > 0 && (\r\n          <Box>\r\n            <Divider />\r\n            <AccordionActions>\r\n              <Button\r\n                size=\"small\"\r\n                color=\"secondary\"\r\n                onClick={() => {\r\n                  const param = {\r\n                    ProjectNo: projectNumber,\r\n                    OrderNo: orderNo,\r\n                    ActivityNo: activityNo,\r\n                    Description: documentDescription,\r\n                    foe,\r\n                    region,\r\n                    branch,\r\n                  };\r\n                  root === \"installationChecklist\" && delete param.ActivityNo;\r\n                  getNoConformityList(param);\r\n                }}\r\n              >\r\n                {i18n.VIEW_NONCONFORMANCE_ITEMS}\r\n              </Button>\r\n            </AccordionActions>\r\n          </Box>\r\n        )}\r\n        <Model open={open} title={title} handleClose={handleClose}>\r\n          {modelContent}\r\n        </Model>\r\n      </Accordion>\r\n    );\r\n  }\r\n);\r\n\r\nconst DocumentsPage = withStyles(({ spacing }) => ({\r\n  root: {\r\n    margin: spacing(2),\r\n  },\r\n  content: {\r\n    marginBottom: spacing(5),\r\n  },\r\n  title: {\r\n    lineHeight: \"2.5\",\r\n  },\r\n}))(\r\n  ({\r\n    descriptionShort,\r\n    classes,\r\n    data,\r\n    orderNo,\r\n    projectNumber,\r\n    fetchPdf,\r\n    documents,\r\n    foe,\r\n    region,\r\n    branch,\r\n    DisableTheEntranceroot,\r\n    canUploadDoc,\r\n    root,\r\n    fetchNoConformityList,\r\n    getHistoryList,\r\n    nonConformityConfig,\r\n    closeNonConfirmityItems\r\n  }) => {\r\n    const i18n = React.useContext(LocalizeContext);\r\n    const [pageDescription, setPageDescription] = React.useState(\r\n      i18n.INSTALLATION_ACTIVITY_DOCUMENT\r\n    );\r\n\r\n    const pageSource =\r\n      root === \"minCard\" ? \"all\" : root === \"listCard\" ? \"pending\" : \"basic\";\r\n\r\n    useEffect(() => {\r\n      if (root === \"installationChecklist\")\r\n        setPageDescription(i18n.INSTALLATION_CHECKLIST);\r\n    }, [root, i18n]);\r\n    return (\r\n      <PrimaryLayout\r\n        name=\"activity Document\"\r\n        root={pageSource}\r\n        title={pageDescription}\r\n      >\r\n        <Box className={classes.root}>\r\n          <Box\r\n            fontSize=\"h6.fontSize\"\r\n            fontWeight=\"fontWeightMedium\"\r\n            my={1}\r\n          >{`${orderNo}`}</Box>\r\n          <Typography variant=\"body1\" className={classes.title}>\r\n            {descriptionShort}\r\n          </Typography>\r\n          <Box className={classes.content}>\r\n            {data.map((item, index) => {\r\n              return (\r\n                <Template\r\n                  template={item}\r\n                  key={index}\r\n                  orderNo={orderNo}\r\n                  projectNumber={projectNumber}\r\n                  fetchPdf={fetchPdf}\r\n                  documents={documents}\r\n                  foe={foe}\r\n                  region={region}\r\n                  branch={branch}\r\n                  DisableTheEntranceroot={DisableTheEntranceroot}\r\n                  canUploadDoc={canUploadDoc}\r\n                  fetchNoConformityList={fetchNoConformityList}\r\n                  root={root}\r\n                  i18n={i18n}\r\n                  fetchHistoryList={getHistoryList}\r\n                  nonConformityConfig={nonConformityConfig}\r\n                  closeNonConfirmity={closeNonConfirmityItems}\r\n                />\r\n              );\r\n            })}\r\n          </Box>\r\n        </Box>\r\n      </PrimaryLayout>\r\n    );\r\n  }\r\n);\r\n\r\nexport default connect(\r\n  (\r\n    { activities, orderActivities, documentList, templates, orders, auth, nonConformityConfig },\r\n    {\r\n      match: {\r\n        params: { activityNo, orderNo, productFamily, root },\r\n      },\r\n    }\r\n  ) => {\r\n    const projectNumber = orders[orderNo]?.projectNumber;\r\n    const productCategory = orders[orderNo]?.productCategory;\r\n    const productLine = orders[orderNo]?.productLine;\r\n    const templatesData = templates[activityNo] || [];\r\n    let order = orders?.[orderNo];\r\n    const documents = [];\r\n    const documentsItem = documentList[projectNumber]?.[orderNo]?.[activityNo];\r\n\r\n    const data = getTemplateList(templatesData, productLine, productFamily, productCategory);\r\n    const description = data.map((item) => {\r\n      return item.documentDescription;\r\n    });\r\n\r\n\r\n    description.forEach((item) => {\r\n      return (\r\n        (documentsItem &&\r\n          documentsItem.filter(\r\n            (ele) => ele.name.indexOf(item) > -1 && documents.push(ele)\r\n          )) ||\r\n        []\r\n      );\r\n    });\r\n\r\n    const docAuthActivityNos = documentAuthorizationC(\r\n      orderActivities,\r\n      orderNo,\r\n      auth.activityAuth,\r\n      auth.roles[0]\r\n    );\r\n\r\n    const canUploadDoc = docAuthActivityNos.includes(activityNo);\r\n\r\n    const { descriptionShort, descriptionShort14 } =\r\n      activities[activityNo] || {};\r\n\r\n    const title = orderActivities[orderNo + \"-7030\"]\r\n      ? descriptionShort14\r\n        ? descriptionShort14\r\n        : descriptionShort\r\n      : descriptionShort;\r\n\r\n    if (root === \"installationChecklist\") {\r\n      const template = {\r\n        mandDoc: \"Y\",\r\n        documentDescription: `安装检查清单`,\r\n      };\r\n\r\n      data.push(template);\r\n\r\n      documents.push(documentList?.[projectNumber]?.[orderNo]?.[activityNo][0]);\r\n    }\r\n\r\n    return {\r\n      data: data,\r\n      descriptionShort: title,\r\n      orderNo,\r\n      projectNumber,\r\n      documents,\r\n      foe: order?.fo,\r\n      region: order?.region,\r\n      branch: order?.prctr,\r\n      DisableTheEntranceroot: root === \"listCard\",\r\n      canUploadDoc,\r\n      root: root,\r\n      nonConformityConfig\r\n    };\r\n  },\r\n  (dispatch) => {\r\n    return {\r\n      fetchPdf: (data) => {\r\n        return dispatch(action.fetchPdf(data));\r\n      },\r\n\r\n      fetchNoConformityList: (data) => {\r\n        return dispatch(action.getNoConformityList(data));\r\n      },\r\n\r\n      getHistoryList: (data) => {\r\n        return dispatch(action.getHistoryList(data));\r\n      },\r\n\r\n      closeNonConfirmityItems: (data) => {\r\n        return dispatch(action.closeNonConfirmityItems(data));\r\n\r\n      }\r\n\r\n    };\r\n  }\r\n)(DocumentsPage);\r\n"]},"metadata":{},"sourceType":"module"}