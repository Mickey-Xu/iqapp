{"ast":null,"code":"import _defineProperty from\"C:\\\\project\\\\SCF-NI_PM_App\\\\SCF.InstallationQuality\\\\react-client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/defineProperty\";import _objectSpread from\"C:\\\\project\\\\SCF-NI_PM_App\\\\SCF.InstallationQuality\\\\react-client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/objectSpread2\";import{Box,Button}from\"@material-ui/core\";import{withStyles}from\"@material-ui/core/styles\";import*as action from\"actions\";import schindler from\"assets/img/logo.png\";import Alert from\"components/Alert\";import Form,{Checkbox,hasError,Password,PhoneNumber,validate}from\"components/Form\";import Loading from\"components/Loading\";import React from\"react\";import{connect}from\"react-redux\";import{useHistory}from\"react-router-dom\";import store from\"js/store\";var LoginPage=withStyles(function(){return{root:{position:\"absolute\",height:\"100%\",width:\"100%\",backgroundColor:\"white\",padding:\"16vh 16px\"},logo:{display:\"flex\",justifyContent:\"center\"},title:{textAlign:\"center\",color:\"rgb(220,2,2)\"},submit:{textTransform:\"none\",color:\"white\",backgroundColor:\"rgb(220,2,2)\"}};})(function(_ref){var classes=_ref.classes,data=_ref.data,loading=_ref.loading,location=_ref.location,onChange=_ref.onChange,submit=_ref.submit,setAuth=_ref.setAuth;var history=useHistory();var fields=[{name:\"userNameOrEmailAddress\",component:PhoneNumber,label:\" 工号/手机号\",required:true},{name:\"password\",component:Password,label:\"密码\",required:true},{name:\"rememberMe\",component:Checkbox,label:\"记住密码\"}];var validation=validate(fields,data);var onSubmit=function onSubmit(){if(data[\"userNameOrEmailAddress\"]===undefined||data[\"userNameOrEmailAddress\"]===\"\"){alert(\" 工号/手机号\");}else if(data[\"password\"]===undefined||data[\"password\"]===\"\"){alert(\"请输入密码\");}if(!hasError(validation)){submit(data).then(function(res){if(res===null||res===void 0?void 0:res.isPwdInit){var firstLogin=true;setAuth(data);window.localStorage.setItem(\"auth\",JSON.stringify(data));history.push({pathname:\"/newUserResetPassword/\".concat(firstLogin,\"/\").concat(data.password)});}else{var _store$getState,_store$getState$auth,_store$getState$auth$;console.log();if(((_store$getState=store.getState())===null||_store$getState===void 0?void 0:(_store$getState$auth=_store$getState.auth)===null||_store$getState$auth===void 0?void 0:(_store$getState$auth$=_store$getState$auth[\"roles\"])===null||_store$getState$auth$===void 0?void 0:_store$getState$auth$[0])===\"SL\"){history.push({pathname:\"/synchronize\"});}else{history.push({pathname:\"/activities\"});}}});}};return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(Box,{className:classes.root},/*#__PURE__*/React.createElement(Box,{className:classes.logo},/*#__PURE__*/React.createElement(\"img\",{src:schindler,alt:\"Schindler Logo\",style:{height:\"16vh\"}})),/*#__PURE__*/React.createElement(Box,{mt:3,mb:2,className:classes.title,fontSize:\"h6.fontSize\",fontWeight:\"fontWeightBold\"},\"SCF NI INSTALLATION QUALITY\"),/*#__PURE__*/React.createElement(Box,{my:2},/*#__PURE__*/React.createElement(Form,{fields:fields,onChange:onChange,validation:validation})),/*#__PURE__*/React.createElement(Box,{my:2},/*#__PURE__*/React.createElement(Button,{disabled:loading,style:{backgroundColor:\"rgb(220,2,2)\",color:\"white\"},fullWidth:true,onClick:onSubmit,size:\"large\",variant:\"contained\"},\"\\u767B\\u5F55\"))),/*#__PURE__*/React.createElement(Loading,null),/*#__PURE__*/React.createElement(Alert,null));});export default connect(function(_ref2){var formData=_ref2.formData,loading=_ref2.loading;return{data:formData,loading:loading};},function(dispatch){return{onChange:function onChange(data){return function(name,value){if(name===\"username\"&&!value){var _objectSpread2;dispatch(action.setFormData(_objectSpread(_objectSpread({},data),{},(_objectSpread2={},_defineProperty(_objectSpread2,name,value),_defineProperty(_objectSpread2,\"rememberMe\",false),_objectSpread2))));}else{dispatch(action.setFormData(_objectSpread(_objectSpread({},data),{},_defineProperty({},name,value))));}};},submit:function submit(data){return dispatch(action.login(data));},setAuth:function setAuth(data){dispatch(action.setAuth(data));}};})(LoginPage);","map":{"version":3,"sources":["C:/project/SCF-NI_PM_App/SCF.InstallationQuality/react-client/src/pages/LoginPage/index.js"],"names":["Box","Button","withStyles","action","schindler","Alert","Form","Checkbox","hasError","Password","PhoneNumber","validate","Loading","React","connect","useHistory","store","LoginPage","root","position","height","width","backgroundColor","padding","logo","display","justifyContent","title","textAlign","color","submit","textTransform","classes","data","loading","location","onChange","setAuth","history","fields","name","component","label","required","validation","onSubmit","undefined","alert","then","res","isPwdInit","firstLogin","window","localStorage","setItem","JSON","stringify","push","pathname","password","console","log","getState","auth","formData","dispatch","value","setFormData","login"],"mappings":"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","sourcesContent":["import { Box, Button } from \"@material-ui/core\";\r\nimport { withStyles } from \"@material-ui/core/styles\";\r\nimport * as action from \"actions\";\r\nimport schindler from \"assets/img/logo.png\";\r\nimport Alert from \"components/Alert\";\r\nimport Form, {\r\n  Checkbox,\r\n  hasError,\r\n  Password,\r\n  PhoneNumber,\r\n  validate,\r\n} from \"components/Form\";\r\nimport Loading from \"components/Loading\";\r\nimport React from \"react\";\r\nimport { connect } from \"react-redux\";\r\nimport { useHistory } from \"react-router-dom\";\r\nimport store from \"js/store\";\r\n\r\nconst LoginPage = withStyles(() => {\r\n  return {\r\n    root: {\r\n      position: \"absolute\",\r\n      height: \"100%\",\r\n      width: \"100%\",\r\n      backgroundColor: \"white\",\r\n      padding: \"16vh 16px\",\r\n    },\r\n    logo: {\r\n      display: \"flex\",\r\n      justifyContent: \"center\",\r\n    },\r\n    title: {\r\n      textAlign: \"center\",\r\n      color: \"rgb(220,2,2)\",\r\n    },\r\n    submit: {\r\n      textTransform: \"none\",\r\n      color: \"white\",\r\n      backgroundColor: \"rgb(220,2,2)\",\r\n    },\r\n  };\r\n})(({ classes, data, loading, location, onChange, submit, setAuth }) => {\r\n  const history = useHistory();\r\n\r\n  const fields = [\r\n    {\r\n      name: \"userNameOrEmailAddress\",\r\n      component: PhoneNumber,\r\n      label: \" 工号/手机号\",\r\n      required: true,\r\n    },\r\n    {\r\n      name: \"password\",\r\n      component: Password,\r\n      label: \"密码\",\r\n      required: true,\r\n    },\r\n    {\r\n      name: \"rememberMe\",\r\n      component: Checkbox,\r\n      label: \"记住密码\",\r\n    },\r\n  ];\r\n\r\n  const validation = validate(fields, data);\r\n\r\n  const onSubmit = () => {\r\n    if (\r\n      data[\"userNameOrEmailAddress\"] === undefined ||\r\n      data[\"userNameOrEmailAddress\"] === \"\"\r\n    ) {\r\n      alert(\" 工号/手机号\");\r\n    } else if (data[\"password\"] === undefined || data[\"password\"] === \"\") {\r\n      alert(\"请输入密码\");\r\n    }\r\n    if (!hasError(validation)) {\r\n      submit(data).then((res) => {\r\n        if (res?.isPwdInit) {\r\n          const firstLogin = true;\r\n          setAuth(data);\r\n          window.localStorage.setItem(\"auth\", JSON.stringify(data));\r\n          history.push({\r\n            pathname: `/newUserResetPassword/${firstLogin}/${data.password}`,\r\n          });\r\n        } else {\r\n          console.log()\r\n          if (store.getState()?.auth?.[\"roles\"]?.[0] === \"SL\") {\r\n            history.push({ pathname: \"/synchronize\" });\r\n          } else {\r\n            history.push({ pathname: \"/activities\" });\r\n          }\r\n       \r\n        }\r\n      });\r\n    }\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <Box className={classes.root}>\r\n        <Box className={classes.logo}>\r\n          <img\r\n            src={schindler}\r\n            alt=\"Schindler Logo\"\r\n            style={{ height: \"16vh\" }}\r\n          />\r\n        </Box>\r\n        <Box\r\n          mt={3}\r\n          mb={2}\r\n          className={classes.title}\r\n          fontSize=\"h6.fontSize\"\r\n          fontWeight=\"fontWeightBold\"\r\n        >\r\n          SCF NI INSTALLATION QUALITY\r\n        </Box>\r\n        <Box my={2}>\r\n          <Form fields={fields} onChange={onChange} validation={validation} />\r\n        </Box>\r\n        <Box my={2}>\r\n          <Button\r\n            disabled={loading}\r\n            style={{ backgroundColor: \"rgb(220,2,2)\", color: \"white\" }}\r\n            fullWidth\r\n            onClick={onSubmit}\r\n            size=\"large\"\r\n            variant=\"contained\"\r\n          >\r\n            登录\r\n          </Button>\r\n        </Box>\r\n      </Box>\r\n      <Loading />\r\n      <Alert />\r\n    </>\r\n  );\r\n});\r\n\r\nexport default connect(\r\n  ({ formData, loading }) => {\r\n    return { data: formData, loading };\r\n  },\r\n  (dispatch) => {\r\n    return {\r\n      onChange: (data) => (name, value) => {\r\n        if (name === \"username\" && !value) {\r\n          dispatch(\r\n            action.setFormData({ ...data, [name]: value, rememberMe: false })\r\n          );\r\n        } else {\r\n          dispatch(action.setFormData({ ...data, [name]: value }));\r\n        }\r\n      },\r\n      submit: (data) => {\r\n        return dispatch(action.login(data));\r\n      },\r\n      setAuth: (data) => {\r\n        dispatch(action.setAuth(data));\r\n      },\r\n    };\r\n  }\r\n)(LoginPage);\r\n"]},"metadata":{},"sourceType":"module"}