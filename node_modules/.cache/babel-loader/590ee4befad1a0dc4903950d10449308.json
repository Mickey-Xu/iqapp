{"ast":null,"code":"import _objectSpread from\"C:\\\\project\\\\SCF-NI_PM_App\\\\SCF.InstallationQuality\\\\react-client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/objectSpread2\";import axios from\"axios\";import{axiosConfig,blobResponseURLs,formDataURLs}from\"config\";var getPostData=function getPostData(data){var useFormData=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;if(useFormData){var formData=new FormData();Object.keys(data).forEach(function(key){if(Array.isArray(data[key])){data[key].forEach(function(item){return formData.append(key,item);});}else{formData.append(key,data[key]);}});return formData;}else{return JSON.stringify(data);}};var getQueryString=function getQueryString(data){var queryString=\"\";if(data){queryString=Object.keys(data).map(function(key){var result=\"\".concat(encodeURIComponent(key),\"=\");if(Array.isArray(data[key])){result+=data[key].map(function(v){return\"\".concat(encodeURIComponent(v));}).join(\"\".concat(\"&\"+key+\"=\"));}else{result+=\"\".concat(encodeURIComponent(data[key]));}return result;}).join(\"&\");}if(queryString){return\"?\".concat(queryString);}return queryString;};export var get=function get(url,data){return axios.get(url+getQueryString(data),_objectSpread(_objectSpread({},axiosConfig),{},{responseType:blobResponseURLs.some(function(element){return url.startsWith(element);})?\"blob\":\"json\"})).catch(function(_ref){var message=_ref.message,response=_ref.response;if(response.status===400||response.status===403){return Promise.reject({code:response.status,message:response.data.error.message});}if(response.status===401){return Promise.reject({code:response.status,message:\"用户凭证已过期，请重新登录\"});}return Promise.reject({code:response.status,message:message});});};export var post=function post(url,data){var useFormData=formDataURLs.some(function(element){return url.startsWith(element);});var postData=getPostData(data,useFormData);return axios.post(url,postData,_objectSpread(_objectSpread({},axiosConfig),{},{headers:!useFormData?{\"Content-Type\":\"application/json\"}:{}})).catch(function(_ref2){var message=_ref2.message,response=_ref2.response;if(response.status===400||response.status===403){return Promise.reject({code:response.status,message:response.data.error.message});}if(response.status===401){return Promise.reject({code:response.status,message:\"用户凭证已过期，请重新登录\"});}return Promise.reject({code:response.status,message:message});});};","map":{"version":3,"sources":["C:/project/SCF-NI_PM_App/SCF.InstallationQuality/react-client/src/api/base.js"],"names":["axios","axiosConfig","blobResponseURLs","formDataURLs","getPostData","data","useFormData","formData","FormData","Object","keys","forEach","key","Array","isArray","item","append","JSON","stringify","getQueryString","queryString","map","result","encodeURIComponent","v","join","get","url","responseType","some","element","startsWith","catch","message","response","status","Promise","reject","code","error","post","postData","headers"],"mappings":"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","sourcesContent":["import axios from \"axios\";\r\nimport { axiosConfig, blobResponseURLs, formDataURLs } from \"config\";\r\n\r\nconst getPostData = (data, useFormData = false) => {\r\n  if (useFormData) {\r\n    const formData = new FormData();\r\n    Object.keys(data).forEach((key) => {\r\n      if (Array.isArray(data[key])) {\r\n        data[key].forEach((item) => formData.append(key, item));\r\n      } else {\r\n        formData.append(key, data[key]);\r\n      }\r\n    });\r\n    return formData;\r\n  } else {\r\n    return JSON.stringify(data);\r\n  }\r\n};\r\n\r\nconst getQueryString = (data) => {\r\n  let queryString = \"\";\r\n\r\n  if (data) {\r\n    queryString = Object.keys(data)\r\n      .map((key) => {\r\n        let result = `${encodeURIComponent(key)}=`;\r\n        if (Array.isArray(data[key])) {\r\n          result += data[key]\r\n            .map((v) => {\r\n              return `${encodeURIComponent(v)}`;\r\n            })\r\n            .join(`${\"&\" + key + \"=\"}`);\r\n        } else {\r\n          result += `${encodeURIComponent(data[key])}`;\r\n        }\r\n        return result;\r\n      })\r\n      .join(\"&\");\r\n  }\r\n\r\n  if (queryString) {\r\n    return `?${queryString}`;\r\n  }\r\n\r\n  return queryString;\r\n};\r\n\r\nexport const get = (url, data) => {\r\n  return axios\r\n    .get(url + getQueryString(data), {\r\n      ...axiosConfig,\r\n      responseType: blobResponseURLs.some((element) => url.startsWith(element))\r\n        ? \"blob\"\r\n        : \"json\",\r\n    })\r\n    .catch(({ message, response }) => {\r\n      if (response.status === 400 || response.status === 403) {\r\n        return Promise.reject({\r\n          code: response.status,\r\n          message: response.data.error.message,\r\n        });\r\n      }\r\n\r\n      if (response.status === 401) {\r\n        return Promise.reject({\r\n          code: response.status,\r\n          message: \"用户凭证已过期，请重新登录\",\r\n        });\r\n      }\r\n\r\n      return Promise.reject({ code: response.status, message });\r\n    });\r\n};\r\n\r\nexport const post = (url, data) => {\r\n  const useFormData = formDataURLs.some((element) => url.startsWith(element));\r\n  const postData = getPostData(data, useFormData);\r\n\r\n  return axios\r\n    .post(url, postData, {\r\n      ...axiosConfig,\r\n      headers: !useFormData ? { \"Content-Type\": \"application/json\" } : {},\r\n    })\r\n    .catch(({ message, response }) => {\r\n      if (response.status === 400 || response.status === 403) {\r\n        return Promise.reject({\r\n          code: response.status,\r\n          message: response.data.error.message,\r\n        });\r\n      }\r\n\r\n      if (response.status === 401) {\r\n        return Promise.reject({\r\n          code: response.status,\r\n          message: \"用户凭证已过期，请重新登录\",\r\n        });\r\n      }\r\n\r\n      return Promise.reject({ code: response.status, message });\r\n    });\r\n};"]},"metadata":{},"sourceType":"module"}