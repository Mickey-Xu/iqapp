{"ast":null,"code":"import _regeneratorRuntime from\"C:\\\\project\\\\SCF-NI_PM_App\\\\SCF.InstallationQuality\\\\react-client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";import _asyncToGenerator from\"C:\\\\project\\\\SCF-NI_PM_App\\\\SCF.InstallationQuality\\\\react-client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"C:\\\\project\\\\SCF-NI_PM_App\\\\SCF.InstallationQuality\\\\react-client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";import{Box,Button,IconButton}from'@material-ui/core';import AppBar from'@material-ui/core/AppBar';import Dialog from'@material-ui/core/Dialog';import List from'@material-ui/core/List';import Slide from'@material-ui/core/Slide';import Toolbar from'@material-ui/core/Toolbar';import Typography from'@material-ui/core/Typography';import CloseIcon from'@material-ui/icons/Close';import{LocalizeContext}from\"i18n\";import React,{useRef,useState}from'react';var Transition=React.forwardRef(function Transition(props,ref){return/*#__PURE__*/React.createElement(Slide,Object.assign({direction:\"up\",ref:ref},props));});export default function FullScreenDialog(props){var _React$useState=React.useState(false),_React$useState2=_slicedToArray(_React$useState,2),open=_React$useState2[0],setOpen=_React$useState2[1];var videoRef=useRef(null);var canvasRef=useRef(null);var _useState=useState(false),_useState2=_slicedToArray(_useState,2),isCameraOn=_useState2[0],setIsCameraOn=_useState2[1];var _useState3=useState(null),_useState4=_slicedToArray(_useState3,2),photo=_useState4[0],setPhoto=_useState4[1];var i18n=React.useContext(LocalizeContext);var handleClickOpen=function handleClickOpen(){setOpen(true);toggleCamera();};var handleClose=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var stream;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:setOpen(false);setPhoto(null);stream=videoRef.current.srcObject;if(stream){stream.getTracks().forEach(function(track){return track.stop();});videoRef.current.srcObject=null;}setIsCameraOn(false);case 5:case\"end\":return _context.stop();}}},_callee);}));return function handleClose(){return _ref.apply(this,arguments);};}();var toggleCamera=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var stream,_stream;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:if(!isCameraOn){_context2.next=6;break;}// 停止相机\nstream=videoRef.current.srcObject;if(stream){stream.getTracks().forEach(function(track){return track.stop();});videoRef.current.srcObject=null;}setIsCameraOn(false);_context2.next=17;break;case 6:_context2.prev=6;_context2.next=9;return navigator.mediaDevices.getUserMedia({video:{facingMode:{exact:'environment'}}});case 9:_stream=_context2.sent;// const stream = await navigator.mediaDevices.getUserMedia({\n//     video: true\n// });\nvideoRef.current.srcObject=_stream;setIsCameraOn(true);_context2.next=17;break;case 14:_context2.prev=14;_context2.t0=_context2[\"catch\"](6);console.error(\"Error accessing the camera:\",_context2.t0);case 17:case\"end\":return _context2.stop();}}},_callee2,null,[[6,14]]);}));return function toggleCamera(){return _ref2.apply(this,arguments);};}();var takePhoto=function takePhoto(){var canvas=canvasRef.current;var video=videoRef.current;if(video&&canvas){var context=canvas.getContext('2d');canvas.width=video.videoWidth;canvas.height=video.videoHeight;context.drawImage(video,0,0,canvas.width,canvas.height);// 获取图像的 base64 编码\nvar base64Image=canvas.toDataURL('image/png');setPhoto(base64Image);console.log(base64Image);// 或者根据需要处理\nsetIsCameraOn(false);toggleCamera();}};var viewportHeight=window.innerHeight;return/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(Typography,{onClick:handleClickOpen,color:\"secondary\",variant:\"body2\"},i18n.ISNTAPP_TAKE_PICTURE),/*#__PURE__*/React.createElement(Dialog,{fullScreen:true,open:open,onClose:handleClose,TransitionComponent:Transition},/*#__PURE__*/React.createElement(AppBar,{style:{backgroundColor:\"black\"}},/*#__PURE__*/React.createElement(Toolbar,null,/*#__PURE__*/React.createElement(IconButton,{edge:\"start\",color:\"inherit\",onClick:handleClose,\"aria-label\":\"close\"},/*#__PURE__*/React.createElement(CloseIcon,null)))),/*#__PURE__*/React.createElement(List,{style:{backgroundColor:\"black\",padding:0,margin:0,height:\"100%\"}},/*#__PURE__*/React.createElement(\"div\",{style:{display:'flex',flexDirection:'column',alignItems:'center',justifyContent:'center',height:\"100%\"}},/*#__PURE__*/React.createElement(\"div\",{style:{width:'100%',height:'100%',position:'relative',top:0,left:0}},/*#__PURE__*/React.createElement(\"video\",{ref:videoRef,playsInline:true,autoPlay:true,style:{display:isCameraOn?'block':'none',width:'100%',height:'100%',zIndex:1,marginTop:\"-5%\"}}),/*#__PURE__*/React.createElement(\"img\",{src:photo,alt:\"\",style:{maxWidth:'100%',height:'auto',display:photo?'block':'none',position:'absolute',top:56}}),/*#__PURE__*/React.createElement(\"canvas\",{ref:canvasRef,style:{display:'none'}}),isCameraOn&&/*#__PURE__*/React.createElement(\"div\",{style:{position:\"absolute\",width:\"35%\",height:\"5%\",border:\"1px dashed red\",top:\"40%\",left:\"5%\",borderRadius:\"10%\",pointerEvents:'none',zIndex:100}}),isCameraOn&&/*#__PURE__*/React.createElement(\"div\",{style:{position:\"absolute\",width:\"30%\",height:viewportHeight/1.5,border:\"1px dashed red\",top:viewportHeight/7,right:\"15%\",borderRadius:\"5%\",pointerEvents:'none',zIndex:100}}),/*#__PURE__*/React.createElement(Box,{style:{position:\"fixed\",bottom:0,left:0,right:0,fontWeight:600,display:\"flex\",justifyContent:\"space-around\",zIndex:100}},/*#__PURE__*/React.createElement(Button,{onClick:function onClick(){toggleCamera();setIsCameraOn(true);setPhoto(null);},disabled:isCameraOn,style:{color:'white'}},i18n.ISNTAPP_RESHOOT),/*#__PURE__*/React.createElement(Box,{style:{border:\" 5px solid white\",borderRadius:\"50%\",padding:\"2px\"}},/*#__PURE__*/React.createElement(Button,{onClick:function onClick(){return takePhoto();},disabled:!isCameraOn,style:{color:'black',width:\"60px\",height:\"60px\",backgroundColor:\"white\",borderRadius:\" 50%\"}},i18n.ISNTAPP_TAKE_PICTURE)),/*#__PURE__*/React.createElement(Button,{onClick:function onClick(){props.onChange(photo);setOpen(false);setPhoto(null);},disabled:isCameraOn,style:{color:'white'}},i18n.ISNTAPP_USE_PHOTOS)))))));}","map":{"version":3,"sources":["C:/project/SCF-NI_PM_App/SCF.InstallationQuality/react-client/src/components/Camera/index.js"],"names":["Box","Button","IconButton","AppBar","Dialog","List","Slide","Toolbar","Typography","CloseIcon","LocalizeContext","React","useRef","useState","Transition","forwardRef","props","ref","FullScreenDialog","open","setOpen","videoRef","canvasRef","isCameraOn","setIsCameraOn","photo","setPhoto","i18n","useContext","handleClickOpen","toggleCamera","handleClose","stream","current","srcObject","getTracks","forEach","track","stop","navigator","mediaDevices","getUserMedia","video","facingMode","exact","console","error","takePhoto","canvas","context","getContext","width","videoWidth","height","videoHeight","drawImage","base64Image","toDataURL","log","viewportHeight","window","innerHeight","ISNTAPP_TAKE_PICTURE","backgroundColor","padding","margin","display","flexDirection","alignItems","justifyContent","position","top","left","zIndex","marginTop","maxWidth","border","borderRadius","pointerEvents","right","bottom","fontWeight","color","ISNTAPP_RESHOOT","onChange","ISNTAPP_USE_PHOTOS"],"mappings":"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","sourcesContent":["import { Box, Button, IconButton } from '@material-ui/core';\r\nimport AppBar from '@material-ui/core/AppBar';\r\nimport Dialog from '@material-ui/core/Dialog';\r\nimport List from '@material-ui/core/List';\r\nimport Slide from '@material-ui/core/Slide';\r\nimport Toolbar from '@material-ui/core/Toolbar';\r\nimport Typography from '@material-ui/core/Typography';\r\nimport CloseIcon from '@material-ui/icons/Close';\r\nimport { LocalizeContext } from \"i18n\";\r\nimport React, { useRef, useState } from 'react';\r\n\r\nconst Transition = React.forwardRef(function Transition(props, ref) {\r\n    return <Slide direction=\"up\" ref={ref} {...props} />;\r\n});\r\n\r\nexport default function FullScreenDialog(props) {\r\n    const [open, setOpen] = React.useState(false);\r\n    const videoRef = useRef(null);\r\n    const canvasRef = useRef(null);\r\n    const [isCameraOn, setIsCameraOn] = useState(false);\r\n    const [photo, setPhoto] = useState(null);\r\n    const i18n = React.useContext(LocalizeContext);\r\n\r\n\r\n    const handleClickOpen = () => {\r\n        setOpen(true);\r\n        toggleCamera();\r\n    };\r\n\r\n    const handleClose = async () => {\r\n        setOpen(false);\r\n        setPhoto(null);\r\n        const stream = videoRef.current.srcObject;\r\n        if (stream) {\r\n            stream.getTracks().forEach(track => track.stop());\r\n            videoRef.current.srcObject = null;\r\n        }\r\n        setIsCameraOn(false);\r\n    };\r\n\r\n    const toggleCamera = async () => {\r\n        if (isCameraOn) {\r\n            // 停止相机\r\n            const stream = videoRef.current.srcObject;\r\n            if (stream) {\r\n                stream.getTracks().forEach(track => track.stop());\r\n                videoRef.current.srcObject = null;\r\n            }\r\n            setIsCameraOn(false);\r\n        } else {\r\n            // 开启相机\r\n            try {\r\n                const stream = await navigator.mediaDevices.getUserMedia({\r\n                    video: { facingMode: { exact: 'environment' } }\r\n                });\r\n                // const stream = await navigator.mediaDevices.getUserMedia({\r\n                //     video: true\r\n                // });\r\n                videoRef.current.srcObject = stream;\r\n                setIsCameraOn(true);\r\n            } catch (error) {\r\n                console.error(\"Error accessing the camera:\", error);\r\n            }\r\n        }\r\n    };\r\n\r\n    const takePhoto = () => {\r\n        const canvas = canvasRef.current;\r\n        const video = videoRef.current;\r\n\r\n        if (video && canvas) {\r\n            const context = canvas.getContext('2d');\r\n            canvas.width = video.videoWidth;\r\n            canvas.height = video.videoHeight;\r\n            context.drawImage(video, 0, 0, canvas.width, canvas.height);\r\n\r\n            // 获取图像的 base64 编码\r\n            const base64Image = canvas.toDataURL('image/png');\r\n            setPhoto(base64Image);\r\n            console.log(base64Image); // 或者根据需要处理\r\n            setIsCameraOn(false)\r\n            toggleCamera()\r\n        }\r\n    };\r\n    var viewportHeight = window.innerHeight;\r\n\r\n    return (\r\n        <div>\r\n            <Typography onClick={handleClickOpen} color=\"secondary\" variant=\"body2\">\r\n                {i18n.ISNTAPP_TAKE_PICTURE}\r\n            </Typography>\r\n            <Dialog fullScreen open={open} onClose={handleClose} TransitionComponent={Transition}>\r\n                <AppBar style={{ backgroundColor: \"black\" }}>\r\n                    <Toolbar>\r\n                        <IconButton edge=\"start\" color=\"inherit\" onClick={handleClose} aria-label=\"close\">\r\n                            <CloseIcon />\r\n                        </IconButton>\r\n                    </Toolbar>\r\n                </AppBar>\r\n                <List style={{ backgroundColor: \"black\", padding: 0, margin: 0, height: \"100%\" }}>\r\n                    <div style={{ display: 'flex', flexDirection: 'column', alignItems: 'center', justifyContent: 'center', height: \"100%\" }}>\r\n                        <div style={{ width: '100%', height: '100%', position: 'relative', top: 0, left: 0 }}>\r\n                            <video\r\n                                ref={videoRef}\r\n                                playsInline\r\n                                autoPlay\r\n                                style={{\r\n                                    display: isCameraOn ? 'block' : 'none', width: '100%', height: '100%', zIndex: 1,\r\n                                    marginTop: \"-5%\"\r\n                                }}\r\n                            />\r\n                            <img src={photo} alt=\"\" style={{\r\n                                maxWidth: '100%', height: 'auto', display: photo ? 'block' : 'none', position: 'absolute',\r\n                                top: 56\r\n                            }} />\r\n                            <canvas ref={canvasRef} style={{ display: 'none' }} />\r\n\r\n                            {isCameraOn && (\r\n                                <div style={{\r\n                                    position: \"absolute\",\r\n                                    width: \"35%\",\r\n                                    height: \"5%\",\r\n                                    border: \"1px dashed red\",\r\n                                    top: \"40%\",\r\n                                    left: \"5%\",\r\n                                    borderRadius: \"10%\",\r\n                                    pointerEvents: 'none',\r\n                                    zIndex: 100\r\n                                }}></div>\r\n                            )}\r\n                            {isCameraOn && (\r\n                                <div style={{\r\n                                    position: \"absolute\",\r\n                                    width: \"30%\",\r\n                                    height: viewportHeight / 1.5,\r\n                                    border: \"1px dashed red\",\r\n                                    top: viewportHeight / 7,\r\n                                    right: \"15%\",\r\n                                    borderRadius: \"5%\",\r\n                                    pointerEvents: 'none',\r\n                                    zIndex: 100\r\n                                }}></div>\r\n                            )}\r\n                            <Box style={{\r\n                                position: \"fixed\",\r\n                                bottom: 0,\r\n                                left: 0,\r\n                                right: 0,\r\n                                fontWeight: 600,\r\n                                display: \"flex\",\r\n                                justifyContent: \"space-around\",\r\n                                zIndex: 100\r\n\r\n                            }}>\r\n                                <Button\r\n                                    onClick={() => {\r\n                                        toggleCamera();\r\n                                        setIsCameraOn(true)\r\n                                        setPhoto(null)\r\n                                    }}\r\n                                    disabled={isCameraOn}\r\n                                    style={{\r\n                                        color: 'white',\r\n                                    }}>\r\n                                    {i18n.ISNTAPP_RESHOOT}\r\n                                </Button>\r\n                                <Box style={{\r\n                                    border: \" 5px solid white\",\r\n                                    borderRadius: \"50%\",\r\n                                    padding: \"2px\"\r\n                                }}>\r\n                                    <Button\r\n                                        onClick={() => takePhoto()}\r\n                                        disabled={!isCameraOn}\r\n                                        style={{\r\n                                            color: 'black',\r\n                                            width: \"60px\",\r\n                                            height: \"60px\",\r\n                                            backgroundColor: \"white\",\r\n                                            borderRadius: \" 50%\",\r\n\r\n                                        }}>\r\n                                        {i18n.ISNTAPP_TAKE_PICTURE}\r\n                                    </Button>\r\n                                </Box>\r\n                                <Button\r\n                                    onClick={() => {\r\n                                        props.onChange(photo);\r\n                                        setOpen(false);\r\n                                        setPhoto(null);\r\n                                    }}\r\n                                    disabled={isCameraOn}\r\n                                    style={{\r\n                                        color: 'white',\r\n                                    }}>\r\n                                    {i18n.ISNTAPP_USE_PHOTOS}\r\n                                </Button>\r\n                            </Box>\r\n                        </div>\r\n                    </div>\r\n                </List>\r\n            </Dialog>\r\n        </div>\r\n    );\r\n}\r\n\r\n\r\n"]},"metadata":{},"sourceType":"module"}